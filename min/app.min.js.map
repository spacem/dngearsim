{"version":3,"sources":["routes.js","about/about.js","filters/escape.filter.js","filters/percentage.filter.js","builds/build-actions.js","builds/build-export-action.js","builds/build-import.js","builds/build-item-list.js","builds/build-item.js","builds/build-list.js","builds/build-stats.js","builds/build-summary.js","builds/build-talismans.js","builds/build.js","builds/delete-build.js","builds/edit-build.js","builds/quick-add.js","builds/reload-build.js","builds/view-group.js","nav/export.js","nav/header.js","nav/nav.js","nav/setup.js","online/build-search.js","online/profile.js","online/publish.js","online/published.js","region/region.js","search/custom-items.js","search/everything-search.js","search/search.js","search/skill-search.js","widgets/choose-class.js","widgets/dnsim-category-links.js","widgets/dnsim-item-icon.js","widgets/dnsim-item-link.js","widgets/dnsim-job-icon.js","widgets/dnsim-loading.js","widgets/dnsim-select-all-on-click.js","widgets/dnsim-stats.js","widgets/dnsim-string-to-number.js","widgets/dnsim-string-to-percent.js","widgets/file-change.js","item/group-assignment.js","item/item-edit-custom.js","item/item-edit-enchantment.js","item/item-edit-potential.js","item/item-edit-skill.js","item/item-edit-spark.js","item/item-edit-talisman.js","item/item-edit.js","item/item-view-attainment.js","item/item-view-box.js","item/item-view-craft.js","item/item-view-extraction.js","item/item-view-plate.js","item/item-view-set.js","item/item-view-shop.js","item/item-view-transfer.js","item/item.js","characterService.js","columnsToLoadService.js","dntDataService.js","dntInitService.js","dntResetService.js","dvStatcardService.js","exportLinkServices.js","groupServices.js","itemCategoryService.js","itemExcludeService.js","itemFactoryService.js","itemSourceService.js","jobService.js","onlineService.js","quickAddHelperService.js","quickAddService.js","quickAddStepsService.js","regionService.js","saveService.js","statService.js","translationService.js","uiTranslationService.js","valueServices.js"],"names":["angular","$routeProvider","templateUrl","controller","when","otherwise","redirectTo","module","config","document","body","className","filter","input","window","encodeURIComponent","escapeFilter","Math","round","percentageFilter","$stateful","$location","saveHelper","exportLinkHelper","vm","this","search","buildName","copyGroup","newGroupName","importGroup","build","items","saveBuild","reloaded","reloadGroup","progress","setShortUrl","createGroupLink","directive","shortUrl","sessionStorage","getItem","longUrl","onChange","controllerAs","$timeout","hCodeValues","statHelper","itemCategory","groupHelper","translations","dntData","dntReset","blob","saveAs","Blob","JSON","stringify","type","export","exportBuild","scope","bindToController","files","target","console","event","length","reader","FileReader","readAsText","onload","fileName","replace","copyLocally","path","buildItemListController","getCategoryItems","getItemsByCategory","itemsByCat","category","subCats","subCatCatName","getSubCategories","name","subCatList","sort","item1","item2","exchangeType","_","item","increasingGemSlots","offensiveGemSlots","costumeCat","isItemForCat","names","slots","retVal","exchangeId","subCat","exchange","find","gemExchanges","e","each","isInSubCat","gemExchange","id","foundSubCatItem","canMove","allSubCatItems","subCatItem","log","move","moveItem","destination","allowMoreItems","handleChange","getGemSlot","updatedSavedItems","maxCat","cancelEdit","handleItemEdit","typeName","removeItem","newItemList","forEach","gItem","index","push","$inject","server","gemSlot","gemSlots","i","setFullStats","fullStats","stats","mergeStats","enchantmentStats","sparkStats","getGemSlotName","editMode","setupBuilds","savedItems","getSavedItems","buildNames","Object","keys","builds","$routeParams","currentGroup","saveBuildSelection","$window","title","createGroup","toggleGroup","url","buildStatsController","dvStatcardHelper","exportStatCard","convertStats","calculatedStats","dvCardStatHash","btoa","itemsByCategory","getSaveDate","lastUpdate","group","Date","toLocaleDateString","getSaveTime","toLocaleTimeString","getBuildSummary","summary","itemsByType","jobs","itemColumnsToLoad","character","calcStatPercent","newVal","origVal","updateRows","scrollTo","groupNames","groupName","getCurrentBuild","getGroupCalcStats","groupCalcStats","getCalculatedStatsFromItems","getBuild","pickup","replaceHPAffectAmount","replacePDmgAffectAmount","replaceAvgDmgAffectAmount","summaryStatIds","pcIndexes","summaryDisplay","rows","pcIndex","rowIndex","enchantmentNum","makeFakeCells","data","makeCell","selectedIndex","num","col","click","setTalisman","swapEnchantmentNumber","newEnhancementNum","extraStats","replaceAffectAmount","stat","getReplaceAffectAmount","max","statId","itemIndex","initReplaceAffects","fullStats2","newItems","fullStats1","newStats","origStats","element","eleId","elements","getStat","getStatName","secondaryElement","len","save","bulidController","getBuildStats","selectedCategory","localStorage","hideInBuild","byName","changeCategory","xsView","categoryChanging","getCategories","categories","setSelectedCategory","value","getItemCount","itemCountText","allItems","numOffensiveSlots","numOffensiveGems","totalIncreasingGems","numIncreasingSlots","numIncreasingGems","gemType","sparkTypeId","number","numItems","cat","numItemText","concat","newCustom","newGroup","deleteBuild","editBuildCtrl","region","heroStats","oldGroupName","damageTypes","job","initDamageType","damageType","d","DamageType","initDefaultElement","defaultElement","defaultSecondaryElement","jobName","EnglishName","critResist","enemyLevel","playerLevel","eleResist","init","newJobs","heroLevel","setHeroStats","key","getStatCap","getStatCaps","getJobConversion","invalidGroupName","colName","useLevel","getConversions","getJobBaseStat","getBaseStats","ok","baseStats","getHeroStats","enemyStatCaps","playerStatCaps","conversions","focus","setSelectionRange","getElementById","quickAdd","startedForCat","stepNumber","datas","options","setOptions","hasStarted","getOptions","selectOption","createData","isValidStepNumber","dntFiles","getDntFiles","newItem","columns","tryToAddItem","allLoaded","cancel","reloadItem","saveItem","reset","start","hasOptions","back","pop","testOptions","reloadBuildCtrl","tryInit","goToBuild","isLoaded","$scope","allInit","anyLoading","getById","setLocationByName","g","p","h","s","itemString","decodeItem","itemStr","isLoading","anyItems","newBuildName","rawSavedData","exportData","setItem","LZString","compressToUTF16","noLocationMenu","normalMenu","icon","buildAction","withBuildMenu","isSearch","indexOf","noRegion","isHttpOnly","startedLoading","location","protocol","tlocation","getActions","currentBuild","hostname","menu","dntLocation","extraCss","simError","ex","message","error","dntInit","progressTranslations","translate","msg","testResults","translationResults","advancedSetup","hostedFiles","sessionLocation","alternativeFiles","saveLocation","existingFile","translationsStatus","clear","reload","setCustomUrl","noLocation","buildSearch","onlineService","getClassBuilds","then","jobBuilds","maxDisplay","totalNumResults","jobId","setJob","showMoreResults","extra","getFilteredBuilds","allResults","uid","results","f","toUpperCase","result","profile","getSavedBuilds","getProfile","storedBuilds","load","publish","user","getUser","handleError","err","show","login","saveProfile","catch","getTime","startPublish","about","guild","publishBuild","deleteAccount","getBuildLimit","maxBuilds","getNumStoredBuilds","size","getNumBuilds","signOut","deleteLocal","getAllBuildNames","allKeys","reallyDeleteLocal","localToDelete","deleteServer","reallyDeleteServer","serverToDelete","published","$route","$http","res","newLineDetails","split","spaceDetails","dntVersion","override","getOverride","hoverLocation","edit","setDntVersion","getDntLocation","getTlocation","getHostedFiles","getWorldName","setTLocation","setLocation","setOverride","customItemCtrl","customItems","currentResults","nameSearch","getResults","getNewStatName","createCustomItem","everythingSearchCtrl","everything","version","Number","minLevel","origMinLevel","maxLevel","origMaxLevel","initeverything","getData","NameID","NameIDParam","rankNames","Rank","rank","IconImageIndex","levelLimit","versionMap","versions","sortBy","newResults","numeverything","curDisplay","nameSearches","ns","allMatch","toString","changeSearch","catName","itemFactory","lastJobNumber","reportProgress","getFinalJobs","splice","allJobs","getAllJobs","loadResults","altStatId","getItems","statVals","numEquip","pcStatId","pc","altStat","isClassJob","needJobClass","hideLevel","hideRank","rankChecked","initItem","statFound","statVal","statResults","value1","value2","byPath","hideInSearch","grades","origSavedSearchStatId","navigate","hideJob","jobInit","checkedRank","controllerParams","itemSearchCtrl","skillSearchCtrl","getDntName","baseClassName","toLowerCase","getSkills","loadedJobId","skills","baseJobNames","getBaseJobName","baseName","dntName","setupSkills","allReady","EffectClass2","EffectClass3","EffectClass4","EffectClass6","itemSource","NeedJob","baseJobName","numSkills","restrict","chooseClass","onSetJob","chooseClassController","finalJobs","j","bJob","getBaseJobs","getJobName","englishName","dnsimCategoryLinksController","collapse","buildScreen","$translate","collapsed","action","loaded","setCategory","getName","tId","instant","dnsimCategoryLinks","dnsimItemIcon","link","attrs","$watch","newValue","getIcon","prefix","floor","fileIndex","dnsimItemLink","noClick","encodeItem","oldValue","dnsimJobIcon","small","dnsimJobIconController","sizeValue","iconSize","iconOffset","getIconXPostion","JobIcon","getIconYPostion","transclude","alsoShowFor","$on","setLoadCount","loadError","numLoading","n","totalToLoad","dnsimLoading","hasSelectedAll","$event","selectionEnd","selectionStart","on","dnsimSelectAllOnClick","dnsimStats","altStats","separator","numInSet","showStats","append","text","newElement","clone","lastElement","after","css","addedElements","first","summaryForStats","def","summaryFor","hide","output","sep","needSetNum","display","stat2","sStat","sDef","originalDisplay","require","dnsimStringToNumber","ngModel","$formatters","parseFloat","fileChangeFunction","$parse","attrHandler","handler","$apply","addEventListener","groupAssignment","saveGroup","savedGroup","clearGroup","addAffectAmount","tryToSetItem","initAddAffects","getAddAffectAmount","getGroupItems","itemSplit","str","matches","existing","a","b","numMatches","groupItems","hasMaxExchangable","maxExchange","nextGroup","uptoItem","prevGroup","foundGroup","addToGroup","compact","statMap","found","anyChange","getEnchantLevel","enchantments","itemType","EnchantLevel","enchantmentId","enchantDnt","getEnchantments","enchantDnt2","petLevelDnt","petDnt","enchantment","enchantmentAfter","enchantmentCost","enhancementOptions","setEnchantment","getStats","NeedCoin","setPetLevel","isMaxEnchantLevel","enhancementOption","nextEnchantment","prevEnchantment","getOption","itemId","itemCount","material","materials","createBasicItem","emptyStatId","pStats","potentials","sIndex","potential","changingPotentials","potentialStats","pid","potentialDnt","getPotentials","getPotentialStats","PotentialID","potentialDntEx","nextPotential","prevPotential","changePotential","isFirstPotential","isLastPotential","getDntFile","pve","initSkills","dntFile","skillData","isMaxSkillLevel","potentialIndex","sparks","spark","sparkId","sparkDnt","getSparks","nextSpark","getPotentialIndex","isMoreSparks","isFirstSpark","prevSpark","sid","amount","updateItem","attainments","texts","file","splitVal","singleText","ItemGainText","typeId","pouchFileNames","getCharmItems","TypeParam1","getPouchItems","pouchData","gold","isGroup","boxType","basicItem","getPouchItemsFromFile","pouchFileName","pouchItem","GoldMin","charmFiles","charmItemtable","commonCharmItemtable","pouchItemCount","c","charmData","CharmNum","cd","CharmType","itemds","ItemID","count","Look","Count","Gold","crafts","cFiles","initCrafts","initCraft","hasFailed","drops","drop","di","newCrafts","k","fCrafts","craft","qtyColName","itemColName","Cost","initExtract","DisjointDrop1","disjoint","EnchantID","DisjointDrop","getGold","Disjointamount","r","row","itemData","allItemFileName","allFiles","initSets","getPlates","getSetItems","setId","item1s","shops","item2s","PurchaseItem2","shopCost","shopName","ShopID","PurchaseItem1","nightmarePoints","nestPoints","ladderPoints","TabNameID","numItem1","numItem2","shopNames","PurchaseType1","PurchaseItemValue1","PurchaseType2","PurchaseItemValue2","pointsId2","shopCosts","dungeonPoints","cCashShopFileName","cSysShopFileName","initShops","getCombinedCosts","newShopCosts","tabName","matchingTransfers","transferItemsFileName","initTransfers","transferItem","transferFileName","transfers","t","LevelLimit","NeedItemID2","level","ResultLevel","ResultEnchantLevel","NeedItemCount1","ResultRank","NeedItemCount2","anyToLoad","anyDntToLoad","setupTabs","canExtract","canTransfer","setFileName","getItemData","canUse","detail","Type","isInSet","isPlate","getBuilds","mainDnt","setStats","getDescription","description","DescriptionID","getExchangeType","DescriptionIDParam","setDetail","getNumItemsForSet","getNumInSet","getBuildName","allBuildNames","getSellingPrice","silver","SellAmount","copper","getServerStorage","AbleWStorage","IsCash","Reversion","getMoreInfo","numStamps","sealTimes","sealData","moreInfoLoaded","SealID","Type1","CashTradeCount","loadMoreInfo","copy","preInitItem","heroLevels","statCaps","jobBaseStats","complete","jobConversions","jobConversionColsToLoad","statCapColsToLoad","jobBaseStatColsToLoad","heroLevelPotentials","findFast","getRow","HeroLevelAbilityID","pIndex","factory","TypeParam2","TypeParam3","NeedJobClass","StateValue1","State1_Max","State1","StateValue3","State3_Max","State2","StateValue4","StateValue2","State4_Max","State2_Max","State3","StateValue5","State5_Max","State4","StateValue6","State6_Max","State5","StateValue7","State7_Max","State6","StateValue8","State8_Max","State7","StateValue9","State9_Max","State8","StateValue10","State10_Max","State9","State10","ExchangeType","dragonjeweltype","SetItemID","EnchantRatio","BreakRatio","MinDown","MaxDown","NeedItemID4","NeedItemCount4","NeedItemID5","NeedItemCount5","ProtectItemCount","State2Value","State3Value","State4Value","State5Value","State6Value","State7Value","State8Value","State9Value","State10Value","PotentialNo","PotentialRatio","State1Value","State11Value","State12Value","State11","State13Value","State12","State14Value","State13","State15Value","State14","State16Value","State16","setDnt","JobNumber","BaseClass","ParentJob","JobName","Strength","Agility","Intelligence","Stamina","AggroperPvE","BaseMP","Cbase","Cdefense","Ccritical","CcriticalDamage","HP","StrengthAttack","AgilityAttack","IntelligenceAttack","PhysicalDefense","MagicDefense","Critical","CriticalResistance","Stiff","StiffResistance","Stun","StunResistance","MoveSpeed","MoveSpeedRevision","DownDelay","ElementAttack","ElementDefense","ElementDefenseMin","ElementDefenseMax","StrengthIntelligenceToCriticalDamage","$rootScope","colsToLoad","DntReader","progressCallback","completeCallbacks","ignoreErrors","$broadcast","failed","loader","findIndexes","loaders","createLoader","Array","numRows","column","numResults","colIndex","columnIndexes","findIndex","val","resetAll","getNumRows","lookupValue","columnName","getValue","columnNames","convertData","initFactory","allFactories","prop","newFactory","source","convertStat","convertPercentToNum","adjustStat","func","adjustments","0","1","2","3","4","5","6","7","8","9","12","16","17","18","19","25","26","29","103","calcStats","ret","characterName","classId","statHeroLevel","v","cardImportUrl","itemBit","charAt","bitIndex","parseInt","substr","statString","statBit","splitStat","statBitIndex","itemStrings","self","encodeURI","pv","join","reloadSkill","skillLevelDnt","skillLevelDatas","skillLevelVals","skillDnt","SkillLevel","reloadSourceItem","SkillExplanationIDParam","getSkillStats","rowNum","ds","ps","typeParam1","usePartDnt","createItem","sets","parts","petLevels","PetLevel","DragonJewelSlot1","DragonJewelSlot3","DragonJewelSlot4","DragonJewelSlot2","fileType","itemTypeName","key1","allDntFiles","searchType","sourceType","limitExchange","limitGemType","limitRank","catItems","loading","anyMatch","rawData","sources","numComplete","gem","gemDnt","gemTypes","itemMap","types","setItemCategory","enh1","sorted","enh2","localeCompare","ids","excludeService","isDataLoaded","loadItems","state1Max","dStateValue1","dTypeParam1","dType","numPotentials","end","time","SkillID","skillId","iconIndex","petData","PetLevelTypeID","getItemDataFromFile","doComplete","itemSources","tech","gemSlotDnt","tman","plate","minRank","plate95","partsDnt","weaponDnt","eq","rbeq","pvpeq","cCommon","cClone","c2016","c2017","c2015","c2014","cash","xtras","imprint","jobsDnt","hasStartedLoading","alljobs","baseJobs","createJob","parentJob","parentJobData","$q","storageBucket","resolve","reject","firebase","auth","onAuthStateChanged","href","once","storedProfile","database","ref","stripBuildName","service","deleteNullProperties","set","getUserBuilds","decompressBuild","compressBuild","stringifiedData","parse","compressedBuild","actions","all","test","recurse","undefined","_typeof","pList","jobIds","remove","uniq","delete","currentUser","apiKey","authDomain","databaseURL","initializeApp","quickAddHelper","findData","alterItem","maxItems","sortFunc","sortId","addItem","matchesItem","filterDuplicates","areSameItem","isEqual","quickAddSteps","categorySteps","titles","weapons","armour","accessories","techs","expedition plates","talisman","costume","custom","getStepName","stepName","stepDef","allOptions","unfilteredItems","newOptions","option","tempDatas","minOptions","step","exchangeStep","exchanges","numExchange","exId","exName","accExchangeStep","levelStep","talismanRankStep","gemRankStep","rankStep","values","enhanceTalismanStep","allTitles","usefulTitles","enhanceStep","itemStep","namedItemStep","isItemStep","techSkillStep","itemNameStep","itemNames","itemNamesList","distinctItemNameStep","numStatsStep","numStats","highStatStep","allStats","quickHigh","selectedVal","largestVal","allItem","val1","val2","hasStatStep","searchable","customStep","dntLocationRegion","hostedFile","lastTFile","newFiles","locationName","newLocation","tLocation","groups","setCurrentBuild","updatedItems","getUniqueGroupName","existingGroups","groupNameIndex","lastIndexOf","startIndex","foundIndex","originalName","saveBuilds","updateBuild","decompressFromUTF16","getSetStats","getCombinedStats","nakedStats","getNakedStats","combinedStats","getCalculatedStats","getPc","statDef","statLookup","skPc","applyPc","dupeStat","getSkillPc","addStat","addAvgDamageStat","min","nonEleDamage","elementStat","critDamagePc","fdPc","avgDmg","secElementId","priElementId","dmgStat","secAvgDmg","secondaryElementStat","minPdmg","minMdmg","int","agi","vit","hp","defpc","mdef","mdefpc","aPwr","extraPdmg","paPwr","maxPdmg","intToPdmg","maxMdmg","extraPdmgMod","maPwr","intToMdmg","extraMdmg","strToMdmg","extraMdmgMod","crit","critChance","skCrit","cDmg","itemCrit","itemCtriDmg","fd","firePc","Cfinaldamage","icePc","maxFd","pow","eqHp","pdefEqHp","mdefEqHp","SkillIndex","effects","stillCols","valColName","effectId","vals","map","getVals","mapTo","effect","uiTranslations","dnTranslations","completeCallback","getRawData","DnTranslations","sizeLimit","getFileName","addTranslations","use","loadFromSession","idParam","params","regionData","uiTranslationLookup","cdn","dragon nest gear simulator","player lvl","hero level stats","naked stats","stat affects","select region","create a new build","import","find a build","import a build from a json build file","log in and publish your builds online","pdmg","mdmg","cdmg","fire%","ice%","light%","dark%","pdef","enhancement plates","increasing gems","offensive gems","epic","unique","legendary","quick add","hero lvl","sea","toNoDec","inThousands","toPercent","dps","combineWith","noCustom","10","11","13","14","15","20","21","22","23","32","33","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","74","75","76","77","81","101","102","104","105","106","107","1001","1004","1006","1008","1009","1012","1029","1103","2001","2004","2006","2008","2009","3000","3001","3002","3008","4012","4050","4051","4052","4053","4075","4076","10164","10165","10372","28001","28002","28003","28004","28005","28006","28007","28008","28009","28101","29001","29002","29003","29004","29005","29006","29007","29008","29009","5001","5002","5003","5004","5005","5006","5007","5008","5009","5101","5102","5103","5104","5105","5106","5107","5108","5109","59001","52001","52002","52003","52004","52005","52006","52007","52008","52009","24","27","28","89001","88001","88002","88003","88004","88005","88006","88007","88008","88009","66001","35006","14051","14052","14053","14054","14055","14056","14057","14058","14059","40011","40012","40013","40014","40015","40016","40017","40018","40001","40002","40111","91001","45001","89000","typeNames","38","90","139","skillEffectMapping","34","35","36","37","39","87","88","89","185","222","372","389","404","useMax","useStateXVal","currentState","stateProp","stateId","mightHaveSets","currentData","setupStat","stats2","stats1","add"],"mappings":"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","file":"app.min.js","sourcesContent":["(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').config(['$routeProvider', config]);\r\n\r\nfunction config($routeProvider) {\r\n\r\n  $routeProvider.\r\n  \r\n    when('/about', {\r\n      templateUrl: 'ui/about/about.html',\r\n      controller: 'AboutCtrl as about'\r\n    }).\r\n    \r\n    when('/setup', {\r\n      templateUrl: 'ui/nav/setup.html',\r\n      controller: 'SetupCtrl'\r\n    }).\r\n    when('/test', {\r\n      templateUrl: 'ui/nav/test.html',\r\n      controller: 'TestCtrl'\r\n    }).\r\n    \r\n    when('/items', {\r\n      templateUrl: 'ui/search/everything-search.html',\r\n      controller: 'ItemsCtrl as items',\r\n      reloadOnSearch: false,\r\n    }).\r\n    \r\n    when('/', {\r\n      templateUrl: 'ui/welcome.html',\r\n    }).\r\n    when('/builds', {\r\n      templateUrl: 'ui/builds/build-list.html',\r\n      controller: 'BuildListCtrl as buildList'\r\n    }).\r\n    when('/build', {\r\n      templateUrl: 'ui/builds/build-list.html',\r\n      controller: 'BuildListCtrl as buildList'\r\n    }).\r\n    when('/view-group', {\r\n      templateUrl: 'ui/builds/view-group.html',\r\n      controller: 'ViewGroupCtrl'\r\n    }).\r\n    when('/edit-build', {\r\n      templateUrl: 'ui/builds/edit-build.html',\r\n      controller: 'EditBuildCtrl as editGroup',\r\n      // reloadOnSearch: false,\r\n    }).\r\n    when('/new-build', {\r\n      templateUrl: 'ui/builds/edit-build.html',\r\n      controller: 'EditBuildCtrl as editGroup',\r\n      // reloadOnSearch: false,\r\n    }).\r\n    when('/delete-build', {\r\n      templateUrl: 'ui/builds/delete-build.html',\r\n      controller: 'DeleteBuildCtrl as deleteBuild',\r\n      // reloadOnSearch: false,\r\n    }).\r\n    when('/reload-build', {\r\n      templateUrl: 'ui/builds/reload-build.html',\r\n      controller: 'ReloadBuildCtrl as ctrl',\r\n      // reloadOnSearch: false,\r\n    }).\r\n    \r\n    when('/search', {\r\n      templateUrl: 'ui/search/search.html',\r\n      controller: 'ItemSearchCtrl as ctrl',\r\n      reloadOnSearch: false,\r\n    }).\r\n    \r\n    when('/item', {\r\n      templateUrl: 'ui/item/item.html',\r\n      controller: 'ItemCtrl',\r\n      // reloadOnSearch: false,\r\n    }).\r\n    when('/item', {\r\n      templateUrl: 'ui/item/item.html',\r\n      controller: 'ItemCtrl',\r\n      // reloadOnSearch: false,\r\n    }).\r\n    \r\n    when('/export', {\r\n      templateUrl: 'ui/nav/export.html',\r\n      controller: 'ExportCtrl',\r\n    }).\r\n    \r\n    when('/talismans', {\r\n      templateUrl: 'ui/builds/build-talismans.html',\r\n      controller: 'BuildTalismansCtrl as ctrl',\r\n    }).\r\n    \r\n    when('/publish', {\r\n      templateUrl: 'ui/online/publish.html',\r\n      controller: 'PublishCtrl as ctrl',\r\n    }).\r\n    \r\n    when('/profile', {\r\n      templateUrl: 'ui/online/profile.html',\r\n      controller: 'ProfileCtrl as ctrl',\r\n    }).\r\n    \r\n    when('/published', {\r\n      templateUrl: 'ui/online/published.html',\r\n      controller: 'PublishedCtrl as ctrl',\r\n    }).\r\n    \r\n    when('/import', {\r\n      templateUrl: 'ui/builds/build-import.html',\r\n      controller: 'BuildImportCtrl as ctrl',\r\n    }).\r\n    \r\n    when('/published', {\r\n      templateUrl: 'ui/online/published.html',\r\n      controller: 'PublishedCtrl as ctrl',\r\n    }).\r\n    \r\n    when('/build-search', {\r\n      templateUrl: 'ui/online/build-search.html',\r\n      controller: 'BuildSearchCtrl as ctrl',\r\n    }).\r\n    \r\n    otherwise({\r\n      redirectTo: '/'\r\n    });\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\nangular.module('dnsim')\r\n.controller('AboutCtrl', \r\n  ['$window',\r\n  function($window) {\r\n    'use strict';\r\n    document.body.className = 'default-back';\r\n    $window.document.title = 'dngearsim | ABOUT/FAQ';\r\n  }]\r\n);\r\n})();","(function () {\r\n'use strict';\r\nangular.module('dnsim').filter('escape', [function() {\r\n  'use strict';\r\n\r\n  function escapeFilter(input) {\r\n      if(input) {\r\n          return window.encodeURIComponent(input);\r\n      }\r\n      return '';\r\n  }\r\n\r\n  return escapeFilter;\r\n}]);\r\n\r\n})();","(function () {\r\n'use strict';\r\nangular.module('dnsim').filter('percentage', [function() {\r\n  'use strict';\r\n\r\n  function percentageFilter(input) {\r\n    if(typeof input == 'number') {\r\n      return (Math.round(input * 100 * 100) / 100) + '%';\r\n    }\r\n    else {\r\n      return input;\r\n    }\r\n  }\r\n  percentageFilter.$stateful = false;\r\n\r\n  return percentageFilter;\r\n}]);\r\n\r\n})();","angular.module('dnsim').controller('buildActionsCtrl',\r\n\r\n['$location','saveHelper','exportLinkHelper',\r\nfunction($location,saveHelper,exportLinkHelper) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  \r\n  this.deleteGroup = function() {\r\n    $location.path('/delete-build');\r\n    $location.search('name', vm.buildName);\r\n  }\r\n  \r\n  this.editGroup = function() {\r\n    $location.path('/edit-build');\r\n    $location.search('buildName', vm.buildName);\r\n  }\r\n  \r\n  this.copyGroup = function() {\r\n    var newGroupName = saveHelper.importGroup(vm.buildName, vm.build.items);\r\n    \r\n    saveHelper.saveBuild(\r\n      newGroupName, \r\n      newGroupName,\r\n      vm.build);\r\n    \r\n    $location.path('/build');\r\n    $location.search('buildName', newGroupName);\r\n  }\r\n  \r\n  this.reloaded = false;\r\n  this.reloadGroup = function() {\r\n    $location.path('/reload-build');\r\n    $location.search('name', vm.buildName);\r\n  }\r\n  \r\n  function progress() {\r\n  }\r\n    \r\n  this.setShortUrl = function() {\r\n    if(vm.build) {\r\n      var longUrl = exportLinkHelper.createGroupLink(vm.buildName, vm.build);\r\n      vm.build.shortUrl = sessionStorage.getItem(longUrl);\r\n    }\r\n  }\r\n  \r\n  this.setShortUrl();\r\n}])\r\n.directive('dngearsimBuildActions', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      buildName: '=buildName',\r\n      build: '=build',\r\n      onChange: '&onChange'\r\n    },\r\n    controller: 'buildActionsCtrl',\r\n    controllerAs: 'buildActions',\r\n    templateUrl: 'ui/builds/build-actions.html'\r\n  };\r\n});","angular.module('dnsim').controller('buildExportActionCtrl',\r\n\r\n['$timeout','$location','hCodeValues','statHelper','itemCategory','saveHelper','exportLinkHelper','groupHelper','translations','dntData','dntReset',\r\nfunction($timeout,$location,hCodeValues,statHelper,itemCategory,saveHelper,exportLinkHelper,groupHelper,translations,dntData,dntReset) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  \r\n  vm.export = exportBuild;\r\n  \r\n  function exportBuild() {\r\n    var blob = new Blob([JSON.stringify(vm.build, null, 1)], {type: \"text/plain;charset=utf-8\"});\r\n    saveAs(blob, 'dngearsim-' + vm.buildName + '.json');\r\n  }\r\n}])\r\n.directive('dngearsimBuildExportAction', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      buildName: '=buildName',\r\n      build: '=build'\r\n    },\r\n    controller: 'buildExportActionCtrl',\r\n    controllerAs: 'ctrl',\r\n    templateUrl: 'ui/builds/build-export-action.html'\r\n  };\r\n});","angular.module('dnsim').controller('BuildImportCtrl',\r\n\r\n['$timeout','$location','hCodeValues','statHelper','itemCategory','saveHelper','exportLinkHelper','groupHelper','translations','dntData','dntReset',\r\nfunction($timeout,$location,hCodeValues,statHelper,itemCategory,saveHelper,exportLinkHelper,groupHelper,translations,dntData,dntReset) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  \r\n  vm.onFileChange = onFileChange;\r\n  vm.copyLocally = copyLocally;\r\n  \r\n  function onFileChange(event) {\r\n    var files = event.target.files;\r\n    console.log('importing files', files);\r\n    if(files && files.length) {\r\n      \r\n      var fileName = files[0].name;\r\n      var reader = new FileReader();\r\n      reader.readAsText(files[0]);\r\n      reader.onload = function() {\r\n        vm.build = JSON.parse(reader.result);\r\n        if(fileName && fileName.length > 5) {\r\n          vm.buildName = fileName.substr(0, fileName.length-5);\r\n          vm.buildName = vm.buildName.replace('dngearsim-', '')\r\n        }\r\n        else {\r\n          vm.buildName = 'imported build';\r\n        }\r\n        $timeout();\r\n      }\r\n    }\r\n  }\r\n  \r\n  function copyLocally() {\r\n    var newGroupName = saveHelper.importGroup(vm.buildName, vm.build.items);\r\n    \r\n    saveHelper.saveBuild(\r\n      newGroupName, \r\n      newGroupName,\r\n      vm.build);\r\n      \r\n    $location.path('/build');\r\n    $location.search('buildName', newGroupName);\r\n  }\r\n}]);","'use strict';\r\n  \r\nangular.module('dnsim').directive('dngearsimBuildItemList', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      buildName: '=buildName',\r\n      build: '=build',\r\n      category: '=category',\r\n      server: '=server',\r\n      onChange: '&onChange'\r\n    },\r\n    controller: buildItemListController,\r\n    controllerAs: 'buildCtrl',\r\n    templateUrl: 'ui/builds/build-item-list.html'\r\n  };\r\n});\r\n\r\nfunction buildItemListController(hCodeValues, itemCategory, saveHelper) {\r\n\r\n  var vm = this;\r\n\r\n  vm.getCategoryItems = function() {\r\n    var itemsByCat = itemCategory.getItemsByCategory(vm.build.items);\r\n    if(vm.category.name in itemsByCat) {\r\n      return itemsByCat[vm.category.name];\r\n    }\r\n    else {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  var subCats = {};\r\n  var subCatCatName = '';\r\n  vm.getSubCategories = function() {\r\n    if(subCatCatName != vm.category.name) {\r\n      subCats = {};\r\n      subCatCatName = vm.category.name;\r\n      var subCatList = [];\r\n\r\n      var items = vm.build.items.sort(function(item1, item2) {\r\n        return item1.exchangeType - item2.exchangeType;\r\n      });\r\n      if(vm.category.name == 'increasing gems') {\r\n        subCatList = _.filter(items, function(item) {\r\n          return item.increasingGemSlots > 0;\r\n        });\r\n      }\r\n      else if(vm.category.name == 'offensive gems') {\r\n        subCatList = _.filter(items, function(item) {\r\n          return item.offensiveGemSlots > 0;\r\n        });\r\n      }\r\n      else if(vm.category.name == 'imprint') {  \r\n        var costumeCat = itemCategory.byName('costume');\r\n        subCatList = _.filter(items, function(item) {\r\n          return itemCategory.isItemForCat(costumeCat, item);\r\n        });\r\n      }\r\n      _.each(subCatList, function(item) {\r\n        if(!(item.exchangeType in subCats)) {\r\n          subCats[item.exchangeType] = {\r\n            names: [],\r\n            slots: 0,\r\n            exchangeType: item.exchangeType\r\n          };\r\n        }\r\n\r\n        subCats[item.exchangeType].names.push(item.name);\r\n        if(vm.category.name == 'increasing gems') {\r\n          subCats[item.exchangeType].slots += item.increasingGemSlots;\r\n        }\r\n        else if(vm.category.name == 'offensive gems') {\r\n          subCats[item.exchangeType].slots += item.offensiveGemSlots;\r\n        }\r\n        else {\r\n            subCats[item.exchangeType].slots = 1;\r\n        }\r\n      });\r\n      subCats[0] = null;\r\n    }\r\n    \r\n    return subCats;\r\n  }\r\n\r\n  vm.getNumTaken = function(subCat) {\r\n    var retVal = 0;\r\n    var exchangeId;\r\n    if(vm.category.name == 'imprint') {\r\n      exchangeId = subCat.exchangeType;\r\n    }\r\n    else {\r\n      var gemExchange = _.find(hCodeValues.gemExchanges, function(e) {\r\n        return e.exchange == subCat.exchangeType;\r\n      });\r\n\r\n      exchangeId = gemExchange.id;\r\n    }\r\n\r\n    if(exchangeId) {\r\n      var items = vm.getCategoryItems();\r\n      _.each(items, function(item) {\r\n        if(item.gemSlot == exchangeId) {\r\n          ++retVal;\r\n        }\r\n      });\r\n    }\r\n    return retVal;\r\n  }\r\n\r\n  vm.isInSubCat = function(item, subCat) {\r\n    if(!subCat && !item.gemSlot) {\r\n      return true;\r\n    }\r\n    else {\r\n      var exchangeId;\r\n      if(vm.category.name == 'imprint') {\r\n        exchangeId = item.gemSlot;\r\n      }\r\n      else {\r\n        var gemExchange = _.find(hCodeValues.gemExchanges, function(e) {\r\n          return e.id == item.gemSlot;\r\n        });\r\n        if(gemExchange) {\r\n          exchangeId = gemExchange.exchange;\r\n        }\r\n      }\r\n\r\n      if(!subCat && exchangeId) {\r\n        // check for invalid slot\r\n        var allSubCatItems = vm.getSubCategories();\r\n        var foundSubCatItem = _.find(allSubCatItems, function(subCatItem) {\r\n          return subCatItem != null && exchangeId == subCatItem.exchangeType;\r\n        });\r\n\r\n        if(!foundSubCatItem) {\r\n          return true;\r\n        }\r\n      }\r\n      else if(subCat && exchangeId) {\r\n        return exchangeId == subCat.exchangeType;\r\n      }\r\n      else {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  vm.canMove = function() {\r\n    return vm.category.name == 'increasing gems' || vm.category.name == 'offensive gems' || vm.category.name == 'imprint';\r\n  }\r\n\r\n  vm.getGemSlot = function(subCat) {\r\n    if(vm.category.name == 'imprint') {\r\n      return subCat.exchangeType;\r\n    }\r\n    else if(subCat) {\r\n      var gemExchange = _.find(hCodeValues.gemExchanges, function(e) {\r\n        return e.exchange == subCat.exchangeType;\r\n      });\r\n\r\n      if(!gemExchange) {\r\n          console.log('cannot find exchange for', subCat);\r\n      }\r\n      return gemExchange.id;\r\n    }\r\n  }\r\n\r\n  vm.move = function(moveItem, destination) {\r\n    moveItem.gemSlot = vm.getGemSlot(destination);\r\n    saveHelper.updatedSavedItems(vm.buildName, vm.build.items);\r\n    vm.handleChange();\r\n  }\r\n  \r\n  vm.allowMoreItems = function() {\r\n    return !vm.category.maxCat || vm.getCategoryItems().length < vm.category.maxCat;\r\n  }\r\n  \r\n  vm.handleChange = function() {\r\n    subCatCatName = '';\r\n    vm.onChange();\r\n  }\r\n  \r\n  vm.handleItemEdit = function() {\r\n    saveHelper.updatedSavedItems(vm.buildName, vm.build.items);\r\n    vm.handleChange();\r\n  }\r\n  \r\n  vm.cancelEdit = function() {\r\n    vm.onChange();\r\n  }\r\n  \r\n  vm.canEdit = function(item) {\r\n    return item.typeName == 'custom' || item.typeName == 'weapons' || item.typeName == 'armour' || item.typeName == 'offensive gems' || item.typeName == 'increasing gems';\r\n  }\r\n  \r\n  vm.removeItem = function(item) {\r\n    subCatCatName = '';\r\n    item.removeItem = true;\r\n    var newItemList = [];\r\n    angular.forEach(vm.build.items, function(gItem, index) {\r\n      if(gItem && !gItem.removeItem) {\r\n        newItemList.push(gItem);\r\n      }\r\n    });\r\n\r\n    vm.build.items = newItemList;\r\n    saveHelper.updatedSavedItems(vm.buildName, newItemList);\r\n    vm.handleChange();\r\n  }\r\n}","angular.module('dnsim').controller('buildItemCtrl',\r\n\r\n['$timeout','statHelper','saveHelper','hCodeValues',\r\nfunction($timeout,statHelper,saveHelper,hCodeValues) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  \r\n  vm.updateItem = setFullStats;\r\n  vm.gemSlots = hCodeValues.gemExchanges;\r\n  vm.getGemSlotName = getGemSlotName;\r\n  \r\n  function getGemSlotName(item) {\r\n    if(item.gemSlot) {\r\n      for(var i=0;i<vm.gemSlots.length;++i) {\r\n        if(vm.gemSlots[i].id == item.gemSlot) {\r\n          return vm.gemSlots[i].name;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  function setFullStats() {\r\n    // full stats are cleared when publishing builds\r\n    vm.item.fullStats = vm.item.stats;\r\n    \r\n    if(vm.item.enchantmentStats != null && vm.item.enchantmentStats.length > 0) {\r\n      vm.item.fullStats = hCodeValues.mergeStats(vm.item.enchantmentStats, vm.item.fullStats);\r\n    }\r\n    \r\n    if(vm.item.sparkStats != null && vm.item.sparkStats.length > 0) {\r\n      vm.item.fullStats = hCodeValues.mergeStats(vm.item.sparkStats, vm.item.fullStats);\r\n    }\r\n  }\r\n  \r\n}])\r\n.directive('dngearsimBuildItem', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n      editMode: '=editMode',\r\n      onChange: '&onChange',\r\n      cancelEdit: '&cancelEdit'\r\n    },\r\n    controller: 'buildItemCtrl',\r\n    controllerAs: 'ctrl',\r\n    templateUrl: 'ui/builds/build-item.html'\r\n  };\r\n});","angular.module('dnsim').controller('BuildListCtrl', \r\n  [ '$window','$location','$routeParams','$timeout','saveHelper',\r\n  function($window,$location,$routeParams,$timeout,saveHelper) {\r\n    'use strict';\r\n    \r\n    var vm = this;\r\n    document.body.className = 'saved-back';\r\n    this.setupBuilds = function() {\r\n      vm.savedItems = saveHelper.getSavedItems();\r\n      vm.buildNames = Object.keys(vm.savedItems).sort();\r\n      vm.builds = [];\r\n      for(var i=0;i<vm.buildNames.length;++i) {\r\n        vm.builds.push({\r\n          name: vm.buildNames[i],\r\n          build: vm.savedItems[vm.buildNames[i]],\r\n        });\r\n      }\r\n    }\r\n    this.setupBuilds();\r\n    \r\n    if('buildName' in $routeParams) {\r\n      if($routeParams.buildName in vm.savedItems) {\r\n        if($routeParams.buildName != this.currentGroup) {\r\n          this.currentGroup = $routeParams.buildName;\r\n          saveHelper.saveBuildSelection(this.currentGroup, this.savedItems);\r\n        }\r\n      }\r\n      else {\r\n        this.currentGroup = null;\r\n      }\r\n    }\r\n    else if(this.currentGroup && this.currentGroup in this.savedItems) {\r\n      $location.path('/build');\r\n      $location.search('buildName', this.currentGroup);\r\n    }\r\n    else {\r\n      this.currentGroup = null;\r\n    }\r\n    \r\n    if(this.currentGroup) {\r\n      $window.document.title = 'dngearsim | ' + this.currentGroup;\r\n    }\r\n    else {\r\n      $window.document.title = 'dngearsim | BUILDS';\r\n    }\r\n\r\n    this.anyItems = function() {\r\n      return Object.keys(this.savedItems).length > 0;\r\n    }\r\n\r\n    this.createGroup = function() {\r\n      $location.path('/new-build');\r\n    }\r\n    \r\n    this.handleChange = function() {\r\n      vm.setupBuilds();\r\n      $timeout();\r\n      // console.log('change');\r\n    }\r\n  \r\n    this.toggleGroup = function(buildName) {\r\n      saveHelper.saveBuildSelection(buildName, this.savedItems);\r\n      $location.url('/build?buildName=' + buildName);\r\n    }\r\n    \r\n    this.publish = function() {\r\n      $location.url('/publish');\r\n    }\r\n    \r\n    this.search = function() {\r\n      $location.url('/build-search');\r\n    }\r\n  }]\r\n);\r\n","'use strict';\r\n\r\nangular.module('dnsim').directive('dngearsimBuildStats', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      stats: '=stats',\r\n      build: '=build',\r\n      buildName: '=buildName',\r\n    },\r\n    controller: buildStatsController,\r\n    controllerAs: 'statsCtrl',\r\n    templateUrl: 'ui/builds/build-stats.html'\r\n  };\r\n});\r\n\r\nfunction buildStatsController(statHelper,dvStatcardHelper) {\r\n  var vm = this;\r\n\r\n  vm.exportStatCard = function() {\r\n    var dvCardStatHash = dvStatcardHelper.convertStats(vm.build, vm.buildName, vm.stats.calculatedStats);\r\n    var url = dvStatcardHelper.cardImportUrl + '?dngsimport=' + btoa(JSON.stringify(dvCardStatHash));\r\n    window.open(url);\r\n  }\r\n}","angular.module('dnsim').controller('buildSummaryCtrl',\r\n\r\n['$routeParams','$location','hCodeValues','statHelper','itemCategory',\r\nfunction($routeParams,$location,hCodeValues,statHelper,itemCategory) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  \r\n  this.stats = statHelper.getBuildStats(this.build);\r\n  this.itemsByCategory = itemCategory.getItemsByCategory(this.build.items);\r\n  \r\n  this.getSaveDate = function(group) {\r\n    if(vm.build.lastUpdate > 0) {\r\n      var lastUpdate = new Date(vm.build.lastUpdate);\r\n      return lastUpdate.toLocaleDateString();\r\n    }\r\n  }\r\n  \r\n  this.getSaveTime = function(group) {\r\n    if(vm.build.lastUpdate > 0) {\r\n      var lastUpdate = new Date(vm.build.lastUpdate);\r\n      return lastUpdate.toLocaleTimeString();\r\n    }\r\n  }\r\n  \r\n  this.getBuildSummary = function(group) {\r\n    var summary = '';\r\n    \r\n    var typeCounts = {};\r\n    var cashItems = 0;\r\n    var titles = 0;\r\n    angular.forEach(vm.itemsByCategory, function(itemsByType, type) {\r\n      if(itemsByType.length > 0) {\r\n        if(summary.length > 0) {\r\n          summary += ', ';\r\n        }\r\n        summary += itemsByType.length + ' ' + type;\r\n      }\r\n    });\r\n    \r\n    return summary;\r\n  }\r\n}])\r\n.directive('dngearsimBuildSummary', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      buildName: '=buildName',\r\n      build: '=build'\r\n    },\r\n    controller: 'buildSummaryCtrl',\r\n    controllerAs: 'buildCtrl',\r\n    templateUrl: 'ui/builds/build-summary.html'\r\n  };\r\n});","angular.module('dnsim').controller('BuildTalismansCtrl',\r\n\r\n['$window','$location','$routeParams','$timeout','saveHelper','statHelper','jobs','hCodeValues','itemColumnsToLoad','character',\r\nfunction($window,$location,$routeParams,$timeout,saveHelper,statHelper,jobs,hCodeValues,itemColumnsToLoad,character) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  \r\n  $window.document.title = 'dngearsim | TALISMANS';\r\n  $window.scrollTo(0, 0);\r\n  \r\n  this.savedItems = saveHelper.getSavedItems();\r\n  this.groupNames = Object.keys(this.savedItems);\r\n  if(!this.groupNames) {\r\n    this.groupNames = [];\r\n  }\r\n  if(this.groupNames.length > 0) {\r\n    this.groupName = saveHelper.getCurrentBuild();\r\n  }\r\n  else {\r\n    this.groupName = null;\r\n  }\r\n  \r\n  if(!this.groupName || !(this.groupName in this.savedItems)) {\r\n    if(this.groupNames.length > 0) {\r\n      this.groupName = this.groupNames[0];\r\n    }\r\n  }\r\n  \r\n  if(!this.groupName) {\r\n    // console.log('cannot find build');\r\n    return;\r\n  }\r\n  \r\n  this.getGroupCalcStats = function() {\r\n    if(this.groupCalcStats == null) {\r\n      var group = vm.savedItems[vm.groupName];\r\n      if(group) {\r\n        this.groupCalcStats = statHelper.getCalculatedStatsFromItems(group, group.items);\r\n      }\r\n    }\r\n    \r\n    return this.groupCalcStats;\r\n  }\r\n  \r\n  this.getBuild = function() {\r\n    return vm.savedItems[vm.groupName];\r\n  }\r\n  \r\n  this.pickup = function(index) {\r\n    vm.selectedIndex = index;\r\n    \r\n    vm.replaceHPAffectAmount = [];\r\n    vm.replaceMDmgAffectAmount = [];\r\n    vm.replacePDmgAffectAmount = [];\r\n    vm.replaceAvgDmgAffectAmount = [];\r\n  }\r\n  \r\n  function saveGroup() {\r\n    saveHelper.saveBuildSelection(vm.groupName, vm.savedItems);\r\n  }\r\n  \r\n  this.headers = [\r\n    '+100%',\r\n    '+75%',\r\n    '+25%',\r\n    '+0%',\r\n    ];\r\n  \r\n  this.summaryStatIds = [];\r\n  for(var id in hCodeValues.stats) {\r\n    if(hCodeValues.stats[id].summaryDisplay) {\r\n      this.summaryStatIds.push(id);\r\n    }\r\n  }\r\n  \r\n  this.pcIndexes = {};\r\n  this.pcIndexes['100'] = 0;\r\n  this.pcIndexes['75'] = 1;\r\n  this.pcIndexes['25'] = 2;\r\n  this.pcIndexes['0'] = 3;\r\n  \r\n  this.selectedIndex = -1;\r\n  \r\n  this.rows = [];\r\n  \r\n  this.updateRows = function() {\r\n    vm.rows = [];\r\n        \r\n    angular.forEach(vm.savedItems[vm.groupName].items, function(item, index) {\r\n      if(item.typeName == 'talisman') {\r\n        var pcIndex = vm.pcIndexes[item.enchantmentNum];\r\n        if(!pcIndex && pcIndex != 0) {\r\n          pcIndex = 3;\r\n        }\r\n        \r\n        var rowIndex = 0;\r\n        for(;;) {\r\n          if(!vm.rows[rowIndex]) {\r\n            vm.rows[rowIndex] = vm.makeFakeCells();\r\n          }\r\n          \r\n          if(vm.rows[rowIndex][pcIndex].index < 0) {\r\n            if(!item.enchantmentNum) {\r\n              item.enchantmentNum = 0;\r\n            }\r\n            \r\n            var data = vm.makeCell(item, index);\r\n            vm.rows[rowIndex][pcIndex] = data;\r\n            break;\r\n          }\r\n          else {\r\n            rowIndex++;\r\n          }\r\n        }\r\n      }\r\n      \r\n    });\r\n    \r\n    if(vm.rows.length < 3) {\r\n      vm.rows[vm.rows.length+1] = vm.makeFakeCells();\r\n    }\r\n  };\r\n  \r\n  this.makeFakeCells = function(num) {\r\n    return [vm.makeCell({enchantmentNum:100},-1),vm.makeCell({enchantmentNum:75},-2),vm.makeCell({enchantmentNum:25},-3),vm.makeCell({enchantmentNum:0},-4)];\r\n  };\r\n  \r\n  this.makeCell = function(item, index) {\r\n    return { item: item, index: index };\r\n  };\r\n  \r\n  this.click = function(col) {\r\n    if(vm.selectedIndex == -1) {\r\n      if(col.index >= 0) {\r\n        vm.pickup(col.index);\r\n      }\r\n    }\r\n    else {\r\n      vm.move(col);\r\n    }\r\n  };\r\n  \r\n  this.move = function(col) {\r\n    \r\n    var items = vm.savedItems[vm.groupName].items;\r\n    if(col.index >= 0) {\r\n      var swapEnchantmentNumber = col.item.enchantmentNum;\r\n      \r\n      vm.setTalisman(col.item, items[vm.selectedIndex].enchantmentNum);\r\n      vm.setTalisman(items[vm.selectedIndex], swapEnchantmentNumber);\r\n      items[col.index] = items[vm.selectedIndex];\r\n      items[vm.selectedIndex] = col.item;\r\n    }\r\n    else {\r\n      var item = items[vm.selectedIndex];\r\n      vm.setTalisman(item, col.item.enchantmentNum);\r\n      items.splice(vm.selectedIndex, 1);\r\n      items.push(item);\r\n    }\r\n\r\n    vm.groupCalcStats = null;\r\n    vm.selectedIndex = -1;\r\n    vm.updateRows();\r\n    vm.replaceAffectAmount = {};\r\n    $timeout();\r\n  };\r\n  \r\n  this.setTalisman = function(item, newEnhancementNum) {\r\n    var extraStats = [];\r\n    angular.forEach(item.stats, function(stat, index) {\r\n      if(newEnhancementNum) {\r\n        extraStats.push({id: stat.id, max: stat.max * (newEnhancementNum/100)});\r\n      }\r\n    });\r\n    \r\n    item.enchantmentStats = extraStats;\r\n    item.enchantmentNum = newEnhancementNum;\r\n    \r\n    item.fullStats = hCodeValues.mergeStats(item.enchantmentStats, item.stats);\r\n  };\r\n  \r\n    \r\n  this.replaceAffectAmount = {};\r\n  this.getReplaceAffectAmount = function(statId, itemIndex, item) {\r\n    this.initReplaceAffects(itemIndex, item);\r\n    if(this.replaceAffectAmount[itemIndex]) {\r\n      return this.replaceAffectAmount[itemIndex][statId];\r\n    }\r\n  };\r\n  \r\n  this.initReplaceAffects = function(itemIndex, item) {\r\n    if(vm.replaceAffectAmount[itemIndex] || vm.selectedIndex == -1) {\r\n      return;\r\n    }\r\n    this.replaceAffectAmount[itemIndex] = {};\r\n    \r\n    var group = vm.savedItems[vm.groupName];\r\n    var item2 = group.items[vm.selectedIndex];\r\n    \r\n    var extraStats = [];\r\n    var fullStats1 = [];\r\n    if(item.stats) {\r\n      angular.forEach(item.stats, function(stat, index) {\r\n        extraStats.push({id: stat.id, max: stat.max * (item2.enchantmentNum/100)});\r\n      });\r\n      fullStats1 = hCodeValues.mergeStats(extraStats, item.stats);\r\n    }\r\n    \r\n    extraStats = [];\r\n    angular.forEach(item2.stats, function(stat, index) {\r\n      extraStats.push({id: stat.id, max: stat.max * (item.enchantmentNum/100)});\r\n    });\r\n    var fullStats2 = hCodeValues.mergeStats(extraStats, item2.stats);\r\n\r\n    var newItems = [{stats: fullStats1}, {stats: fullStats2}];\r\n    angular.forEach(group.items, function(gItem , index) {\r\n      if(item !== gItem && item2 !== gItem) {\r\n        newItems.push(gItem);\r\n      }\r\n    });\r\n    \r\n    var newStats = statHelper.getCalculatedStatsFromItems(group, newItems);\r\n    var origStats = vm.getGroupCalcStats();\r\n    \r\n    for(var id in hCodeValues.stats) {\r\n      if(hCodeValues.stats[id].summaryDisplay) {\r\n        vm.replaceAffectAmount[itemIndex][id] = calcStatPercent(vm.getStat(id, newStats).max, vm.getStat(id, origStats).max);\r\n      }\r\n    }\r\n  };\r\n  \r\n  this.getStatName = function(id) {\r\n    var retVal = '';\r\n    if(hCodeValues.stats[id].element == 'primary') {\r\n      var eleId = 0;\r\n      if(vm.savedItems[vm.groupName].element) {\r\n        eleId = vm.savedItems[vm.groupName].element.id;\r\n      }\r\n      retVal += hCodeValues.elements[eleId].name;\r\n    }\r\n    else if(hCodeValues.stats[id].element == 'secondary') {\r\n      var eleId = 0;\r\n      if(vm.savedItems[vm.groupName].secondaryElement) {\r\n        eleId = vm.savedItems[vm.groupName].secondaryElement.id;\r\n      }\r\n      retVal += hCodeValues.elements[eleId].name;\r\n    }\r\n    return retVal + ' ' + hCodeValues.stats[id].name;\r\n  };\r\n  \r\n  this.getStat = function(id, stats) {\r\n    var len = stats.length;\r\n    for(var i=0;i<len;++i) {\r\n      if(stats[i].id == id) {\r\n        return stats[i];\r\n      }\r\n    }\r\n    return {id: id, max:0};\r\n  };\r\n  \r\n  function calcStatPercent(newVal, origVal) {\r\n    if(newVal && origVal) {\r\n      return Math.round(10000 * (1 - (origVal / newVal))) / 100;\r\n    }\r\n    else {\r\n      return 0;\r\n    }\r\n  }\r\n  \r\n  this.save = function() {\r\n    saveHelper.updatedSavedItems(vm.groupName, vm.savedItems[vm.groupName].items);\r\n    $location.path('/build');\r\n    $location.search('buildName', vm.groupName);\r\n  };\r\n  \r\n  this.updateRows();\r\n  \r\n}]); ","angular.module('dnsim').directive('dngearsimBuild', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      buildName: '=buildName',\r\n      build: '=build',\r\n      onChange: '&onChange',\r\n      server: '=server'\r\n    },\r\n    controller: bulidController,\r\n    controllerAs: 'buildCtrl',\r\n    templateUrl: 'ui/builds/build.html'\r\n  };\r\n});\r\n\r\nfunction bulidController($timeout, statHelper, itemCategory, saveHelper) {\r\n  'use strict';  \r\n  var vm = this;\r\n  \r\n  vm.stats = statHelper.getBuildStats(vm.build);\r\n  \r\n  var selectedCategory = localStorage.getItem('selectedItemCategory');\r\n  vm.category = itemCategory.byName(selectedCategory);\r\n  if(!vm.category || vm.category.hideInBuild) {\r\n    selectedCategory = 'titles';\r\n    vm.category = itemCategory.byName('titles');\r\n  }\r\n  \r\n  vm.getCategoryItems = function() {\r\n    var itemsByCat = itemCategory.getItemsByCategory(vm.build.items);\r\n    if(vm.category.name in itemsByCat) {\r\n      return itemsByCat[vm.category.name];\r\n    }\r\n    else {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  vm.changeCategory = function() {\r\n    vm.xsView = null;\r\n    vm.moveItem = null;\r\n    vm.categoryChanging = true;\r\n    $timeout(function() {\r\n      vm.categoryChanging = false;\r\n    }, 0);\r\n  }\r\n  \r\n  vm.getCategories = function() {\r\n    return itemCategory.categories;\r\n  }\r\n    \r\n  vm.setSelectedCategory = function(value) {\r\n    vm.category = itemCategory.byName(value);\r\n    localStorage.setItem('selectedItemCategory', value);\r\n  }\r\n  \r\n  vm.getSaveDate = function(group) {\r\n    if(vm.build.lastUpdate > 0) {\r\n      var lastUpdate = new Date(vm.build.lastUpdate);\r\n      return lastUpdate.toLocaleDateString();\r\n    }\r\n  }\r\n  \r\n  vm.getSaveTime = function(group) {\r\n    if(vm.build.lastUpdate > 0) {\r\n      var lastUpdate = new Date(vm.build.lastUpdate);\r\n      return lastUpdate.toLocaleTimeString();\r\n    }\r\n  }\r\n  \r\n  vm.allowMoreItems = function() {\r\n    return !vm.category.maxCat || vm.getCategoryItems().length < vm.category.maxCat;\r\n  }\r\n  \r\n  vm.getItemCount = function() {\r\n    var itemCountText = '';\r\n    var allItems = vm.build.items;\r\n    \r\n    if(vm.category.name == 'offensive gems') {\r\n      var numOffensiveSlots = 0;\r\n      var numOffensiveGems = 0;\r\n      angular.forEach(allItems, function(item, index) {\r\n        if(item.typeName == vm.category.name) {\r\n          numOffensiveGems++;\r\n        }\r\n        else if(item.offensiveGemSlots) {\r\n          numOffensiveSlots += item.offensiveGemSlots;\r\n        }\r\n      });\r\n      \r\n      itemCountText = numOffensiveGems + ' / ' + numOffensiveSlots;\r\n    }\r\n    else if(vm.category.name == 'increasing gems') {\r\n      \r\n      var totalIncreasingGems = 0;\r\n      var numIncreasingSlots = 0;\r\n      var numIncreasingGems = {};\r\n      angular.forEach(allItems, function(item, index) {\r\n        if(item.typeName == vm.category.name) {\r\n          var gemType = item.sparkTypeId;\r\n          if(!gemType) {\r\n            gemType = 0;\r\n          }\r\n          \r\n          if(!(gemType in numIncreasingGems)) {\r\n            numIncreasingGems[gemType] = 0;\r\n          }\r\n          numIncreasingGems[gemType]++;\r\n          totalIncreasingGems++;\r\n        }\r\n        else if(item.increasingGemSlots) {\r\n          numIncreasingSlots += item.increasingGemSlots;\r\n        }\r\n      });\r\n      \r\n      itemCountText = ''\r\n      angular.forEach(numIncreasingGems, function(number, gemType) {\r\n        if(itemCountText.length > 0) {\r\n          itemCountText += '+';\r\n        }\r\n        itemCountText += number;\r\n      });\r\n      \r\n      itemCountText = totalIncreasingGems + ' (' + itemCountText + ') / ' + numIncreasingSlots;\r\n    }\r\n    else {\r\n      var numItems = 0;\r\n      angular.forEach(allItems, function(item, index) {\r\n        if(item && item.typeName == vm.category.name) {\r\n          numItems++;\r\n        }\r\n      });\r\n      \r\n      itemCountText = numItems;\r\n      var cat = itemCategory.byName(vm.category.name);\r\n      if(cat && 'numItemText' in cat) {\r\n        itemCountText += ' / ' + cat.numItemText;\r\n      }\r\n    }\r\n    \r\n    return itemCountText;\r\n  }\r\n  \r\n  vm.newCustom = function() {\r\n    var newCustom = {id: 0, typeName:'custom', name: 'new custom item', stats: []};\r\n    vm.build.items = vm.build.items.concat(newCustom);\r\n    saveHelper.updatedSavedItems(vm.buildName, vm.build.items);\r\n    vm.handleChange();\r\n  }\r\n  \r\n  vm.handleChange = function() {\r\n    vm.stats = statHelper.getBuildStats(vm.build);\r\n    vm.onChange();\r\n  }\r\n}","angular.module('dnsim').controller('DeleteBuildCtrl',\r\n\r\n['$location','$routeParams','$timeout','saveHelper','dntData','jobs','hCodeValues','itemColumnsToLoad',\r\nfunction($location,$routeParams,$timeout,saveHelper,dntData,jobs,hCodeValues,itemColumnsToLoad) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  this.newGroup = true;\r\n  if('name' in $routeParams) {\r\n      this.name = $routeParams.name;\r\n  }\r\n  \r\n  this.delete = function() {\r\n    saveHelper.deleteBuild(this.name);\r\n    $location.path('/builds/');\r\n  }\r\n    \r\n}]); ","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').controller('EditBuildCtrl', editBuildCtrl);\r\n\r\nfunction editBuildCtrl($window,$location,$routeParams,$timeout,saveHelper,dntData,jobs,hCodeValues,itemColumnsToLoad,character,region) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  vm.savedItems = saveHelper.getSavedItems();\r\n  vm.group = {};\r\n  vm.newGroup = true;\r\n  if('buildName' in $routeParams) {\r\n      vm.groupName = $routeParams.buildName;\r\n      if(vm.groupName in vm.savedItems) {\r\n        vm.group = vm.savedItems[vm.groupName];\r\n        vm.newGroup = false;\r\n      }\r\n  }\r\n  else {\r\n    vm.groupName = '';\r\n  }\r\n  vm.oldGroupName = vm.groupName;\r\n  vm.heroStats = [];\r\n  vm.elements = hCodeValues.elements;\r\n  vm.damageTypes = hCodeValues.damageTypes;\r\n  \r\n  vm.initDamageType = function() {\r\n    if(vm.job) {\r\n      if(vm.group.damageType) {\r\n        vm.damageType = vm.group.damageType;\r\n      }\r\n      else if(vm.newGroup && 'DamageType' in vm.job.d) {\r\n        if(vm.job.d.DamageType) {\r\n          vm.damageType = hCodeValues.damageTypes[2];\r\n        }\r\n        else {\r\n          vm.damageType = hCodeValues.damageTypes[1];\r\n        }\r\n      }\r\n      else {\r\n        vm.damageType = hCodeValues.damageTypes[0];\r\n      }\r\n    }\r\n  }\r\n\r\n  vm.initDefaultElement = function() {\r\n    var defaultElement = hCodeValues.elements[0];\r\n    var defaultSecondaryElement = hCodeValues.elements[0];\r\n\r\n    if(vm.job && vm.job.d) {\r\n      var jobName = vm.job.d.EnglishName;\r\n      if(jobName == 'CRUSADES' || jobName == 'INQUISITOR' || jobName == 'GUARDIAN' || jobName == 'SAINT' || jobName == 'SILVERHUNTER' || jobName == 'STINGBREEZER') {\r\n        defaultElement = hCodeValues.elements[3];\r\n        defaultSecondaryElement = hCodeValues.elements[3];\r\n      }\r\n      else if(jobName == 'RAVEN' || jobName == 'MAJESTY' || jobName == 'SOULEATER' || jobName == 'DARKSUMMONER' || jobName == 'ABYSSWALKER' || jobName == 'BLACKMARA' || jobName == 'PHYSICIAN') {\r\n        defaultElement = hCodeValues.elements[4];\r\n        defaultSecondaryElement = hCodeValues.elements[4];\r\n      }\r\n      else if(jobName == 'SALEANA' || jobName == 'RIPPER' || jobName == 'DARKAVENGER') {\r\n        defaultElement = hCodeValues.elements[1];\r\n        defaultSecondaryElement = hCodeValues.elements[1];\r\n      }\r\n      else if(jobName == 'ELESTRA') {\r\n        defaultElement = hCodeValues.elements[2];\r\n        defaultSecondaryElement = hCodeValues.elements[2];\r\n      }\r\n      else if(jobName == 'ADEPT') {\r\n        defaultElement = hCodeValues.elements[1];\r\n        defaultSecondaryElement = hCodeValues.elements[2];\r\n      }\r\n      else if(jobName == 'LIGHTFURY') {\r\n        defaultElement = hCodeValues.elements[3];\r\n        defaultSecondaryElement = hCodeValues.elements[4];\r\n      }\r\n    }\r\n\r\n    if(vm.newGroup) {\r\n      vm.element = defaultElement;\r\n      vm.secondaryElement = defaultSecondaryElement;\r\n    }\r\n    \r\n    if(!vm.element) {\r\n      vm.element = defaultElement;\r\n    }\r\n\r\n    if(!vm.secondaryElement) {\r\n      vm.secondaryElement = defaultElement;\r\n    }\r\n  }\r\n    \r\n  if(vm.group.element) {\r\n    vm.element = vm.group.element;\r\n  }\r\n  else {\r\n    vm.element = hCodeValues.elements[0];\r\n  }\r\n    \r\n  if(vm.group.secondaryElement) {\r\n    vm.secondaryElement = vm.group.secondaryElement;\r\n  }\r\n  else {\r\n    vm.secondaryElement = hCodeValues.elements[0];\r\n  }\r\n\r\n  if(!('critResist' in vm.group)) {\r\n    vm.critResist = 20;\r\n  }\r\n  else {\r\n    vm.critResist = vm.group.critResist;\r\n  }\r\n\r\n  if(!('eleResist' in vm.group)) {\r\n    vm.eleResist = 0;\r\n  }\r\n  else {\r\n    vm.eleResist = vm.group.eleResist;\r\n  }\r\n\r\n  if(vm.group.enemyLevel) {\r\n    vm.enemyLevel = vm.group.enemyLevel;\r\n  }\r\n  else {\r\n    vm.enemyLevel = 93;\r\n  }\r\n  \r\n  if(vm.group.playerLevel) {\r\n    vm.playerLevel = vm.group.playerLevel;\r\n  }\r\n  else {\r\n    vm.playerLevel = 93;\r\n  }\r\n  \r\n  if(vm.group.heroLevel && vm.group.heroLevel > 0) {\r\n    vm.heroLevel = vm.group.heroLevel;\r\n  }\r\n  else {\r\n    vm.heroLevel = 1;\r\n  }\r\n  \r\n  vm.init = function() {\r\n    var newJobs = jobs.getFinalJobs();\r\n    if(newJobs.length > 0) {\r\n      $timeout( function() {\r\n        \r\n        if('job' in vm.group) {\r\n          angular.forEach(newJobs, function(value, key) {\r\n            if(value.id == vm.group.job.id) {\r\n              vm.job = value;\r\n            }\r\n          });\r\n        }\r\n\r\n        vm.initDamageType();\r\n        vm.initDefaultElement();\r\n        vm.setHeroStats();\r\n      });\r\n    }\r\n  }\r\n  \r\n  vm.setJob = function() {\r\n    $window.scrollTo(0, 0);\r\n    $timeout(function() {\r\n      vm.initDamageType();\r\n      vm.initDefaultElement();\r\n    });\r\n  }\r\n  \r\n  region.init();\r\n  character.init(function() {\r\n    vm.init();\r\n  });\r\n  \r\n  vm.getStatCap = function(colName, useLevel) {\r\n    return character.getStatCaps(useLevel)[colName];\r\n  }\r\n  vm.getJobConversion = function(colName) {\r\n    return character.getConversions(vm.job.id)[colName];\r\n  }\r\n  vm.getJobBaseStat = function(colName) {\r\n    return character.getBaseStats(vm.playerLevel, vm.job.id)[colName];\r\n  }\r\n  \r\n  vm.invalidGroupName = function() {\r\n    if(!vm.groupName) {\r\n      return true;\r\n    }\r\n    \r\n    if(vm.groupName in vm.savedItems) {\r\n      if(vm.newGroup || vm.groupName != vm.oldGroupName) {\r\n        return true;\r\n      }\r\n    }\r\n    \r\n    return false;\r\n  }\r\n  \r\n  vm.ok = function() {\r\n    var enemyStatCaps = character.getStatCaps(vm.enemyLevel);\r\n    var playerStatCaps = character.getStatCaps(vm.playerLevel);\r\n    var conversions = character.getConversions(vm.job.id);\r\n    var baseStats = character.getBaseStats(vm.playerLevel, vm.job.id);\r\n    var heroStats = character.getHeroStats(vm.heroLevel);\r\n    \r\n    if(vm.newGroup) {\r\n      vm.oldGroupName = vm.groupName;\r\n      saveHelper.importGroup(vm.groupName, []);\r\n    }\r\n    \r\n    saveHelper.saveBuild(\r\n      vm.oldGroupName, \r\n      vm.groupName,\r\n      {\r\n      enemyLevel: vm.enemyLevel,\r\n      playerLevel: vm.playerLevel,\r\n      heroLevel: vm.heroLevel,\r\n      job: vm.job,\r\n      damageType: vm.damageType,\r\n      element: vm.element,\r\n      secondaryElement: vm.secondaryElement,\r\n      critResist: vm.critResist,\r\n      eleResist: vm.eleResist,\r\n      enemyStatCaps: enemyStatCaps, \r\n      playerStatCaps: playerStatCaps, \r\n      conversions: conversions,\r\n      baseStats: baseStats,\r\n      heroStats: heroStats\r\n      });\r\n    \r\n    $location.path('/build');\r\n    $location.search('buildName', vm.groupName);\r\n  }\r\n  \r\n  vm.setHeroStats = function() {\r\n    vm.heroStats = character.getHeroStats(vm.heroLevel);\r\n    // console.log('got ' + vm.heroStats.length + ' hero stats');\r\n  }\r\n  \r\n  $timeout(function() {\r\n    var input = document.getElementById('groupNameInput');\r\n    if(input) {\r\n      input.focus();\r\n      input.setSelectionRange(0, 9999);\r\n    }\r\n  });\r\n}\r\n\r\n})();","angular.module('dnsim').controller('quickAddCtrl',\r\n\r\n['$timeout','statHelper','saveHelper','quickAdd','itemCategory','jobs','dntData','exportLinkHelper',\r\nfunction($timeout,statHelper,saveHelper,quickAdd,itemCategory,jobs,dntData,exportLinkHelper) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  vm.startedForCat = '';\r\n  vm.stepNumber = 0;\r\n  vm.datas = [];\r\n  vm.options = [];\r\n  \r\n  this.setOptions = function() {\r\n    if(vm.hasStarted()) {\r\n      vm.options = quickAdd.getOptions(vm.category, vm.build, vm.datas);\r\n      if(vm.options.length == 1) {\r\n        vm.selectOption(vm.options[0]);\r\n      }\r\n    }\r\n  }\r\n  \r\n  this.selectOption = function(value) {\r\n    var data = quickAdd.createData(value, vm.category, vm.stepNumber)\r\n    vm.datas.push(data);\r\n    vm.stepNumber++;\r\n    if(!quickAdd.isValidStepNumber(vm.category, vm.stepNumber)) {\r\n      \r\n      var newItem = quickAdd.getItem(vm.datas);\r\n      var dntFiles = exportLinkHelper.getDntFiles(newItem);\r\n      angular.forEach(dntFiles, function(columns, fileName) {\r\n        dntData.init(fileName, columns, function() {}, function() { vm.tryToAddItem(dntFiles, newItem) });\r\n      });\r\n      vm.tryToAddItem(dntFiles, newItem);\r\n    }\r\n    else {\r\n      vm.setOptions();\r\n      // console.log('setup next step');\r\n    }\r\n  }\r\n  \r\n  this.tryToAddItem = function(dntFiles, item) {\r\n    if(!dntData.anyLoading()) {\r\n      \r\n      var allLoaded = true;\r\n      angular.forEach(dntFiles, function(columns, fileName) {\r\n        if(!dntData.isLoaded(fileName)) {\r\n          allLoaded = false;\r\n        }\r\n      });\r\n      \r\n      if(allLoaded) {\r\n        if(vm.datas.length > 0) {\r\n          vm.cancel();\r\n          var newItem = exportLinkHelper.reloadItem(item);\r\n          newItem.gemSlot = vm.gemSlot;\r\n          saveHelper.saveItem(vm.buildName, newItem);\r\n          vm.build.items.push(newItem);\r\n          vm.onChange();\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  this.reset = function() {\r\n    vm.stepNumber = 0;\r\n    vm.datas = [];\r\n    $timeout(function() {\r\n      vm.setOptions();\r\n    });\r\n  }\r\n  \r\n  this.hasStarted = function() {\r\n    return vm.startedForCat == vm.category.name;\r\n  }\r\n  \r\n  this.start = function() {\r\n    vm.startedForCat = vm.category.name;\r\n    \r\n    jobs.init(function() {}, vm.reset);\r\n    itemCategory.init(vm.category.name, vm.reset);\r\n  }\r\n  \r\n  this.hasOptions = function() {\r\n    return quickAdd.hasOptions(vm.category, vm.build, []);\r\n  }\r\n  \r\n  this.cancel = function() {\r\n    vm.startedForCat = '';\r\n    vm.reset();\r\n  }\r\n  \r\n  this.back = function() {\r\n    if(vm.stepNumber == 0) {\r\n      vm.cancel();\r\n    }\r\n    else {\r\n      do {\r\n        vm.stepNumber--;\r\n        vm.datas.pop();\r\n        \r\n        var testOptions = quickAdd.getOptions(vm.category, vm.build, vm.datas);\r\n      } while(testOptions.length <= 1 && vm.stepNumber > 0);\r\n      \r\n      vm.setOptions();\r\n    }\r\n  }\r\n  dntData.init('exchange.lzjson', null, function() {}, vm.reset);\r\n  \r\n}])\r\n.directive('dngearsimQuickAdd', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      category: '=category',\r\n      build: '=build',\r\n      buildName: '=buildName',\r\n      gemSlot: '=gemSlot',\r\n      onChange: '&onChange',\r\n    },\r\n    controller: 'quickAddCtrl',\r\n    controllerAs: 'quickAdd',\r\n    templateUrl: 'ui/builds/quick-add.html'\r\n  };\r\n});","angular.module('dnsim').controller('ReloadBuildCtrl',\r\n['$location','$routeParams','$timeout','saveHelper','dntData','dntReset','groupHelper','translations',reloadBuildCtrl]);\r\n\r\nfunction reloadBuildCtrl($location,$routeParams,$timeout,saveHelper,dntData,dntReset,groupHelper,translations) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  if('name' in $routeParams) {\r\n      vm.name = $routeParams.name;\r\n  }\r\n  \r\n  var savedItems = saveHelper.getSavedItems();\r\n  if(vm.name in savedItems) {\r\n    vm.build = savedItems[vm.name];\r\n  }\r\n  \r\n  vm.reloaded = false;\r\n  vm.reload = function() {\r\n    dntReset();\r\n    vm.reloaded = false;\r\n    \r\n    translations.init(progress, tryInit);\r\n\r\n    var files = groupHelper.getDntFiles(vm.build);\r\n    angular.forEach(files, function(columns, fileName) {\r\n      dntData.init(fileName, columns, progress, tryInit);\r\n    });\r\n  }\r\n  \r\n  vm.goToBuild = function() {\r\n    $location.path('/build');\r\n    $location.search('buildName', vm.name);\r\n  }\r\n  \r\n  function progress() {\r\n  }\r\n\r\n  function tryInit() {\r\n    if(vm.reloaded) {\r\n      return;\r\n    }\r\n    \r\n    var allLoaded = true;\r\n    var files = groupHelper.getDntFiles(vm.build);\r\n    angular.forEach(files, function(columns, fileName) {\r\n      if(!dntData.isLoaded(fileName)) {\r\n        allLoaded = false;\r\n        return;\r\n      }\r\n    });\r\n    \r\n    if(allLoaded && translations.isLoaded()) {\r\n      var newItems = groupHelper.reloadGroup(vm.name, vm.build);\r\n      saveHelper.updatedSavedItems(vm.name, newItems);\r\n      vm.build.items = newItems;\r\n      \r\n      vm.reloaded = true;\r\n    }\r\n  }\r\n    \r\n}","angular.module('dnsim').controller('ViewGroupCtrl', \r\n  ['$scope','$window','region','$location','$routeParams','saveHelper','dntData','$timeout','translations','dntReset','exportLinkHelper','groupHelper','jobs','character','statHelper','hCodeValues',\r\n  function($scope,$window,region,$location,$routeParams,saveHelper,dntData,$timeout,translations,dntReset,exportLinkHelper,groupHelper,jobs,character,statHelper,hCodeValues) {\r\n    'use strict';\r\n  \r\n    document.body.className = 'saved-back';\r\n    \r\n    region.setLocationByName($routeParams.region);\r\n    \r\n    $scope.buildName = '';\r\n    $scope.build = {};\r\n    \r\n\r\n    if('g' in $routeParams && 'i' in $routeParams) {\r\n      $scope.buildName = $routeParams.g;\r\n      $window.document.title = 'dngearsim | ' + $routeParams.g;\r\n      \r\n      $scope.enemyLevel = $routeParams.e;\r\n      $scope.playerLevel = $routeParams.p;\r\n      $scope.heroLevel = $routeParams.h;\r\n      $scope.job = { id: $routeParams.j };\r\n      $scope.damageType = hCodeValues.damageTypes[$routeParams.d];\r\n      $scope.element = hCodeValues.elements[$routeParams.t];\r\n      $scope.secondaryElement = hCodeValues.elements[$routeParams.s];\r\n        \r\n      var items = [];\r\n      \r\n      var itemString = $routeParams.i;\r\n      \r\n      angular.forEach(itemString.split(','), function(itemStr, index) {\r\n        var item = exportLinkHelper.decodeItem(itemStr);\r\n        \r\n        if(item.id > 0) {\r\n          items.push(item);\r\n        }\r\n      });\r\n\r\n      $scope.build = {};\r\n      $scope.savedItems = {};\r\n      $scope.savedItems[$scope.buildName] = $scope.build;\r\n      $scope.build.items = items;\r\n      $scope.isLoading = true;\r\n      \r\n      angular.forEach(groupHelper.getDntFiles($scope.build), function(columns, fileName) {\r\n        dntData.init(fileName, columns, progress, tryInit);\r\n      });\r\n      \r\n      translations.init(progress, tryInit);\r\n      jobs.init(progress, tryInit);\r\n      character.init(tryInit);\r\n      \r\n      $timeout();\r\n    }\r\n    \r\n    $scope.anyItems = Object.keys($scope.savedItems).length > 0;\r\n    \r\n    function tryInit() {\r\n      \r\n      var allInit = true;\r\n      angular.forEach(groupHelper.getDntFiles($scope.build), function(columns, fileName) {\r\n        if(!dntData.isLoaded(fileName)) {\r\n          allInit = false;\r\n        }\r\n      });\r\n      \r\n      if(!allInit || dntData.anyLoading() || !translations.isLoaded() || !jobs.isLoaded()) {\r\n        return;\r\n      }\r\n      \r\n      $timeout(function() {\r\n        var groupName = $scope.buildName;\r\n        var group = $scope.build;\r\n        \r\n        $scope.job = jobs.getById($scope.job.id);\r\n        \r\n        $scope.enemyStatCaps = character.getStatCaps($scope.enemyLevel);\r\n        $scope.playerStatCaps = character.getStatCaps($scope.playerLevel);\r\n        if($scope.job) {\r\n          $scope.conversions = character.getConversions($scope.job.id);\r\n          $scope.baseStats = character.getBaseStats($scope.playerLevel, $scope.job.id);\r\n        }\r\n        $scope.heroStats = character.getHeroStats($scope.heroLevel);\r\n        \r\n        var newItems = groupHelper.reloadGroup(groupName, group);\r\n      \r\n        $scope.savedItems = {};\r\n        $scope.build = {\r\n          items: newItems,\r\n          lastUpdate: group.lastUpdate,\r\n\r\n          enemyLevel: $scope.enemyLevel,\r\n          playerLevel: $scope.playerLevel,\r\n          heroLevel: $scope.heroLevel,\r\n          job: $scope.job,\r\n          damageType: $scope.damageType,\r\n          element: $scope.element,\r\n          secondaryElement: $scope.secondaryElement,\r\n          enemyStatCaps: $scope.enemyStatCaps,\r\n          playerStatCaps: $scope.playerStatCaps,\r\n          conversions: $scope.conversions,\r\n          baseStats: $scope.baseStats,\r\n          heroStats: $scope.heroStats,\r\n        };\r\n        $scope.savedItems[groupName] = $scope.build;\r\n        $scope.stats = statHelper.getBuildStats($scope.build);\r\n        \r\n        var longUrl = exportLinkHelper.createGroupLink($scope.buildName, $scope.build);\r\n        $scope.build.shortUrl = sessionStorage.getItem(longUrl);\r\n      });\r\n    }\r\n    \r\n    function progress() {\r\n    }\r\n    \r\n    $scope.copyGroup = function() {\r\n      var newBuildName = saveHelper.importGroup($scope.buildName, $scope.build.items);\r\n      // console.log('copying in as ' + newBuildName);\r\n      \r\n      saveHelper.saveBuild(\r\n        newBuildName, \r\n        newBuildName,\r\n        {\r\n          enemyLevel: $scope.enemyLevel,\r\n          playerLevel: $scope.playerLevel,\r\n          heroLevel: $scope.heroLevel,\r\n          job: $scope.job,\r\n          damageType: $scope.damageType,\r\n          element: $scope.element,\r\n          secondaryElement: $scope.secondaryElement,\r\n          critResist: $scope.critResist,\r\n          eleResist: $scope.eleResist,\r\n          enemyStatCaps: $scope.enemyStatCaps,\r\n          playerStatCaps: $scope.playerStatCaps,\r\n          conversions: $scope.conversions,\r\n          baseStats: $scope.baseStats,\r\n          heroStats: $scope.heroStats\r\n        });\r\n      \r\n      $location.url('/build?buildName=' + newBuildName);\r\n    }\r\n  }]\r\n);\r\n","angular.module('dnsim').controller('ExportCtrl', \r\n  ['$scope','$window','saveHelper',\r\n   function($scope, $window, saveHelper) {\r\n  'use strict';\r\n     \r\n  document.body.className = 'default-back';\r\n  $window.document.title = 'dngearsim | EXPORT';\r\n  \r\n  var rawSavedData = saveHelper.getSavedItems();\r\n  $scope.exportData = JSON.stringify(rawSavedData, null, 1);\r\n  \r\n  $scope.save = function() {\r\n    localStorage.setItem('savedItems', LZString.compressToUTF16($scope.exportData));\r\n  }\r\n}]);\r\n","angular.module('dnsim').controller('HeaderCtrl', \r\n[\r\n  function() {\r\n    'use strict';\r\n    var vm = this;\r\n  }\r\n]).directive('dngearsimHeader', function() {\r\n  return {\r\n    templateUrl: 'ui/nav/header.html',\r\n  };\r\n});","angular.module('dnsim').controller('NavCtrl', \r\n  ['$scope','$location','translations','region','itemCategory','saveHelper',\r\n  function($scope,$location,translations,region,itemCategory,saveHelper) {\r\n    'use strict';\r\n    \r\n    try {\r\n      var noLocationMenu = [];\r\n      var normalMenu = [\r\n        {path: 'builds', name:'builds', icon: 'menu-hamburger'},\r\n        {path: 'search', name:'search', icon: 'search'},\r\n        ];\r\n      \r\n      var buildAction = {path: 'build', name:'build'};\r\n      \r\n      var withBuildMenu = [\r\n        {path: 'builds', name:'builds', icon: 'menu-hamburger'},\r\n        {path: 'search', name:'search', icon: 'search'},\r\n        buildAction,\r\n        ];\r\n        \r\n      region.init();\r\n    \r\n      $scope.isSearch = function() {\r\n        return $location.path().indexOf('/search') == 0;\r\n      }\r\n  \r\n      $scope.isLoading = function() {\r\n        return translations.startedLoading && \r\n              !translations.isLoaded() &&\r\n              region.tlocation != null &&\r\n              region.tlocation.url != '' &&\r\n              !$scope.noRegion();\r\n      }\r\n      \r\n      $scope.noRegion = function() {\r\n        return region.dntLocation == null;\r\n      }\r\n      \r\n      $scope.isHttpOnly = function() {\r\n        return location.protocol != 'https:' && location.hostname != 'localhost';\r\n      }\r\n        \r\n      $scope.getActions = function() {\r\n        try {\r\n          var menu = null;\r\n          \r\n          var currentBuild = saveHelper.getCurrentBuild();\r\n          if(currentBuild) {\r\n            if(!$scope.savedItems || !(currentBuild in $scope.savedItems)) {\r\n              // console.log('loading saved items');\r\n              $scope.savedItems = saveHelper.getSavedItems();\r\n            }\r\n            \r\n            if(!(currentBuild in $scope.savedItems)) {\r\n              currentBuild = null;\r\n            }\r\n          }\r\n    \r\n          if(region.dntLocation != null && region.dntLocation.url == '') {\r\n            menu = noLocationMenu; \r\n          }\r\n          else if(region.tlocation != null && region.tlocation.url == '') {\r\n            menu = noLocationMenu; \r\n          }\r\n          else if(currentBuild && currentBuild != 'null') {\r\n            menu = withBuildMenu;\r\n            buildAction.path = 'build?buildName=' + currentBuild;\r\n            buildAction.name = currentBuild;\r\n            if(currentBuild in $scope.savedItems) {\r\n              buildAction.build = $scope.savedItems[currentBuild];\r\n            }\r\n          }\r\n          else if($location.path() == '/view-group' || region.dntLocation == null) {\r\n            menu = normalMenu;\r\n          }\r\n          else {\r\n            menu = normalMenu;\r\n          }\r\n          \r\n          var path = $location.path;\r\n          angular.forEach(menu, function(value, key) {\r\n            delete value.extraCss;\r\n            if(path && path.length == 1) {\r\n              if(value.path.length == 1) {\r\n                value.extraCss = 'active';\r\n              }\r\n            }\r\n            else if(value.path && value.path.length > 1 && path.indexOf('/' + value.path) == 0) {\r\n              if(value.path != 'builds' || path == '/builds') {\r\n                value.extraCss = 'active';\r\n              }\r\n            }\r\n          });\r\n          \r\n          return menu;\r\n        }\r\n        catch(ex) {\r\n          $scope.simError = ex.message;\r\n          console.error(ex);\r\n        }\r\n      };\r\n    }\r\n    catch(ex) {\r\n      $scope.simError = ex.message;\r\n      console.error(ex);\r\n    }\r\n  }\r\n])\r\n.directive('dngearsimNav', function() {\r\n  return {\r\n    templateUrl: 'ui/nav/nav.html'\r\n  };\r\n});","angular.module('dnsim').controller('SetupCtrl', \r\n  ['$scope','$window','$route','$timeout','translations','dntInit','dntReset','region',\r\n   function($scope, $window, $route, $timeout, translations, dntInit, dntReset, region) {\r\n  'use strict';\r\n     \r\n  document.body.className = 'default-back';\r\n  $window.document.title = 'dngearsim | SETUP';\r\n  \r\n  $scope.advancedSetup = false;\r\n  $scope.isLoading = translations.startedLoading && !translations.isLoaded();\r\n  $scope.translationResults = [];\r\n  $scope.hostedFiles = region.hostedFiles;\r\n  \r\n  var noLocation = '';\r\n  var sessionLocation = region.alternativeFiles.url;\r\n  if(sessionLocation == null) {\r\n    sessionLocation = noLocation;\r\n  }\r\n  \r\n  $scope.location = sessionLocation;\r\n  if($scope.location == noLocation) {\r\n    $scope.testResults = ['No location set'];\r\n  }\r\n  else {\r\n    $scope.testResults = ['Using location ' + $scope.location];\r\n  }\r\n  \r\n  $scope.setLocation = function(url) {\r\n    $scope.location = url;\r\n    $scope.isLoading = true;\r\n    $scope.saveLocation();\r\n    dntReset();\r\n\r\n    $scope.translationResults = [];\r\n    var existingFile = localStorage.getItem('UIStrings_file');\r\n    if(existingFile == null || existingFile.indexOf(url) == -1) {\r\n      sessionStorage.removeItem('UIStrings');\r\n    }\r\n    translations.reset();\r\n    translations.location = url;\r\n    translations.init(progressTranslations, translationsStatus);\r\n  }\r\n  \r\n  $scope.resetSessionData = function() {\r\n    $scope.testResults = ['session data reset.. reloading page'];\r\n    region.tlocation = null;\r\n    region.dntLocation = null;\r\n    translations.reset();\r\n    sessionStorage.clear();\r\n    localStorage.clear();\r\n    this.saveLocation();\r\n    $timeout(function() {   \r\n      location.hash = '';\r\n      location.reload(true);\r\n    });\r\n  }\r\n  \r\n  $scope.loadUiString = function() {\r\n    $scope.translationResults = [];\r\n    sessionStorage.removeItem('UIStrings');\r\n    dntReset();\r\n    translations.reset();\r\n    translations.location = region.tlocation.url;\r\n    translations.region = region.tlocation.region;\r\n    translations.init(progressTranslations, translationsStatus);\r\n  }\r\n  \r\n  function translationsStatus() {\r\n    progressTranslations('current translations contain words like ' + translations.translate(329) + ', ' + translations.translate(323) + ' and ' + translations.translate(335));\r\n    $scope.isLoading = false;\r\n  }\r\n  \r\n  function progress(msg) {\r\n    $timeout(\r\n      function() {\r\n        if($scope.testResults != null) {\r\n          $scope.testResults.push(msg);\r\n        }\r\n      });\r\n  }\r\n  \r\n  function progressTranslations(msg) {\r\n    $timeout(\r\n      function() {\r\n        if($scope.translationResults != null) {\r\n          $scope.translationResults.push(msg);\r\n        }\r\n      });\r\n  }\r\n  \r\n  $scope.saveLocation = function() {\r\n    dntReset();\r\n    if($scope.location != noLocation) {\r\n      region.setCustomUrl($scope.location);\r\n      \r\n      region.init();\r\n      if(region.alternativeFiles.region == region.tlocation.region) {\r\n        translations.reset();\r\n        translations.init(progressTranslations, translationsStatus);\r\n      }\r\n      $scope.testResults = [\r\n        'Location saved',\r\n        'Using location ' + $scope.location];\r\n    }\r\n  }\r\n  \r\n  $scope.testLocation = function() {\r\n    if($scope.location != noLocation) {\r\n      $scope.testResults = [\r\n        'Using location ' + $scope.location,\r\n        'Loading all data used by the app'];\r\n\r\n      translations.init(progress, function () {\r\n        dntInit(progress);\r\n      });\r\n    }\r\n  }\r\n}]);\r\n","(function () {\r\n'use strict';\r\nangular.module('dnsim').controller('BuildSearchCtrl', ['$routeParams','$location','$timeout','onlineService','jobs', buildSearch]);\r\n\r\nfunction buildSearch($routeParams,$location,$timeout,onlineService,jobs) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  \r\n  vm.maxDisplay = 15;\r\n  vm.totalNumResults = 0;\r\n  \r\n  jobs.init(null, function() {\r\n    if($routeParams.jobId) {\r\n      vm.job = jobs.getById($routeParams.jobId);\r\n      getClassBuilds();\r\n    } \r\n  })\r\n  \r\n  this.setJob = function() {\r\n    $timeout(function() {\r\n      $location.search('jobId', vm.job.id);\r\n    });\r\n  }\r\n  \r\n  this.showMoreResults = function(extra) {\r\n    vm.maxDisplay = vm.totalNumResults + extra;\r\n    vm.totalNumResults = 0;\r\n  }\r\n  \r\n  vm.allResults = null;\r\n  vm.getFilteredBuilds = function() {\r\n    \r\n    // init\r\n    if(vm.allResults == null) {\r\n      vm.allResults = [];\r\n      for(var uid in vm.jobBuilds) {\r\n        for(var buildName in vm.jobBuilds[uid]) {\r\n          vm.allResults.push({\r\n            uid: uid,\r\n            name: buildName,\r\n            data: vm.jobBuilds[uid][buildName]\r\n          });\r\n        }\r\n      }\r\n    }\r\n    \r\n    var results = [];\r\n    for(var i=0;i<vm.allResults.length;++i) {\r\n      \r\n      var result = vm.allResults[i];\r\n      if(vm.filter && vm.filter.length > 0) {\r\n        var f = vm.filter.toUpperCase();\r\n        if(result.name.toUpperCase().indexOf(f) == -1) {\r\n          if(!result.data.guild ||\r\n             result.data.guild.toUpperCase().indexOf(f) == -1) {\r\n\r\n            continue;\r\n          }\r\n        }\r\n      }\r\n      \r\n      results.push(result);\r\n\r\n      if(results.length >= vm.maxDisplay) {\r\n        break;\r\n      }\r\n    }\r\n    \r\n    vm.totalNumResults = results.length;\r\n    return results;\r\n  }\r\n  \r\n  function getClassBuilds() {\r\n    if(vm.job) {\r\n      onlineService.getClassBuilds(vm.job).then(function(builds) {\r\n        if(builds) {\r\n          // console.log('got builds', builds);\r\n          vm.jobBuilds = builds;\r\n        }\r\n        else {\r\n          // console.log('no builds');\r\n          vm.jobBuilds = {};\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\nangular.module('dnsim').controller('ProfileCtrl', ['$location', '$routeParams', 'onlineService', profile]);\r\n\r\nfunction profile($location, $routeParams, onlineService, saveHelper) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  vm.uid = $routeParams.uid;\r\n  \r\n  getSavedBuilds();\r\n  getProfile();\r\n  \r\n  function getSavedBuilds() {\r\n    onlineService.getUserBuilds(vm.uid).then(function(builds) {\r\n      if(builds) {\r\n        vm.storedBuilds = builds;\r\n      }\r\n      else {\r\n        vm.storedBuilds = {};\r\n      }\r\n    });\r\n  }\r\n  \r\n  function getProfile() {\r\n    onlineService.getProfile(vm.uid).then(function(profile) {\r\n      if(profile) {\r\n        vm.profile = profile;\r\n      }\r\n      else {\r\n        vm.profile = {};\r\n      }\r\n    });\r\n  }\r\n  \r\n  this.load = function(buildName, build) {\r\n\r\n    var newGroupName = saveHelper.importGroup(buildName, build.items);\r\n    \r\n    saveHelper.saveBuild(\r\n      newGroupName, \r\n      newGroupName,\r\n      build);\r\n      \r\n    vm.builds = saveHelper.getSavedItems();\r\n    \r\n    $location.path('/build');\r\n    $location.search('buildName', newGroupName);\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\nangular.module('dnsim').controller('PublishCtrl', ['$location', 'saveHelper', 'onlineService', '$routeParams', 'region', publish]);\r\n\r\nfunction publish($location, saveHelper, onlineService, $routeParams, region) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  \r\n  vm.show = $routeParams.show;\r\n  \r\n  onlineService.login().then(function(user) {\r\n    getSavedBuilds();\r\n    getProfile();\r\n  \r\n    vm.builds = saveHelper.getSavedItems();\r\n  });\r\n  \r\n  function getSavedBuilds() {\r\n    var user = vm.getUser();\r\n    if(user) {\r\n      onlineService.getUserBuilds(user.uid).then(function(builds) {\r\n        if(builds) {\r\n          vm.storedBuilds = builds;\r\n        }\r\n        else {\r\n          vm.storedBuilds = {};\r\n        }\r\n      });\r\n    }\r\n  }\r\n  \r\n  function getProfile() {\r\n    var user = vm.getUser();\r\n    if(user) {\r\n      onlineService.getProfile(user.uid).then(function(profile) {\r\n        if(profile) {\r\n          vm.profile = profile;\r\n        }\r\n        else {\r\n          vm.profile = {};\r\n        }\r\n      });\r\n    }\r\n  }\r\n  \r\n  this.saveProfile = function() {\r\n    onlineService.saveProfile(vm.profile).then(getProfile).catch(handleError);\r\n  }\r\n  \r\n  this.getUser = function() {\r\n    return onlineService.getUser();\r\n  }\r\n  \r\n  this.save = function(buildName, build) {\r\n    build.lastUpdate = (new Date()).getTime();\r\n    onlineService.saveBuild(buildName, build).then(getSavedBuilds).catch(handleError);\r\n    vm.publishBuild = null;\r\n  }\r\n  \r\n  this.startPublish = function(buildName) {\r\n    if(buildName in vm.storedBuilds) {\r\n      if(!vm.builds[buildName].region) {\r\n        vm.builds[buildName].region = vm.storedBuilds[buildName].region;\r\n      }\r\n      \r\n      if(!vm.builds[buildName].about) {\r\n        vm.builds[buildName].about = vm.storedBuilds[buildName].about;\r\n      }\r\n      \r\n      if(!vm.builds[buildName].guild) {\r\n        vm.builds[buildName].guild = vm.storedBuilds[buildName].guild;\r\n      }\r\n    }\r\n    \r\n    if(!vm.builds[buildName].region) {\r\n      vm.builds[buildName].region = region.dntLocation.region;\r\n    }\r\n    \r\n    vm.publishBuild = buildName;\r\n  }\r\n  \r\n  function handleError(err) {\r\n    console.log(err);\r\n  }\r\n  \r\n  this.deleteAccount = function() {\r\n    onlineService.deleteAccount(vm.storedBuilds);\r\n  }\r\n  \r\n  this.getBuildLimit = function() {\r\n    if(vm.profile && vm.profile.maxBuilds) {\r\n      return vm.profile.maxBuilds;\r\n    }\r\n    else {\r\n      return 15;\r\n    }\r\n  }\r\n  \r\n  this.getNumStoredBuilds = function() {\r\n    return _.size(vm.storedBuilds);\r\n  }\r\n  \r\n  this.getNumBuilds = function() {\r\n    return _.size(vm.builds);\r\n  }\r\n  \r\n  this.load = function(buildName, build) {\r\n\r\n    var newGroupName = saveHelper.importGroup(buildName, build.items);\r\n    \r\n    saveHelper.saveBuild(\r\n      newGroupName, \r\n      newGroupName,\r\n      build);\r\n      \r\n    vm.builds = saveHelper.getSavedItems();\r\n  }\r\n  \r\n  this.signOut = function() {\r\n    onlineService.signOut();\r\n  }\r\n  \r\n  vm.deleteLocal = function(buildName) {\r\n    vm.localToDelete = buildName;\r\n  }\r\n  \r\n  vm.getAllBuildNames = function() {\r\n    var allKeys = _.keys(vm.builds).concat(_.keys(vm.storedBuilds));\r\n    return _.uniq(allKeys.sort(), true);\r\n  }\r\n  \r\n  vm.reallyDeleteLocal = function(buildName) {\r\n    saveHelper.updatedSavedItems(buildName, []);\r\n    vm.localToDelete = null;\r\n    vm.builds = saveHelper.getSavedItems();\r\n  }\r\n  \r\n  vm.deleteServer = function(buildName) {\r\n    vm.serverToDelete = buildName;\r\n  }\r\n  \r\n  vm.reallyDeleteServer = function(buildName) {\r\n    onlineService.deleteBuild(buildName, vm.storedBuilds[buildName]).then(getSavedBuilds);\r\n    vm.serverToDelete = null;\r\n  }\r\n  \r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\nangular.module('dnsim').controller('PublishedCtrl', ['onlineService', '$location', '$routeParams', 'saveHelper', 'statHelper', published]);\r\n\r\nfunction published(onlineService, $location, $routeParams, saveHelper, statHelper) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  vm.uid = $routeParams.uid;\r\n  vm.buildName = $routeParams.buildName;\r\n  \r\n  getBuild();\r\n  getProfile();\r\n  \r\n  vm.copyLocally = function() {\r\n    var newGroupName = saveHelper.importGroup(vm.buildName, vm.build.items);\r\n    \r\n    saveHelper.saveBuild(\r\n      newGroupName, \r\n      newGroupName,\r\n      vm.build);\r\n      \r\n    $location.path('/build');\r\n    $location.search('buildName', newGroupName);\r\n  }\r\n  \r\n  function getProfile() {\r\n    onlineService.getProfile(vm.uid).then(function(profile) {\r\n      if(profile) {\r\n        vm.profile = profile;\r\n      }\r\n      else {\r\n        vm.profile = {};\r\n      }\r\n    });\r\n  }\r\n  \r\n  function getBuild() {\r\n    onlineService.getBuild(vm.uid, vm.buildName).then(function(build) {\r\n      if(build) {\r\n        vm.build = build;\r\n        vm.stats = statHelper.getBuildStats(build);\r\n      }\r\n      else {\r\n        vm.build = {};\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\n})();","angular.module('dnsim').controller('RegionCtrl', \r\n  ['$timeout','$route','$routeParams','$location','translations','region','$http',\r\n  function($timeout,$route,$routeParams,$location,translations,region,$http) {\r\n    'use strict';\r\n    \r\n    var vm = this;\r\n\r\n    vm.override = region.getOverride();\r\n    region.init();\r\n    translations.init(\r\n      function(msg) { \r\n        // console.log(msg);\r\n      }, \r\n      function() {\r\n        $timeout();\r\n      });\r\n      \r\n    vm.region = region;\r\n    vm.tHoverLocation = region.tlocation;\r\n    vm.hoverLocation = region.dntLocation;\r\n    vm.edit = (region.dntLocation == null);\r\n    vm.dntVersion = '';\r\n    setDntVersion();\r\n    \r\n    function setDntVersion() {\r\n      // console.log('setting version for ', vm.region.dntLocation);\r\n      if(vm.region.dntLocation && vm.region.dntLocation.url) {\r\n        $http.get(vm.region.dntLocation.url + '/Version.cfg').then(function(res) {\r\n          if(res && res.data) {\r\n            var newLineDetails = res.data.split('\\r\\n');\r\n            if(newLineDetails.length) {\r\n              var spaceDetails = newLineDetails[0].split(' ');\r\n              if(spaceDetails.length > 1) {\r\n                vm.dntVersion = 'v' + spaceDetails[1];\r\n              }\r\n            }\r\n          }\r\n        });\r\n      }\r\n    }\r\n    \r\n    vm.getDntLocation = function() {\r\n      return region.dntLocation;\r\n    };\r\n    vm.getTlocation = function() {\r\n      return region.tlocation;\r\n    };\r\n     \r\n    vm.getHostedFiles = function() {\r\n      // console.log('getting hosted files');\r\n      return region.hostedFiles;\r\n    };\r\n    \r\n    vm.getWorldName = function() {\r\n      if(translations.isLoaded()) {\r\n        return translations.translate(10169);\r\n      }\r\n      else {\r\n        return '';\r\n      }\r\n    };\r\n    \r\n    vm.setTLocation = function(location) {\r\n      region.setTLocation(location);\r\n      vm.edit = false;\r\n    };\r\n    \r\n    vm.setLocation = function(location) {\r\n      if(!vm.override) {\r\n        vm.setTLocation(null);\r\n      }\r\n      \r\n      if($routeParams.region) {\r\n        $routeParams.region = location.region;\r\n        $route.updateParams($routeParams);\r\n        $route.reload();\r\n      }\r\n      else {\r\n        region.setLocation(location);\r\n      }\r\n      vm.edit = false;\r\n      setDntVersion();\r\n    };\r\n    \r\n    vm.setOverride = function(value) {\r\n      region.setOverride(value);\r\n      vm.override = value;\r\n      vm.edit = value;\r\n    };\r\n  }\r\n])\r\n.directive('dngearsimRegion', function() {\r\n  return {\r\n    templateUrl: 'ui/region/region.html',\r\n    controllerAs: 'ctrl',\r\n  };\r\n});","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').directive('dngearsimCustomItems', function() {\r\n  return {\r\n    scope: {},\r\n    bindToController: {\r\n    },\r\n    controller: ['$window','saveHelper','$location','hCodeValues','itemCategory','$timeout', customItemCtrl],\r\n    controllerAs: 'customItems',\r\n    templateUrl: 'ui/search/custom-items.html'\r\n  };\r\n});\r\n\r\nfunction customItemCtrl($window,saveHelper,$location,hCodeValues,itemCategory,$timeout) {\r\n  'use strict';\r\n\r\n  var vm = this;\r\n  \r\n  this.customItems = hCodeValues.customItems;\r\n  \r\n  this.maxDisplay = 10;\r\n  this.currentResults = 0;\r\n  \r\n  if(this.nameSearch == null) {\r\n    this.nameSearch = '';\r\n  }\r\n  \r\n  this.getResults = function() {\r\n    return this.customItems;\r\n  }\r\n  \r\n  this.getNewStatName = function() {\r\n    if(this.nameSearch == '' || this.nameSearch == null) {\r\n      return 'unnamed custom item';\r\n    }\r\n    else {\r\n      return this.nameSearch;\r\n    }\r\n  }\r\n  \r\n  this.createCustomItem = function() {\r\n    if(this.nameSearch == '' || this.nameSearch == null) {\r\n      this.nameSearch = this.getNewStatName();\r\n    }\r\n    $location.path('/item/_custom:.' + this.nameSearch);\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').directive('dngearsimEverythingSearch', function() {\r\n  return {\r\n    scope: {},\r\n    bindToController: {\r\n      nameSearch: '=nameSearch'\r\n    },\r\n    controller: everythingSearchCtrl,\r\n    controllerAs: 'items',\r\n    templateUrl: 'ui/search/everything-search.html'\r\n  };\r\n});\r\n\r\n\r\nfunction everythingSearchCtrl ($window, $timeout, $routeParams, $location, hCodeValues, region, translations, dntData) {\r\n    \r\n  var vm = this;\r\n  \r\n  vm.everything = null;\r\n  vm.maxDisplay = 32;\r\n  vm.currentResults = 0;\r\n  vm.results = null;\r\n  vm.minLevel = 1;\r\n  vm.maxLevel = 99;\r\n  vm.version = 'all';\r\n  vm.versions = [vm.version];\r\n  \r\n  var minLevel = Number(localStorage.getItem('minLevel'));\r\n  if($routeParams.minLevel) {\r\n    minLevel = Number($routeParams.minLevel);\r\n  }\r\n  if(minLevel > 0 && minLevel < 100) {\r\n    vm.minLevel = minLevel;\r\n  }\r\n  vm.origMinLevel = minLevel;\r\n  \r\n  var maxLevel = Number(localStorage.getItem('maxLevel'));\r\n  if($routeParams.maxLevel) {\r\n    maxLevel = Number($routeParams.maxLevel);\r\n  }\r\n  if(maxLevel > 0 && maxLevel < 100) {\r\n    vm.maxLevel = maxLevel;\r\n  }\r\n  vm.origMaxLevel = maxLevel;\r\n\r\n  if(!vm.nameSearch) {\r\n    vm.nameSearch = localStorage.getItem('nameSearch');\r\n    if($routeParams.name) {\r\n      vm.nameSearch = $routeParams.name;\r\n    }\r\n    if(vm.nameSearch == null) {\r\n      vm.nameSearch = '';\r\n    }\r\n  }\r\n  \r\n  $window.document.title = 'dngearsim | ALL ITEM SEARCH';\r\n  \r\n  vm.initeverything = function() {\r\n    if(dntData.isLoaded(fileName) && translations.isLoaded() && !vm.everything) {\r\n      vm.everything = [];\r\n      \r\n      var versionMap = {};\r\n      var datas = dntData.getData(fileName);\r\n      // console.log(datas.length + ' everything');\r\n      for(var i=0;i<datas.length;++i) {\r\n        var data = datas[i];\r\n        if(data.NameID > 0) {\r\n          var item = {\r\n            id: data.id,\r\n            name: translations.translate(data.NameID, data.NameIDParam),\r\n            rank: hCodeValues.rankNames[data.Rank],\r\n            icon: data.IconImageIndex,\r\n            levelLimit: data.LevelLimit,\r\n            fileName: data.fileName,\r\n            version: data.version\r\n          }\r\n          vm.everything.push(item);\r\n\r\n          if(data.version) {\r\n            versionMap[data.version] = true;\r\n          }\r\n        }\r\n      }\r\n\r\n      for(var version in versionMap) {\r\n        vm.versions.push(version);\r\n      }\r\n      \r\n      vm.everything = _.sortBy(vm.everything, 'name');\r\n      \r\n      $timeout(function() {\r\n        vm.showMoreResults();\r\n      });\r\n    }\r\n  }\r\n  \r\n  vm.getResults = function() {\r\n    if(vm.everything == null) {\r\n      vm.initeverything();\r\n    }\r\n    \r\n    if(vm.everything == null) {\r\n      return [];\r\n    }\r\n\r\n    var newResults = [];\r\n    var numeverything = vm.everything.length;\r\n    var curDisplay = 0;\r\n    for(var i=0;i<numeverything && (curDisplay<vm.maxDisplay);++i) {\r\n      var e = vm.everything[i];\r\n\r\n      if(e.levelLimit < vm.minLevel || e.levelLimit > vm.maxLevel || (!e.levelLimit)) {\r\n        continue;\r\n      }\r\n\r\n      if(vm.version != 'all' && vm.version != e.version) {\r\n        continue;\r\n      }\r\n\r\n      if(vm.nameSearch != '') {\r\n        var nameSearches = vm.nameSearch.split(' ');\r\n        if(nameSearches.length == 0) {\r\n          nameSearches = [vm.nameSearch];\r\n        }\r\n        var allMatch = true;\r\n        for(var ns=0;ns<nameSearches.length;++ns) {\r\n          if(e.name && e.name.toString().toUpperCase().indexOf(nameSearches[ns].toUpperCase()) == -1) {\r\n            allMatch = false;\r\n            break;\r\n          }\r\n        }\r\n        \r\n        if(!allMatch) {\r\n          continue;\r\n        }\r\n      }\r\n      \r\n      newResults.push(e);\r\n      curDisplay++;\r\n    }\r\n    \r\n    vm.totalNumResults = newResults.length;\r\n    return newResults;\r\n  }\r\n  \r\n  vm.changeSearch = function() {\r\n    if(vm.minLevel != vm.origMinLevel) {\r\n      localStorage.setItem('minLevel', vm.minLevel);\r\n      $location.search('minLevel', vm.minLevel);\r\n      vm.origMinLevel = vm.minLevel;\r\n    }\r\n    \r\n    if(vm.maxLevel != vm.origMaxLevel) {\r\n      localStorage.setItem('maxLevel', vm.maxLevel);\r\n      $location.search('maxLevel', vm.maxLevel);\r\n      vm.origMaxLevel = vm.maxLevel;\r\n    }\r\n\r\n    localStorage.setItem('nameSearch', vm.nameSearch);\r\n    $location.search('name', vm.nameSearch);\r\n    \r\n    vm.maxDisplay = 64;\r\n    vm.results = vm.getResults();\r\n  }\r\n\r\n  vm.showMoreResults = function() {\r\n    $timeout(function() {\r\n      // console.log('show more', vm.maxDisplay);\r\n      vm.maxDisplay += 18;\r\n      vm.results = vm.getResults();\r\n    });\r\n  }\r\n\r\n  var fileName = 'all-items.lzjson';  \r\n  dntData.init(fileName, null, function() {}, function() {\r\n    vm.initeverything();\r\n  }, false);\r\n\r\n  translations.init(null, vm.initeverything);\r\n}\r\n\r\n})();\r\n","(function () {\r\n'use strict';\r\n\r\nvar controllerParams = ['$scope','$window','$routeParams','$timeout','$location','$route',\r\n'translations',\r\n'itemCategory',\r\n'jobs',\r\n'hCodeValues',\r\n'itemFactory',\r\n'region',\r\n'saveHelper', itemSearchCtrl];\r\n\r\nangular.module('dnsim').controller('ItemSearchCtrl', controllerParams);\r\n\r\nfunction itemSearchCtrl(\r\n  $scope,$window,$routeParams,$timeout,$location,$route,\r\n  translations,\r\n  itemCategory,\r\n  jobs,\r\n  hCodeValues,\r\n  itemFactory,\r\n  region,\r\n  saveHelper) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  \r\n  vm.itemCategory = itemCategory.byPath($routeParams.cat);\r\n  if(!vm.itemCategory) {\r\n     var catName = localStorage.getItem('selectedItemCategory');\r\n     if(!catName) {\r\n       catName = 'titles';\r\n     }\r\n     \r\n     vm.itemCategory = itemCategory.byName(catName);\r\n     if(!vm.itemCategory || vm.itemCategory.hideInSearch) {\r\n       catName = 'titles';\r\n       vm.itemCategory = itemCategory.byName('titles');\r\n     }\r\n     if(vm.itemCategory) {\r\n       // console.log('moving');\r\n       $location.search('cat', vm.itemCategory.path);\r\n       $route.reload();\r\n     }\r\n     return;\r\n  }\r\n  \r\n  \r\n  $window.document.title = 'dngearsim | SEARCH ' + vm.itemCategory.name.toUpperCase();\r\n  \r\n  vm.job = {id: -1, name: ''};\r\n  vm.jobs = [vm.job];\r\n  vm.allJobs = [];\r\n  vm.minLevel = 1;\r\n  vm.maxLevel = 99;\r\n  vm.maxDisplay = 10;\r\n  vm.totalNumResults = 0;\r\n  vm.grades = hCodeValues.rankNames;\r\n  vm.stat = {id:-1, name:''};\r\n  vm.stats = [vm.stat];\r\n  vm.results = null;\r\n  \r\n  angular.forEach(hCodeValues.stats, function(stat, statId) {\r\n    if(stat.searchable) {\r\n      vm.stats.push(stat);\r\n    }\r\n  });\r\n  \r\n  var minLevel = Number(localStorage.getItem('minLevel'));\r\n  if($routeParams.minLevel) {\r\n    minLevel = Number($routeParams.minLevel);\r\n  }\r\n  if(minLevel > 0 && minLevel < 100) {\r\n    vm.minLevel = minLevel;\r\n  }\r\n  vm.origMinLevel = minLevel;\r\n  \r\n  var maxLevel = Number(localStorage.getItem('maxLevel'));\r\n  if($routeParams.maxLevel) {\r\n    maxLevel = Number($routeParams.maxLevel);\r\n  }\r\n  if(maxLevel > 0 && maxLevel < 100) {\r\n    vm.maxLevel = maxLevel;\r\n  }\r\n  vm.origMaxLevel = maxLevel;\r\n  \r\n  vm.nameSearch = localStorage.getItem('nameSearch');\r\n  if($routeParams.name) {\r\n    vm.nameSearch = $routeParams.name;\r\n  }\r\n  if(!vm.nameSearch) {\r\n    vm.nameSearch = '';\r\n  }\r\n  \r\n  vm.origSavedSearchStatId = localStorage.getItem('searchStat');\r\n  if($routeParams.stat) {\r\n    vm.origSavedSearchStatId = $routeParams.stat;\r\n  }\r\n  if(vm.origSavedSearchStatId > -1 && vm.origSavedSearchStatId in hCodeValues.stats) {\r\n    vm.stat = hCodeValues.stats[vm.origSavedSearchStatId];\r\n  }\r\n\r\n  vm.navigate = function() {\r\n    var catName = localStorage.getItem('selectedItemCategory');\r\n    if(catName) {\r\n      vm.itemCategory = itemCategory.byName(catName);\r\n      if(vm.itemCategory) {\r\n        // console.log('navigating to ', vm.itemCategory.path);\r\n        $location.search('cat', vm.itemCategory.path);\r\n        vm.save();\r\n        $route.reload();\r\n      }\r\n    }\r\n  }\r\n\r\n  vm.save = function() {\r\n    if(!vm.itemCategory.hideLevel) {\r\n      if(vm.minLevel != vm.origMinLevel) {\r\n        localStorage.setItem('minLevel', vm.minLevel);\r\n        $location.search('minLevel', vm.minLevel);\r\n        vm.origMinLevel = vm.minLevel;\r\n      }\r\n      \r\n      if(vm.maxLevel != vm.origMaxLevel) {\r\n        localStorage.setItem('maxLevel', vm.maxLevel);\r\n        $location.search('maxLevel', vm.maxLevel);\r\n        vm.origMaxLevel = vm.maxLevel;\r\n      }\r\n    }\r\n    else {\r\n      $location.search('minLevel', null);\r\n      $location.search('maxLevel', null);\r\n    }\r\n    \r\n    if(!vm.itemCategory.hideJob) {\r\n      if(vm.job != null) {\r\n        if(vm.origJobNumber != vm.job.id) {\r\n          localStorage.setItem('jobNumber', vm.job.id);\r\n          if(vm.job.id > -1) {\r\n            $location.search('job', vm.job.id);\r\n          }\r\n          else {\r\n            $location.search('job', null);\r\n          }\r\n          vm.origJobNumber = vm.job.id;\r\n        }\r\n      }\r\n    }\r\n    else {\r\n      $location.search('job', null);\r\n    }\r\n  \r\n    if(vm.stat) {\r\n      if(vm.origSavedSearchStatId != vm.stat.id) {\r\n        localStorage.setItem('searchStat', vm.stat.id);\r\n        if(vm.stat.id > -1) {\r\n          $location.search('stat', vm.stat.id);\r\n        }\r\n        else {\r\n          $location.search('stat', null);\r\n        }\r\n        \r\n        vm.origSavedSearchStatId = vm.stat.id;\r\n      }\r\n    }\r\n\r\n    localStorage.setItem('nameSearch', vm.nameSearch);\r\n    $location.search('name', vm.nameSearch);\r\n  };\r\n  \r\n  function init() {\r\n    jobs.init(reportProgress, jobInit);\r\n  }\r\n  \r\n  function reportProgress(msg) {\r\n    // console.log('progress: ' + msg);\r\n  }\r\n  \r\n  function jobInit() {\r\n    // console.log('called the job init func');\r\n    if(translations.isLoaded() && jobs.isLoaded()) {\r\n      // console.log('trying to init jobs');\r\n      // console.log('job dropdown should be set');\r\n      var newJobs = jobs.getFinalJobs();\r\n\r\n      newJobs.splice(0, 0, vm.jobs[0]);\r\n      vm.jobs = newJobs;\r\n      vm.allJobs = jobs.getAllJobs();\r\n      \r\n      var lastJobNumber = Number(localStorage.getItem('jobNumber'));\r\n      if($routeParams.job && $routeParams.job) {\r\n        lastJobNumber = Number($routeParams.job);\r\n      }\r\n      if(lastJobNumber != null) {\r\n        angular.forEach(newJobs, function(value, key) {\r\n          if(value.id == lastJobNumber) {\r\n            vm.job = value;\r\n            return;\r\n          }\r\n        });\r\n      }\r\n\r\n      itemCategory.init(vm.itemCategory.name, loadResults);\r\n    }\r\n  }\r\n  \r\n  vm.rankChecked = hCodeValues.checkedRank;\r\n    \r\n  vm.changeSearch = function() {\r\n    vm.save();\r\n    loadResults();\r\n  }\r\n  \r\n  function loadResults() {\r\n    vm.maxDisplay = 24;\r\n    vm.results = getResults();\r\n  }\r\n  \r\n  function getResults() {\r\n    var allItems = itemCategory.getItems(vm.itemCategory.name);\r\n    if(allItems == null) {\r\n      return null;\r\n    }\r\n    \r\n    allItems = allItems.sort(function(item1, item2) {\r\n        return (item2.levelLimit - item1.levelLimit);\r\n      });\r\n          \r\n    var pcStatId = -1;\r\n    if('pc' in vm.stat) {\r\n      pcStatId = vm.stat.pc;\r\n    }\r\n          \r\n    var altStatId = -1;\r\n    if('altStat' in vm.stat) {\r\n      altStatId = vm.stat.altStat;\r\n    }\r\n  \r\n    var statVals = [];\r\n    var newResults = [];\r\n    var numEquip = allItems.length;\r\n    var curDisplay = 0;\r\n    for(var i=0;i<numEquip && (curDisplay<vm.maxDisplay || vm.stat.id >= 0);++i) {\r\n      var e = allItems[i];\r\n      if(e) {\r\n        \r\n        if(!vm.itemCategory.hideLevel) {\r\n          if(e.levelLimit < vm.minLevel || e.levelLimit > vm.maxLevel) {\r\n            continue;\r\n          }\r\n        }\r\n          \r\n        if(!vm.itemCategory.hideRank) {\r\n          if(e.rank && !vm.rankChecked[e.rank.id]) {\r\n            continue;\r\n          }\r\n        }\r\n          \r\n        if(!vm.itemCategory.hideJob) {\r\n          if(vm.job && vm.job.id > -1) {\r\n            if(!vm.job.isClassJob(e.needJobClass)) {\r\n              continue;\r\n            }\r\n          }\r\n        }\r\n        \r\n        itemFactory.initItem(e);\r\n        if(e.typeName != vm.itemCategory.name) {\r\n          continue;\r\n        }\r\n        // console.log('name filter', vm.nameSearch); \r\n        \r\n        if(vm.nameSearch != '') {\r\n          // console.log('filtering on name');\r\n          var nameSearches = vm.nameSearch.split(' ');\r\n          if(!nameSearches.length) {\r\n            nameSearches = [vm.nameSearch];\r\n          }\r\n          var allMatch = true;\r\n          for(var ns=0;ns<nameSearches.length;++ns) {\r\n            if(e.name.toUpperCase().indexOf(nameSearches[ns].toUpperCase()) == -1) {\r\n              allMatch = false;\r\n              break;\r\n            }\r\n          }\r\n          \r\n          if(!allMatch) {\r\n            continue;\r\n          }\r\n        }\r\n        \r\n        if(vm.stat.id >= 0) {\r\n          var statFound = false;\r\n          \r\n          var statVal = {};\r\n          for(var s=0;s<e.stats.length;++s) {\r\n            var stat = e.stats[s];\r\n            if(stat.id == vm.stat.id) {\r\n              statFound = true;\r\n              statVal.i = curDisplay;\r\n              statVal.s = Number(stat.max);\r\n              break;\r\n            }\r\n            else if(stat.id == pcStatId) {\r\n              statFound = true;\r\n              statVal.i = curDisplay;\r\n              statVal.s = Number(stat.max);\r\n            }\r\n            else if(stat.id == altStatId) {\r\n              statFound = true;\r\n              statVal.i = curDisplay;\r\n              statVal.s = Number(stat.max);\r\n            }\r\n          }\r\n          \r\n          if(!statFound) {\r\n            continue;\r\n          }\r\n          else {\r\n            statVals.push(statVal);\r\n          }\r\n        }\r\n        \r\n        newResults.push(e);\r\n        curDisplay++;\r\n      }\r\n    }\r\n    \r\n    if(vm.stat.id >= 0) {\r\n      \r\n      var currentResults = Math.min(curDisplay, vm.maxDisplay);\r\n      \r\n      statVals = statVals.sort(function(value1, value2) {\r\n        return value2.s - value1.s;\r\n      });\r\n      \r\n      var statResults = [];\r\n      for(var i=0;i<currentResults;++i) {\r\n        statResults.push(newResults[statVals[i].i]);\r\n      }\r\n      newResults = statResults;\r\n    }\r\n    \r\n    vm.totalNumResults = newResults.length;\r\n    \r\n    return newResults;\r\n  }\r\n\r\n  vm.showMoreResults = function() {\r\n    $timeout(function() {\r\n      vm.maxDisplay += 18;\r\n      vm.results = getResults();\r\n    });\r\n  }\r\n  \r\n  region.init();\r\n  translations.init(reportProgress, init);\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').directive('dngearsimSkillSearch', function() {\r\n  return {\r\n    scope: {},\r\n    bindToController: {\r\n      job: '=job',\r\n      jobs: '=jobs',\r\n    },\r\n    controller: ['$window','$timeout','saveHelper','region','jobs','translations','dntData','hCodeValues','itemCategory','$location', skillSearchCtrl],\r\n    controllerAs: 'skillSearch',\r\n    templateUrl: 'ui/search/skill-search.html'\r\n  };\r\n});\r\n\r\nfunction skillSearchCtrl($window,$timeout,saveHelper, region, jobs, translations,dntData,hCodeValues,itemCategory,$location) {\r\n\r\n  var vm = this;\r\n  \r\n  vm.allJobs = [];\r\n  vm.dntName = '';\r\n  vm.skills = [];\r\n  vm.loadedJobId = -1;\r\n\r\n  vm.itemCategory = itemCategory.byName('skills');\r\n\r\n  vm.nameSearch = localStorage.getItem('nameSearch');\r\n  if(!vm.nameSearch) {\r\n    vm.nameSearch = '';\r\n  }\r\n  \r\n  region.init();\r\n  if(translations.isLoaded()) {\r\n    init();\r\n  }\r\n  else {\r\n    translations.init(reportProgress, function() { $timeout(init); } );\r\n  }\r\n\r\n  vm.navigate = function() {\r\n    $timeout(function() {\r\n      if(vm.itemCategory) {\r\n        $location.path(vm.itemCategory.path);\r\n      }\r\n    });\r\n  }\r\n  \r\n  vm.isLoading = function() {\r\n    \r\n    if(!translations.isLoaded()) {\r\n      // console.log('transations not loaded');\r\n      if(!translations.startedLoading) {\r\n        translations.init(reportProgress, function() { } );\r\n      }\r\n\r\n      return true;\r\n    }\r\n    \r\n    var baseName = jobs.getBaseJobName(vm.job);\r\n    var dntName = getDntName(baseName);\r\n    if(dntName) {\r\n      if(!dntData.isLoaded(dntName)) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n  \r\n  function getDntName(baseClassName) {\r\n    // console.log('got base class :' + baseClassName);\r\n    if(baseClassName != null) {\r\n      return 'skilltable_character' + baseClassName.toLowerCase() + '.lzjson';\r\n    }\r\n    else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  function getSkills() {\r\n    // console.log('getting skills for ' + vm.job.name);\r\n    if(vm.loadedJobId == vm.job.id) {\r\n      return vm.skills;\r\n    }\r\n    else {\r\n      \r\n      var baseJobNames = [];\r\n      if(vm.job.id >= 0) {\r\n        var baseName = jobs.getBaseJobName(vm.job);\r\n        baseJobNames.push(baseName);\r\n      }\r\n\r\n      angular.forEach(baseJobNames, function(baseName, index) {\r\n        var dntName = getDntName(baseName);\r\n        if(dntName) {\r\n          if(!dntData.isLoaded(dntName)) {\r\n            // console.log('loading skills for ' + baseName);\r\n            dntData.init(dntName, null, reportProgress, function() { $timeout(function() { setupSkills(baseJobNames, vm.job);} ); });\r\n          }\r\n          else {\r\n            setupSkills(baseJobNames, vm.job);\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n  \r\n  function setupSkills(baseJobNames, job) {\r\n    \r\n    vm.skills = [];\r\n    var allReady = true;\r\n    angular.forEach(baseJobNames, function(baseName, index) {\r\n      var dntName = getDntName(baseName);\r\n      if(!dntData.isLoaded(dntName)) {\r\n        allReady = false;\r\n      }\r\n    });\r\n    \r\n    if(allReady) {\r\n      angular.forEach(baseJobNames, function(baseName, index) {\r\n        var dntName = getDntName(baseName);\r\n      \r\n        var skills = dntData.getData(dntName);\r\n        var numSkills = skills.length;\r\n        for(var s=0;s<numSkills;++s) {\r\n          if(skills[s].NameID == 0) {\r\n            continue;\r\n          }\r\n          \r\n          if(skills[s].EffectClass1 > 0 || \r\n             skills[s].EffectClass2 > 0 || \r\n             skills[s].EffectClass3 > 0 || \r\n             skills[s].EffectClass4 > 0 ||\r\n             skills[s].EffectClass5 > 0 ||  \r\n             skills[s].EffectClass6 > 0) {\r\n               \r\n            var newItem = {d: skills[s]};\r\n            \r\n            newItem.id = skills[s].id;\r\n            newItem.typeName = 'skills';\r\n            newItem.itemSource = 'skills';\r\n            newItem.name = translations.translate(skills[s].NameID, skills[s].NameIDParam);\r\n            newItem.needJobClass = skills[s].NeedJob;\r\n            newItem.rank = hCodeValues.rankNames[0];\r\n            newItem.baseJobName = baseName.toLowerCase();\r\n            newItem.icon = skills[s].IconImageIndex;\r\n            \r\n            vm.skills.push(newItem);\r\n          }\r\n        }\r\n      });\r\n  \r\n      vm.loadedJobId = job.id;\r\n    }\r\n  }\r\n  \r\n  vm.getResults = function() {\r\n    \r\n    var skills = getSkills();\r\n    if(skills == null) {\r\n      return [];\r\n    }\r\n    \r\n    if(vm.job && vm.job.id >= 0) {\r\n      localStorage.setItem('jobNumber', vm.job.id);\r\n    }\r\n    localStorage.setItem('nameSearch', vm.nameSearch);\r\n\r\n    var newResults = [];\r\n    var numSkills = skills.length;\r\n    var curDisplay = 0;\r\n    for(var i=0;i<numSkills;++i) {\r\n      var e = skills[i];\r\n      \r\n      if(vm.nameSearch != '') {\r\n        var nameSearches = vm.nameSearch.split(' ');\r\n        if(!nameSearches.length) {\r\n          nameSearches = [vm.nameSearch];\r\n        }\r\n        var allMatch = true;\r\n        for(var ns=0;ns<nameSearches.length;++ns) {\r\n          if(e.name && e.name.toString().toUpperCase().indexOf(nameSearches[ns].toUpperCase()) == -1) {\r\n            allMatch = false;\r\n            break;\r\n          }\r\n        }\r\n        \r\n        if(!allMatch) {\r\n          continue;\r\n        }\r\n      }\r\n      \r\n      if(vm.job.id >= 0 && !vm.job.isClassJob(e.needJobClass)) {\r\n        continue;\r\n      }\r\n      \r\n      newResults.push(e);\r\n    }\r\n    return newResults;\r\n  }\r\n  \r\n  function reportProgress(msg) {\r\n    // console.log('progress: ' + msg);\r\n  }\r\n  \r\n  function jobInit() {\r\n    if(translations.isLoaded() && jobs.isLoaded()) {\r\n      var newJobs = jobs.getFinalJobs();\r\n\r\n      if(vm.jobs && vm.jobs.length) {\r\n        newJobs.splice(0, 0, vm.jobs[0]);\r\n      }\r\n      vm.jobs = newJobs;\r\n      vm.allJobs = jobs.getAllJobs();\r\n      \r\n      var lastJobNumber = Number(localStorage.getItem('jobNumber'));\r\n      // console.log('using job', lastJobNumber);\r\n      if(lastJobNumber != null) {\r\n        angular.forEach(newJobs, function(value, key) {\r\n          if(value.id == lastJobNumber) {\r\n            vm.job = value;\r\n            // console.log('using job', value);\r\n            return;\r\n          }\r\n        });\r\n      }\r\n      \r\n      vm.getResults();\r\n    }\r\n  }\r\n  \r\n  function init() {\r\n    // console.log('skill init');\r\n    if(jobs.isLoaded()) {\r\n      $timeout(jobInit);\r\n    }\r\n    else {\r\n      jobs.init(reportProgress, function() { $timeout(jobInit); } );\r\n    }\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').directive('dnsimChooseClass', chooseClass);\r\n\r\nfunction chooseClass() {\r\n  return {\r\n    restrict: 'E',\r\n    scope: {},\r\n    bindToController: {\r\n      job: '=job',\r\n      onSetJob: '&onSetJob'\r\n    },\r\n    templateUrl: 'ui/widgets/choose-class.html',\r\n    controllerAs: 'ctrl',\r\n    controller: [\r\n      '$window','$location','$routeParams','$timeout','saveHelper','dntData','jobs','hCodeValues','itemColumnsToLoad','character', \r\n      chooseClassController],\r\n  };\r\n}\r\n\r\nfunction chooseClassController($window,$location,$routeParams,$timeout,saveHelper,dntData,jobs,hCodeValues,itemColumnsToLoad,character) {\r\n  this.getFinalJobs = function() {\r\n    var allJobs = jobs.getFinalJobs();\r\n    var finalJobs = [];\r\n    for(var j=0;j<allJobs.length;++j) {\r\n      if(jobs.getBaseJobName(allJobs[j]) == this.bJob) {\r\n        finalJobs.push(allJobs[j]);\r\n      }\r\n    }\r\n    return finalJobs;\r\n  }\r\n  \r\n  this.getBaseJobs = function() {\r\n    return jobs.getBaseJobs();\r\n  }\r\n  \r\n  this.getJobName = function(englishName) {\r\n    var allJobs = jobs.getAllJobs();\r\n    for(var j=0;j<allJobs.length;++j) {\r\n      if(allJobs[j].d.EnglishName == englishName) {\r\n        return allJobs[j].name;\r\n      }\r\n    }\r\n  }\r\n  \r\n  this.setJob = function(job) {\r\n    this.job = job;\r\n    if(job) {\r\n      this.onSetJob();\r\n    }\r\n  }\r\n  \r\n  \r\n  jobs.init(reportProgress, $timeout);\r\n  function reportProgress(msg) {\r\n    // console.log('progress: ' + msg);\r\n  }\r\n\r\n}\r\n\r\n})();\r\n","(function () {\r\n'use strict';\r\n  \r\nangular.module('dnsim').directive('dnsimCategoryLinks', dnsimCategoryLinks);\r\n\r\nfunction dnsimCategoryLinks() {\r\n  return {\r\n    restrict: 'E',\r\n    scope: {},\r\n    bindToController: {\r\n      collapse: '=collapse',\r\n      cat: '=cat',\r\n      buildScreen: '=buildScreen',\r\n      onChange: '&onChange'\r\n    },\r\n    templateUrl: 'ui/widgets/dnsim-category-links.html',\r\n    controller: dnsimCategoryLinksController,\r\n    controllerAs: 'ctrl',\r\n  };\r\n};\r\n\r\nfunction dnsimCategoryLinksController(itemCategory, $window, translations, $translate) {\r\n\r\n  var vm = this;\r\n\r\n  vm.categories = itemCategory.categories;\r\n  vm.collapsed = true;\r\n\r\n  vm.shouldShow = function(action) {\r\n    if(vm.buildScreen) {\r\n      return !action.hideInBuild;\r\n    }\r\n    else {\r\n      return !action.hideInSearch;\r\n    }\r\n  }\r\n\r\n  vm.isLoading = function() {\r\n    return !translations.loaded;\r\n  }\r\n\r\n  vm.setCategory = function(action) {\r\n    \r\n    if(vm.collapse) {\r\n      // console.log('collapsing cat', action);\r\n      vm.collapsed = !vm.collapsed;\r\n      $window.scrollTo(0, 0);\r\n    }\r\n    \r\n    // console.log('setting cat', action);\r\n    if(vm.cat != action) {\r\n      vm.cat = action;\r\n      localStorage.setItem('selectedItemCategory', action.name);\r\n\r\n      if(vm.onChange) {\r\n        vm.onChange();\r\n      }\r\n    }\r\n  }\r\n\r\n  vm.getName = function(action) {\r\n    if(action.tId) {\r\n      return translations.translate(action.tId).toLowerCase();\r\n    }\r\n    else {\r\n      return $translate.instant(action.name);\r\n    }\r\n  }\r\n}\r\n\r\n})();\r\n","(function () {\r\n'use strict';\r\n  \r\nangular.module('dnsim').directive('dnsimItemIcon', ['exportLinkHelper','$location','region', dnsimItemIcon]);\r\n\r\nfunction dnsimItemIcon(exportLinkHelper,$location,region) {\r\n  return {\r\n    restrict: 'E',\r\n    scope: {\r\n      item: '=item',\r\n    },\r\n    templateUrl: 'ui/widgets/dnsim-item-icon.html',\r\n    link: function($scope, element, attrs) {\r\n      \r\n      $scope.$watch('item', function(newValue, oldValue) {\r\n        if (newValue) {\r\n          $scope.iconImage = $scope.getIcon();\r\n        }\r\n      });\r\n      \r\n      $scope.getIcon = function() {\r\n        if($scope.item && $scope.item.icon > 0) {\r\n          var fileIndex = Math.floor($scope.item.icon/200 + 1);\r\n          \r\n          var prefix;\r\n          if($scope.item.typeName == 'skills') {\r\n            prefix = 'skillicon';\r\n          }\r\n          else {\r\n            prefix = 'itemicon';\r\n          }\r\n          \r\n          if(fileIndex > 9) {\r\n            return prefix + fileIndex + '.png';\r\n          }\r\n          else {\r\n            return prefix + '0' + fileIndex + '.png';\r\n          }\r\n        }\r\n        return null;\r\n      }\r\n      \r\n      $scope.iconImage = $scope.getIcon();\r\n      \r\n      $scope.getIconXPostion = function() {\r\n        if($scope.item && $scope.item.icon > 0) {\r\n          return (($scope.item.icon % 10) * 40) + 5;\r\n        }\r\n        return 0;\r\n      }\r\n      \r\n      $scope.getIconYPostion = function() {\r\n        if($scope.item && $scope.item.icon > 0) {\r\n          return (Math.floor(($scope.item.icon % 200) / 10) * 40) + 4;\r\n        }\r\n        return 0;\r\n      }\r\n    },\r\n  };\r\n}\r\n\r\n})();\r\n","(function () {\r\n'use strict';\r\n  \r\nangular.module('dnsim').directive('dnsimItemLink', ['exportLinkHelper','$location','region', dnsimItemLink]);\r\n\r\nfunction dnsimItemLink(exportLinkHelper,$location,region) {\r\n  return {\r\n    restrict: 'E',\r\n    scope: {\r\n      item: '=item',\r\n      noClick: '=noClick',\r\n    },\r\n    templateUrl: 'ui/widgets/dnsim-item-link.html',\r\n    link: function($scope, element, attrs) {\r\n      $scope.itemLink = 'item/?region=' + region.dntLocation.region + '&i=' + exportLinkHelper.encodeItem($scope.item);\r\n      // var basePath = angular.element(document.querySelector('base')).attr('href');\r\n      \r\n      $scope.$watch('item', function(newValue, oldValue) {\r\n        if (newValue) {\r\n          $scope.itemLink = 'item/?region=' + region.dntLocation.region + '&i=' + exportLinkHelper.encodeItem($scope.item);\r\n        }\r\n      });\r\n    },\r\n  };\r\n}\r\n\r\n})();\r\n","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').directive('dnsimJobIcon', [dnsimJobIcon]);\r\n\r\nfunction dnsimJobIcon() {\r\n  return {\r\n    restrict: 'E',\r\n    scope: {},\r\n    bindToController: {\r\n      item: '=item',\r\n      small: '=small'\r\n    },\r\n    templateUrl: 'ui/widgets/dnsim-job-icon.html',\r\n    controller: dnsimJobIconController,\r\n    controllerAs: 'ctrl'\r\n  }\r\n}\r\n\r\nfunction dnsimJobIconController() {\r\n  \r\n  if(this.small) {\r\n    this.sizeValue = '205px 205px';\r\n    this.iconSize = 22;\r\n    this.iconOffset = 0;\r\n  }\r\n  else {\r\n    this.sizeValue = '410px 410px';\r\n    this.iconSize = 44;\r\n    this.iconOffset = 5;\r\n  }\r\n\r\n  this.getIconXPostion = function() {\r\n    if(this.item && this.item.d && this.item.d.JobIcon > 0) {\r\n      return ((this.item.d.JobIcon % 9) * this.iconSize) + this.iconOffset;\r\n    }\r\n    return 0;\r\n  }\r\n  \r\n  this.getIconYPostion = function() {\r\n    if(this.item && this.item.d && this.item.d.JobIcon > 0) {\r\n      return (Math.floor(this.item.d.JobIcon / 9) * this.iconSize) + this.iconOffset;\r\n    }\r\n    return 0;\r\n  }\r\n}\r\n\r\n})();\r\n","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').directive('dnsimLoading', ['dntData','translations','$timeout', 'region', dnsimLoading]);\r\n\r\nfunction dnsimLoading(dntData, translations, $timeout, region) {\r\n  'use strict';\r\n  return {\r\n    restrict: 'E',\r\n    transclude: true,\r\n    scope: {\r\n      alsoShowFor: '=alsoShowFor',\r\n    },\r\n    templateUrl: 'ui/widgets/dnsim-loading.html',\r\n    link: function($scope, element, attrs) {\r\n      $scope.$on('TRANSLATION_LOAD_EVENT', function() {\r\n        $scope.setLoadCount();\r\n      });\r\n      \r\n      $scope.$on('DNTDATA_LOAD_EVENT', function() {\r\n        $scope.setLoadCount();\r\n      });\r\n      \r\n      $scope.$on('DNTDATA_LOAD_ERROR', function() {\r\n        $timeout(function() {\r\n          $scope.loadError = true;\r\n        });\r\n      });\r\n      \r\n      $scope.$on('TRANSLATION_LOAD_ERROR', function() {\r\n        $timeout(function() {\r\n          $scope.loadError = true;\r\n        });\r\n      });\r\n\r\n      $scope.numLoading = 0;\r\n      $scope.setLoadCount = function() {\r\n        $scope.noRegion = !region.dntLocation;\r\n        \r\n        var n = dntData.anyLoading();\r\n        if(!translations.isLoaded())\r\n        {\r\n          n++;\r\n        }\r\n        \r\n        // $timeout(function() {\r\n          if($scope.numLoading < n || !$scope.totalToLoad) {\r\n            $scope.totalToLoad = n;\r\n          }\r\n          $scope.numLoading = n;\r\n        // });\r\n        $timeout();\r\n      };\r\n      \r\n      $scope.loadError = false;\r\n      $scope.setLoadCount();\r\n    },\r\n  };\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').directive('dnsimSelectAllOnClick', [dnsimSelectAllOnClick]);\r\n\r\nfunction dnsimSelectAllOnClick() {\r\n  'use strict';\r\n  return {\r\n    restrict: 'A',\r\n    link: function(scope, element, attrs) {\r\n      var hasSelectedAll = false;\r\n      element.on('click', function($event) {\r\n        if (!hasSelectedAll) {\r\n          try {\r\n            //IOs, Safari, thows exception on Chrome etc\r\n            this.selectionStart = 0;\r\n            this.selectionEnd = this.value.length + 1;\r\n            hasSelectedAll = true;\r\n          } catch (err) {\r\n            //Non IOs option if not supported, e.g. Chrome\r\n            this.select();\r\n            hasSelectedAll = true;\r\n          }\r\n        }\r\n      });\r\n      //On blur reset hasSelectedAll to allow full select\r\n      element.on('blur', function($event) {\r\n        hasSelectedAll = false;\r\n      });\r\n    }\r\n  };\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').directive('dnsimStats', ['hCodeValues','$translate',dnsimStats]);\r\n\r\nfunction dnsimStats(hCodeValues, $translate) {\r\n  return {\r\n    restrict: 'A',\r\n    scope: {\r\n      stats: '=stats',\r\n      build: '=build',\r\n      altStats: '=altStats',\r\n      separator: '=separator',\r\n      filter: '=filter',\r\n      numInSet: '=numInSet'\r\n    },\r\n    link: function($scope, element, attrs) {\r\n      \r\n      var sep;\r\n      if(!$scope.separator) {\r\n        sep = '';\r\n      }\r\n      else {\r\n        sep = '&nbsp;' + $scope.separator + ' ';\r\n      }\r\n      \r\n      var addedElements = [];\r\n      var originalDisplay = element.css('display');\r\n      \r\n      function showStats() {\r\n        element.css('display', 'none' );\r\n        var stats = $scope.stats;\r\n        if(!stats) {\r\n          stats = $scope.altStats;\r\n        }\r\n        \r\n        angular.forEach(addedElements, function(value, key) {\r\n          value.remove();\r\n        });\r\n        \r\n        var first = true;\r\n        var lastElement = element;\r\n        \r\n        function append(text) {\r\n          var newElement = element.clone();\r\n          newElement.css('display', originalDisplay);\r\n          newElement.html(text);\r\n          \r\n          lastElement.after(newElement);\r\n          lastElement = newElement;\r\n          addedElements.push(newElement);\r\n        }\r\n\r\n        // get stats that are used to summarise\r\n        var summaryForStats = {};\r\n        angular.forEach(stats, function(stat, key) {\r\n          var def = hCodeValues.stats[stat.id];\r\n          if(def && def.summaryFor) {\r\n            summaryForStats[def.summaryFor] = stat;\r\n          }\r\n        });\r\n        \r\n        angular.forEach(stats, function(stat, key) {\r\n          var output = '';\r\n\r\n          // console.log('processing stat', stat);\r\n          \r\n          if(stat.id in hCodeValues.stats) {\r\n            \r\n            var def = hCodeValues.stats[stat.id];\r\n            if(!$scope.filter && 'hide' in def && def.hide) {\r\n              return;\r\n            }\r\n            \r\n            if($scope.filter && !def[$scope.filter]) {\r\n              return;\r\n            }\r\n\r\n            if(def.summaryFor) {\r\n              return;\r\n            }\r\n            // console.log('no summaryFor');\r\n            \r\n            if(!first) {\r\n              output += sep;\r\n            }\r\n            first = false;\r\n          \r\n            if('needSetNum' in stat) {\r\n              if(stat.needSetNum <= $scope.numInSet) {\r\n                output += '*';\r\n              }\r\n              output += stat.needSetNum + '&nbsp;';\r\n            }\r\n\r\n            output += '<strong>';\r\n            \r\n            if($scope.build) {\r\n              if(def.element == 'primary') {\r\n                var eleId = 0;\r\n                if($scope.build.element) {\r\n                  eleId = $scope.build.element.id;\r\n                }\r\n                output += $translate.instant(hCodeValues.elements[eleId].name) + '&nbsp;';\r\n              }\r\n              else if(def.element == 'secondary') {\r\n                var eleId = 0;\r\n                if($scope.build.secondaryElement) {\r\n                  eleId = $scope.build.secondaryElement.id;\r\n                }\r\n                output += $translate.instant(hCodeValues.elements[eleId].name) + '&nbsp;';\r\n              }\r\n            }\r\n            \r\n            output += $translate.instant(def.name)+':</strong>&nbsp;'+def.display(stat);\r\n            if(def.combineWith > 0) {\r\n              angular.forEach(stats, function(stat2, key2) {\r\n                if(stat2.id == def.combineWith) {\r\n                  if(stat2.max != stat.max) {\r\n                    output += '-' + def.display(stat2);\r\n                  }\r\n                }\r\n              });\r\n            }\r\n\r\n            if(stat.id in summaryForStats) {\r\n              var sStat = summaryForStats[stat.id];\r\n              var sDef = hCodeValues.stats[sStat.id];\r\n              output += '&nbsp;|&nbsp;<em>' + sDef.display(sStat);\r\n              output += '</em>';\r\n            }\r\n\r\n          }\r\n          else {\r\n            if(!first) {\r\n              output += sep;\r\n            }\r\n            first = false;\r\n          \r\n            if('needSetNum' in stat) {\r\n              output += stat.needSetNum + '-Increases&nbsp;';\r\n            }\r\n            \r\n            output += stat.id+':&nbsp;'+stat.max;\r\n          }\r\n          \r\n          append(output);\r\n        });\r\n      }\r\n        \r\n      $scope.$watch('stats', function(newValue, oldValue) {\r\n        if (newValue) {\r\n          showStats();\r\n        }\r\n      });\r\n      \r\n      $scope.$watch('altStats', function(newValue, oldValue) {\r\n        if (newValue) {\r\n          showStats();\r\n        }\r\n      });\r\n      \r\n      $scope.$watch('numInSet', function(newValue, oldValue) {\r\n        if (newValue >= 0) {\r\n          showStats();\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').directive('dnsimStringToNumber', dnsimStringToNumber);\r\n\r\nfunction dnsimStringToNumber() {\r\n  return {\r\n    require: 'ngModel',\r\n    link: function(scope, element, attrs, ngModel) {\r\n      ngModel.$parsers.push(function(value) {\r\n        return '' + value;\r\n      });\r\n      ngModel.$formatters.push(function(value) {\r\n        return parseFloat(value, 10);\r\n      });\r\n    }\r\n  };\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').directive('dnsimStringToPercent', dnsimStringToNumber);\r\n\r\nfunction dnsimStringToNumber() {\r\n  return {\r\n    require: 'ngModel',\r\n    link: function(scope, element, attrs, ngModel) {\r\n      ngModel.$parsers.push(function(value) {\r\n        return '' + (value/100.0);\r\n      });\r\n      ngModel.$formatters.push(function(value) {\r\n        return parseFloat(value, 10)*100;\r\n      });\r\n    }\r\n  };\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\nangular.module('dnsim').directive('fileChange', ['$parse', fileChangeFunction]);\r\n\r\nfunction fileChangeFunction($parse) {\r\n\r\n    return {\r\n      restrict: 'A',\r\n      link: function ($scope, element, attrs) {\r\n\r\n        // Get the function provided in the file-change attribute.\r\n        // Note the attribute has become an angular expression,\r\n        // which is what we are parsing. The provided handler is \r\n        // wrapped up in an outer function (attrHandler) - we'll \r\n        // call the provided event handler inside the handler()\r\n        // function below.\r\n        var attrHandler = $parse(attrs['fileChange']);\r\n\r\n        // This is a wrapper handler which will be attached to the\r\n        // HTML change event.\r\n        var handler = function (e) {\r\n\r\n          $scope.$apply(function () {\r\n\r\n            // Execute the provided handler in the directive's scope.\r\n            // The files variable will be available for consumption\r\n            // by the event handler.\r\n            attrHandler($scope, { $event: e, files: e.target.files });\r\n          });\r\n        };\r\n\r\n        // Attach the handler to the HTML change event \r\n        element[0].addEventListener('change', handler, false);\r\n      }\r\n    };\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').directive('dngearsimGroupAssignment', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n      compact: '=compact',\r\n      onChange: '&onChange'\r\n    },\r\n    controller: groupAssignment,\r\n    controllerAs: 'editCtrl',\r\n    templateUrl: 'ui/item/group-assignment.html'\r\n  };\r\n});\r\n\r\nfunction groupAssignment(hCodeValues,statHelper,saveHelper,itemCategory,$scope,exportLinkHelper,dntData) {\r\n  \r\n  var vm = this;\r\n  \r\n  this.savedItems = saveHelper.getSavedItems();\r\n  this.groupNames = Object.keys(this.savedItems);\r\n  if(!this.groupName) {\r\n    this.groupName = saveHelper.getCurrentBuild();\r\n  }\r\n\r\n  if(!(this.groupName in this.savedItems)) {\r\n    this.groupName = null;\r\n  }\r\n\r\n  if(!this.groupName && this.savedItems) {\r\n    for(var savedGroup in this.savedItems) {\r\n      this.groupName = savedGroup;\r\n      break;\r\n    }\r\n  }\r\n\r\n  if(!this.groupName) {\r\n    return;\r\n  }\r\n  \r\n  this.summaryStatIds = [];\r\n  for(var id in hCodeValues.stats) {\r\n    if(hCodeValues.stats[id].summaryDisplay) {\r\n      this.summaryStatIds.push(id);\r\n    }\r\n  }\r\n    \r\n  this.clearGroup = function() {\r\n    vm.addAffectAmount = null;\r\n    vm.replaceAffectAmount = {};\r\n\r\n    vm.groupItems = null;\r\n    vm.groupCalcStats = null;\r\n  }\r\n\r\n  vm.tryToSetItem = function(dntFiles) {\r\n    if(!dntData.anyLoading()) {\r\n      \r\n      var allLoaded = true;\r\n      angular.forEach(dntFiles, function(columns, fileName) {\r\n        if(!dntData.isLoaded(fileName)) {\r\n          allLoaded = false;\r\n        }\r\n      });\r\n      \r\n      if(allLoaded) {\r\n        vm.item = exportLinkHelper.reloadItem(vm.item);\r\n      }\r\n    }\r\n  }\r\n\r\n  var dntFiles = exportLinkHelper.getDntFiles(vm.item);\r\n  angular.forEach(dntFiles, function(columns, fileName) {\r\n    dntData.init(fileName, columns, function() {}, function() {\r\n      vm.tryToSetItem(dntFiles);\r\n    });\r\n  });\r\n  vm.tryToSetItem(dntFiles);\r\n\r\n  $scope.$watch('editCtrl.item', function() {\r\n    vm.clearGroup();\r\n  });\r\n  \r\n  this.getAddAffectAmount = function(stat) {\r\n    this.initAddAffects();\r\n    // console.log('add affect: ', this.addAffectAmount[stat], this.item);\r\n    return this.addAffectAmount[stat];\r\n  };\r\n  \r\n  this.getReplaceAffectAmount = function(statId, itemIndex, item) {\r\n    this.initReplaceAffects(itemIndex, item);\r\n    return this.replaceAffectAmount[itemIndex][statId];\r\n  };\r\n  \r\n  this.getGroupCalcStats = function() {\r\n    \r\n    if(this.groupCalcStats == null) {\r\n      \r\n      var group = vm.savedItems[vm.groupName];\r\n      if(group) {\r\n        this.groupCalcStats = statHelper.getCalculatedStatsFromItems(group, group.items);\r\n      }\r\n    }\r\n    \r\n    return this.groupCalcStats;\r\n  };\r\n  \r\n  this.getBuild = function() {\r\n    return vm.savedItems[vm.groupName];\r\n  };\r\n  \r\n  this.initAddAffects = function() {\r\n    \r\n    if(vm.addAffectAmount) {\r\n      return;\r\n    }\r\n    \r\n    // console.log('initialising add affects ');\r\n    \r\n    var origStats = vm.getGroupCalcStats();\r\n    var group = vm.savedItems[vm.groupName];\r\n    var newItems = [];\r\n    if(group.items) {\r\n      newItems = group.items.concat([vm.item]);\r\n    }\r\n    var newStats = statHelper.getCalculatedStatsFromItems(group, newItems);\r\n    \r\n    this.addAffectAmount = {};\r\n    for(var id in hCodeValues.stats) {\r\n      if(hCodeValues.stats[id].summaryDisplay) {\r\n        vm.addAffectAmount[id] = calcStatPercent(vm.getStat(id, newStats).max, vm.getStat(id, origStats).max);\r\n      }\r\n    }\r\n  };\r\n  \r\n  this.initReplaceAffects = function(itemIndex, item) {\r\n    if(vm.replaceAffectAmount[itemIndex]) {\r\n      return;\r\n    }\r\n    \r\n    var group = vm.savedItems[vm.groupName];\r\n    var newItems = [vm.item];\r\n    angular.forEach(group.items, function(gItem , index) {\r\n      if(item !== gItem) {\r\n        newItems.push(gItem);\r\n      }\r\n    });\r\n    \r\n    var newStats = statHelper.getCalculatedStatsFromItems(group, newItems);\r\n    var origStats = vm.getGroupCalcStats();\r\n    \r\n    this.replaceAffectAmount[itemIndex] = {};\r\n    for(var id in hCodeValues.stats) {\r\n      if(hCodeValues.stats[id].summaryDisplay) {\r\n        vm.replaceAffectAmount[itemIndex][id] = calcStatPercent(vm.getStat(id, newStats).max, vm.getStat(id, origStats).max);\r\n      }\r\n    }\r\n  };\r\n  \r\n  function calcStatPercent(newVal, origVal) {\r\n    if(newVal && origVal) {\r\n      // console.log('orig: ' + origVal + ',new: ' + newVal);\r\n      return Math.round(10000 * (1 - (origVal / newVal))) / 100;\r\n    }\r\n    else {\r\n      return 0;\r\n    }\r\n  }\r\n  \r\n  this.getStat = function(id, stats) {\r\n    var len = stats.length;\r\n    for(var i=0;i<len;++i) {\r\n      if(stats[i].id == id) {\r\n        return stats[i];\r\n      }\r\n    }\r\n    return {id: id, max:0};\r\n  };\r\n  \r\n  this.getStatName = function(id) {\r\n    var retVal = '';\r\n    if(hCodeValues.stats[id].element == 'primary') {\r\n      var eleId = 0;\r\n      if(vm.savedItems[vm.groupName].element) {\r\n        eleId = vm.savedItems[vm.groupName].element.id;\r\n      }\r\n      retVal += hCodeValues.elements[eleId].name;\r\n    }\r\n    else if(hCodeValues.stats[id].element == 'secondary') {\r\n      var eleId = 0;\r\n      if(vm.savedItems[vm.groupName].secondaryElement) {\r\n        eleId = vm.savedItems[vm.groupName].secondaryElement.id;\r\n      }\r\n      retVal += hCodeValues.elements[eleId].name;\r\n    }\r\n    return retVal + ' ' + hCodeValues.stats[id].name;\r\n  };\r\n  \r\n  this.getGroupItems = function() {\r\n\r\n    var itemSplit;\r\n    function numMatches(str) {\r\n      if(str) {\r\n        var matches = 0;\r\n        for(var i=0;i<itemSplit.length;++i) {\r\n          if(str.indexOf(itemSplit[i]) > 0) {\r\n            matches++;\r\n          }\r\n        }\r\n        return matches;\r\n      }\r\n      else {\r\n        return -1;\r\n      }\r\n    }\r\n    \r\n    if(vm.groupItems == null && vm.groupName && vm.groupName in vm.savedItems && vm.item && vm.item.typeName) {\r\n      vm.groupItems = [];\r\n\r\n      var existing;\r\n      if(vm.item.itemSource == 'plate' || vm.item.itemSource == 'tman') {\r\n        existing = _.find(vm.savedItems[vm.groupName].items, function(item) {\r\n          return item.sparkTypeId == vm.item.sparkTypeId && vm.item.itemSource == item.itemSource;\r\n        });\r\n      }\r\n\r\n      var items = [];\r\n      if(existing) {\r\n        items.push(existing);\r\n      }\r\n      else {\r\n        _.each(vm.savedItems[vm.groupName].items, function(item) {\r\n          if(item.exchangeType && item.itemSource != 'gem' && item.itemSource != 'plate' && item.itemSource != 'tman') {\r\n            if(item.exchangeType == vm.item.exchangeType) {\r\n              items.push(item);\r\n            }\r\n          }\r\n          else if(item.typeName == vm.item.typeName) {\r\n            items.push(item);\r\n          }\r\n        });\r\n        \r\n        if(vm.item.name) {\r\n          itemSplit = vm.item.name.split(' ');\r\n        }\r\n        items.sort(function(a,b) {\r\n          return numMatches(b.name)-numMatches(a.name);\r\n        });\r\n      }\r\n      \r\n      angular.forEach(items, function(item, index) {\r\n        if(item.name == vm.item.name) {\r\n          vm.groupItems.push(item);\r\n        }\r\n      });\r\n      \r\n      angular.forEach(items, function(item, index) {\r\n        if(item.name != vm.item.name) {\r\n          vm.groupItems.push(item);\r\n        }\r\n      });\r\n    }\r\n    return vm.groupItems;\r\n  };\r\n  \r\n  this.hasMaxExchangable = function() {\r\n    var cat = itemCategory.byName(this.item.typeName);\r\n    var items = this.getGroupItems();\r\n\r\n    if(vm.item.itemSource == 'plate' || vm.item.itemSource == 'tman') {\r\n      if(_.find(items, function(item) {\r\n        return item.sparkTypeId == vm.item.sparkTypeId;\r\n      })) {\r\n        return true;\r\n      }\r\n    }\r\n    \r\n    if(cat && cat.maxCat) {\r\n      if(items.length >= cat.maxCat) {\r\n        return true;\r\n      }\r\n    }\r\n    \r\n    if(cat && cat.maxExchange) {\r\n      if(items.length >= cat.maxExchange) {\r\n        for(var i=0;i<items.length;++i) {\r\n          if(!items[i].exchangeType) {\r\n            return false;\r\n          }\r\n        }\r\n        // console.log('maxexchange reached ' + items.length + '>=' + cat.maxExchange + ' for ' + cat.name);\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n  \r\n  this.nextGroup = function() {\r\n    \r\n    var uptoItem = false;\r\n    var nextGroup = null;\r\n    angular.forEach(vm.groupNames, function(groupName, index) {\r\n      if(uptoItem) {\r\n        if(nextGroup == null) {\r\n          nextGroup = groupName;\r\n        }\r\n      }\r\n      if(groupName == vm.groupName) {\r\n        uptoItem = true;\r\n      }\r\n    });\r\n    \r\n    if(nextGroup == null) {\r\n      nextGroup = vm.groupNames[0];\r\n    }\r\n    \r\n    vm.groupName = nextGroup;\r\n    saveGroup();\r\n    vm.clearGroup();\r\n  };\r\n  \r\n  this.prevGroup = function() {\r\n    \r\n    var foundGroup = false;\r\n    var prevGroup = null;\r\n    angular.forEach(vm.groupNames, function(groupName, index) {\r\n      if(groupName == vm.groupName) {\r\n        foundGroup = true;\r\n      }\r\n      \r\n      if(!foundGroup) {\r\n        prevGroup = groupName;\r\n      }\r\n    });\r\n    \r\n    if(prevGroup == null) {\r\n      prevGroup = vm.groupNames[vm.groupNames.length-1];\r\n    }\r\n    \r\n    vm.groupName = prevGroup;\r\n    saveGroup();\r\n    vm.clearGroup();\r\n  };\r\n  \r\n  this.addToGroup = function() {\r\n    saveHelper.saveItem(vm.groupName, vm.item);\r\n    this.savedItems = saveHelper.getSavedItems();\r\n    vm.clearGroup();\r\n    vm.onChange();\r\n  };\r\n  \r\n  this.replace = function(item) {\r\n    item.replaceItem = true;\r\n    var newItemList = [];\r\n    angular.forEach(vm.savedItems[vm.groupName].items, function(gItem, index) {\r\n      if(gItem.replaceItem) {\r\n        // console.log('found replace item');\r\n        newItemList.push(vm.item);\r\n      }\r\n      else {\r\n        newItemList.push(gItem);\r\n      }\r\n    });\r\n    \r\n    saveHelper.updatedSavedItems(vm.groupName, newItemList);\r\n    this.savedItems = saveHelper.getSavedItems();\r\n    vm.clearGroup();\r\n    vm.onChange();\r\n  };\r\n  \r\n  function saveGroup() {\r\n    saveHelper.saveBuildSelection(vm.groupName, vm.savedItems);\r\n  }\r\n  \r\n};\r\n\r\n})();","angular.module('dnsim').controller('itemEditCustomCtrl',\r\n\r\n['hCodeValues','$scope',\r\nfunction(hCodeValues,$scope) {\r\n  'use strict';\r\n  \r\n  if(this.item == null) return;\r\n  if(this.item.itemSource != 'custom' && this.item.typeName != 'custom') {\r\n    return;\r\n  }\r\n  \r\n  var vm = this;\r\n\r\n  this.statMap = {};\r\n  \r\n  // console.log(vm.item.stats);\r\n  _.forEach(vm.item.stats, function(stat) {\r\n    // console.log('got stat', stat.id);\r\n    vm.statMap[stat.id] = stat.max;\r\n  });\r\n  \r\n  for(var statId in hCodeValues.stats) {\r\n    $scope.$watch('editCtrl.statMap[' + statId + ']', function(newValue, oldValue) { \r\n\r\n      if(newValue != oldValue) {\r\n        // console.log(statId);\r\n        // console.log('watch got stat value', newValue);\r\n\r\n        var anyChange = false;\r\n        var newStats = [];\r\n        for(var statId in vm.statMap) {\r\n\r\n          if(!vm.statMap[statId] || !Number(vm.statMap[statId])) {\r\n            _.each(vm.item.stats, function(stat) { \r\n              if(stat.id == statId) {\r\n                anyChange = true;\r\n              }\r\n            });\r\n          }\r\n          else {\r\n            newStats.push({\r\n              id: Number(statId),\r\n              max: Number(vm.statMap[statId])\r\n            });\r\n\r\n            var found = false;\r\n            _.each(vm.item.stats, function(stat) {\r\n              if(stat.id == statId) {\r\n                found = true;\r\n                // console.log('comparing', stat.max, vm.statMap[statId]);\r\n                if(!(statId in vm.statMap) || stat.max != vm.statMap[statId]) {\r\n                  anyChange = true;\r\n                }\r\n              } \r\n            });\r\n\r\n            if(!found) {\r\n              anyChange = true;\r\n            }\r\n          }\r\n        }\r\n\r\n        if(anyChange) {\r\n          // console.log('GOT CHANGES!', newStats);\r\n          vm.item.stats = newStats;\r\n          vm.onChange();\r\n        }\r\n      }\r\n    });\r\n  }\r\n  \r\n}])\r\n.directive('dngearsimItemEditCustom', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n      onChange: '&onChange',\r\n    },\r\n    controller: 'itemEditCustomCtrl',\r\n    controllerAs: 'editCtrl',\r\n    templateUrl: 'ui/item/item-edit-custom.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemEditEnchantmentCtrl',\r\n\r\nfunction(dntData,hCodeValues,items,$timeout,translations,itemColumnsToLoad,itemFactory) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  \r\n  if(!vm.item || !vm.item.enchantmentId) {\r\n    return;\r\n  }\r\n  \r\n  if('itemSource' in this.item) {\r\n    vm.itemType = items[vm.item.itemSource];\r\n  }\r\n  \r\n  if(!vm.itemType) {\r\n    return;\r\n  }\r\n  if(!('enchantDnt' in vm.itemType) && !('petLevelDnt' in vm.itemType)) {\r\n    return;\r\n  }\r\n  \r\n  if(vm.itemType.enchantDnt) {\r\n    dntData.init(vm.itemType.enchantDnt, itemColumnsToLoad.enchantDnt, null, vm.getEnchantments);\r\n  }\r\n  if(vm.itemType.enchantDnt2) {\r\n    dntData.init(vm.itemType.enchantDnt2, itemColumnsToLoad.enchantDnt, null, vm.getEnchantments);\r\n  }\r\n  \r\n  if(vm.itemType.petLevelDnt) {\r\n    dntData.init(vm.itemType.petDnt, itemColumnsToLoad.petDnt, null, vm.getEnchantments);\r\n    dntData.init(vm.itemType.petLevelDnt, itemColumnsToLoad.petLevelDnt, null, vm.getEnchantments);\r\n  }\r\n  \r\n  vm.enchantments = null;\r\n  vm.enchantment = null;\r\n  vm.enchantmentAfter = null;\r\n  vm.enchantmentCost = '';\r\n  vm.enhancementOptions = [];\r\n  if(vm.item.enchantmentStats == null) {\r\n    vm.item.enchantmentStats = [];\r\n  }\r\n  \r\n  this.setEnchantment = function() {\r\n    vm.item.enchantmentStats = [];\r\n\r\n    if(vm.enchantments && vm.enchantments.length > 0) {\r\n\r\n      if(typeof vm.item.enchantmentNum != 'number') {\r\n        vm.item.enchantmentNum = 0;\r\n        vm.onChange();\r\n      }\r\n      \r\n      for(var i=0;i<vm.enchantments.length;++i) {\r\n        if(vm.item.enchantmentNum == getEnchantLevel(i)) {\r\n          vm.enchantment = vm.enchantments[i];\r\n          \r\n          vm.item.enchantmentStats = hCodeValues.getStats(vm.enchantment);\r\n        }\r\n        else if(vm.item.enchantmentNum + 1 == getEnchantLevel(i)) {\r\n          vm.enchantmentAfter = vm.enchantments[i];\r\n          if(vm.enchantmentAfter.NeedCoin < 10000) {\r\n            vm.enchantmentCost = Math.round(vm.enchantmentAfter.NeedCoin / 1000)/10 + 'g';\r\n          }\r\n          else {\r\n            vm.enchantmentCost = Math.round(vm.enchantmentAfter.NeedCoin / 10000) + 'g';\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  function getEnchantLevel(num) {\r\n    if('petLevelDnt' in vm.itemType) {\r\n      return vm.enchantments[num].PetLevel;\r\n    }\r\n    else {\r\n      return vm.enchantments[num].EnchantLevel;\r\n    }\r\n  }\r\n  \r\n  this.setPetLevel = function() {\r\n    vm.item.enchantmentStats = [];\r\n\r\n    if(vm.enchantments && vm.enchantments.length > 0) {\r\n\r\n      if(typeof vm.item.enchantmentNum != 'number') {\r\n        vm.item.enchantmentNum = 6;\r\n        vm.onChange();\r\n      }\r\n      \r\n      for(var i=0;i<vm.enchantments.length;++i) {\r\n        if(vm.item.enchantmentNum == vm.enchantments[i].PetLevel) {\r\n          vm.enchantment = vm.enchantments[i];\r\n          \r\n          vm.item.enchantmentStats = hCodeValues.getStats(vm.enchantment);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  this.isMaxEnchantLevel = function() {\r\n\r\n    if(vm.enchantments != null &&\r\n      vm.enchantments.length > 0 &&\r\n      typeof vm.item.enchantmentNum == 'number') {\r\n\r\n      for(var i=0;i<vm.enchantments.length;++i) {\r\n        if(vm.item.enchantmentNum + 1 == getEnchantLevel(i)) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n    else {\r\n      return false;\r\n    }\r\n  }\r\n  \r\n  this.setEnchantmentNum = function(enhancementOption) {\r\n    vm.item.enchantmentNum = enhancementOption;\r\n    vm.enhancementOptions = [];\r\n    if('petLevelDnt' in vm.itemType) {\r\n      vm.setPetLevel();\r\n    }\r\n    else {\r\n      vm.setEnchantment();\r\n    }\r\n    vm.onChange();\r\n  }\r\n  \r\n  this.nextEnchantment = function() {\r\n    for(var i=vm.item.enchantmentNum;i==0||vm.enchantments[i-1];++i) {\r\n      if(i == 0) {\r\n        vm.enhancementOptions.push({number: 0});\r\n      }\r\n      else {\r\n        vm.enhancementOptions.push(vm.getOption(i-1));\r\n      }\r\n    }\r\n  }\r\n  \r\n  this.prevEnchantment = function() {\r\n    vm.enhancementOptions = [];\r\n    for(var i=vm.item.enchantmentNum;i>0;--i) {\r\n      vm.enhancementOptions.push(vm.getOption(i-1));\r\n    }\r\n    \r\n    vm.enhancementOptions.push({number: 0});\r\n  }\r\n  \r\n  this.getOption = function(enchantmentNum) {\r\n    return {\r\n      number: getEnchantLevel(enchantmentNum),\r\n      stats: hCodeValues.getStats(vm.enchantments[enchantmentNum])\r\n    };\r\n  }\r\n  \r\n  this.getEnchantments = function() {\r\n    if(!vm.enchantments && vm.item && vm.item.enchantmentId) {\r\n      if(vm.itemType.enchantDnt && dntData.isLoaded(vm.itemType.enchantDnt)) {\r\n        vm.enchantments = dntData.find(vm.itemType.enchantDnt, 'EnchantID', vm.item.enchantmentId);\r\n        if(!vm.enchantments.length && vm.itemType.enchantDnt2) {\r\n          vm.enchantments = dntData.find(vm.itemType.enchantDnt2, 'EnchantID', vm.item.enchantmentId);\r\n        }\r\n        vm.setEnchantment();\r\n      }\r\n      if(vm.itemType.petLevelDnt && dntData.isLoaded(vm.itemType.petLevelDnt)) {\r\n        vm.enchantments = dntData.find(vm.itemType.petLevelDnt, 'PetLevelTypeID', vm.item.enchantmentId);\r\n        vm.setPetLevel();\r\n      }\r\n    }\r\n    \r\n    return vm.enchantments;\r\n  }\r\n  \r\n  var fileName = 'all-items.lzjson';\r\n  \r\n  this.showMaterials = function() {\r\n    dntData.init(fileName, null, function() {}, function() {\r\n      $timeout(function() {\r\n        \r\n        if(!vm.enchantmentAfter) {\r\n          return;\r\n        }\r\n        \r\n        vm.materials = [];\r\n        for(var i=1;i<=5;++i) {\r\n          var itemId = vm.enchantmentAfter['NeedItemID' + i];\r\n          var itemCount = vm.enchantmentAfter['NeedItemCount' + i];\r\n          if(itemId > 0 && itemCount > 0) {\r\n            \r\n            var items = dntData.find(fileName, 'id', itemId);\r\n            if(items.length == 0) {\r\n              vm.materials.push({num: itemCount, name: 'unknown (' + itemId + ')'});\r\n            }\r\n            else {\r\n              var item = items[0];              \r\n              if(item) {\r\n                var material = {\r\n                  item: itemFactory.createBasicItem(item),\r\n                  num: itemCount,\r\n                };\r\n                vm.materials.push(material);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      });\r\n    });\r\n  }\r\n  \r\n  if(dntData.isLoaded(fileName)) {\r\n    this.showMaterials();\r\n  }\r\n\r\n  function reportProgress(msg) {\r\n    // console.log('progress: ' + msg);\r\n  }\r\n})\r\n.directive('dngearsimItemEditEnchantment', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n      onChange: '&onChange',\r\n    },\r\n    controller: 'itemEditEnchantmentCtrl',\r\n    controllerAs: 'editCtrl',\r\n    templateUrl: 'ui/item/item-edit-enchantment.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemEditPotentialCtrl',\r\n\r\n['dntData','items','hCodeValues','itemColumnsToLoad',\r\nfunction(dntData,items,hCodeValues,itemColumnsToLoad) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  \r\n  this.potentials = null;\r\n  this.potential = null;\r\n  this.changingPotentials = false;\r\n  this.potentialStats = {};\r\n  \r\n  if(this.item == null) return;\r\n  \r\n  if('itemSource' in this.item) {\r\n    this.itemType = items[this.item.itemSource];\r\n  }\r\n  \r\n  if(!this.itemType || !this.item.pid || !('potentialDnt' in this.itemType)) {\r\n    return;\r\n  }\r\n  \r\n  if(vm.itemType.potentialDnt) {\r\n    dntData.init(vm.itemType.potentialDnt, itemColumnsToLoad.potentialDnt, null, vm.getPotentials);\r\n  }\r\n  \r\n  this.getPotentials = function() {\r\n    if(!vm.potentials) {\r\n      if(vm.item && vm.item.pid && 'potentialDnt' in vm.itemType) {\r\n        var potentials = dntData.find(vm.itemType.potentialDnt, 'id', vm.item.pid);\r\n        \r\n        if(potentials.length == 1) {\r\n          vm.potential = potentials[0];\r\n          vm.potentials = dntData.find(vm.itemType.potentialDnt, 'PotentialID', vm.potential.PotentialID);\r\n          vm.potentialStats = getPotentialStats(vm.potentials);\r\n        }\r\n        else if('potentialDntEx' in vm.itemType) {\r\n          potentials = dntData.find(vm.itemType.potentialDntEx, 'id', vm.item.pid);\r\n        \r\n          if(potentials.length == 1) {\r\n            vm.potential = potentials[0];\r\n            vm.potentials = dntData.find(vm.itemType.potentialDntEx, 'PotentialID', vm.potential.PotentialID);\r\n            vm.potentialStats = getPotentialStats(vm.potentials);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    return vm.potentials;\r\n  }\r\n  \r\n  this.nextPotential = function() {\r\n    for(var i=0;i<vm.potentials.length;++i) {\r\n      if(vm.potential.id == vm.potentials[i].id) {\r\n        vm.potential = vm.potentials[i+1];\r\n        vm.item.pid = vm.potential.id;\r\n        vm.onChange();\r\n        this.changingPotentials = true;\r\n        return;\r\n      }\r\n    }\r\n  }\r\n  \r\n  this.prevPotential = function() {\r\n    for(var i=0;i<vm.potentials.length;++i) {\r\n      if(vm.potential.id == vm.potentials[i].id) {\r\n        vm.potential = vm.potentials[i-1];\r\n        vm.item.pid = vm.potential.id;\r\n        vm.onChange();\r\n        this.changingPotentials = true;\r\n        return;\r\n      }\r\n    }\r\n  }\r\n    \r\n  this.changePotential = function(pid) {\r\n    for(var i=0;i<vm.potentials.length;++i) {\r\n      if(pid == vm.potentials[i].id) {\r\n        vm.potential = vm.potentials[i];\r\n        vm.item.pid = vm.potential.id;\r\n        vm.changingPotentials = false;\r\n        vm.onChange();\r\n        return;\r\n      }\r\n    }\r\n  }\r\n  \r\n  this.isFirstPotential = function() {\r\n    this.getPotentials();\r\n    return !vm.potentials || vm.potentials.length <= 1 || !vm.potential || vm.potential.id == vm.potentials[0].id;\r\n  }\r\n  \r\n  this.isLastPotential = function() {\r\n    this.getPotentials();\r\n    return !vm.potentials || vm.potentials.length <= 1 || !vm.potential || vm.potential.id == vm.potentials[vm.potentials.length-1].id;\r\n  }\r\n  \r\n  function getPotentialStats() {\r\n    var pStats = {};\r\n    var emptyStatId = null;\r\n    \r\n    if(vm.potentials != null) {\r\n      angular.forEach(vm.potentials, function(p, index) {\r\n        var stats = [];\r\n        angular.forEach(hCodeValues.getStats(p), function(stat, sIndex) {\r\n          if(!hCodeValues.stats[stat.id].hide) {\r\n            stats.push(stat);\r\n          }\r\n        });\r\n        \r\n        if(stats.length > 0) {\r\n          pStats[p.id] = stats;\r\n        }\r\n        else if(!emptyStatId) {\r\n          pStats[p.id] = [];\r\n          emptyStatId = p.id;\r\n        }\r\n      });\r\n    }\r\n    \r\n    return pStats;\r\n  }\r\n  \r\n  function reportProgress(msg) {\r\n    // console.log('progress: ' + msg);\r\n  }\r\n\r\n}])\r\n.directive('dngearsimItemEditPotential', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n      onChange: '&onChange',\r\n    },\r\n    controller: 'itemEditPotentialCtrl',\r\n    controllerAs: 'editCtrl',\r\n    templateUrl: 'ui/item/item-edit-potential.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemEditSkillCtrl',\r\n\r\n['$timeout','dntData','statHelper',\r\nfunction($timeout,dntData,statHelper) {\r\n  'use strict';\r\n  \r\n  if(this.item == null) return;\r\n  if(this.item.itemSource != 'skills') {\r\n    return;\r\n  }\r\n  \r\n  if(!this.item.enchantmentNum) {\r\n    this.item.enchantmentNum = 1;\r\n  }\r\n  \r\n  var vm = this;\r\n  \r\n  function getDntFile() {\r\n    return 'skillleveltable_character' + vm.item.baseJobName + vm.item.pve + '.lzjson';\r\n  }\r\n  \r\n  this.initSkills = function() {\r\n    var dntFile = getDntFile();\r\n    dntData.init(dntFile, null, reportProgress, function() { $timeout(function() {\r\n      vm.skillData = dntData.find(dntFile, 'SkillIndex', vm.item.id);\r\n    })});\r\n  }\r\n  \r\n  this.nextEnchantment = function() {\r\n    if(this.skillData && this.item.enchantmentNum < this.skillData.length) {\r\n      this.item.enchantmentNum++;\r\n      vm.onChange();\r\n    }\r\n  }\r\n  \r\n  this.isMaxSkillLevel = function() {\r\n    return this.skillData && this.item && this.item.enchantmentNum >= this.skillData.length;\r\n  }\r\n  \r\n  this.prevEnchantment = function() {\r\n    if(this.item.enchantmentNum > 0) {\r\n      this.item.enchantmentNum--;\r\n    }\r\n    else {\r\n      this.item.enchantmentNum = 0;\r\n    }\r\n\r\n    vm.onChange();\r\n  }\r\n  \r\n  function reportProgress(msg) {\r\n    // console.log('progress: ' + msg);\r\n  }\r\n  \r\n  dntData.init(getDntFile(), null, null, vm.initSkills);\r\n\r\n}])\r\n.directive('dngearsimItemEditSkill', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n      onChange: '&onChange',\r\n    },\r\n    controller: 'itemEditSkillCtrl',\r\n    controllerAs: 'editCtrl',\r\n    templateUrl: 'ui/item/item-edit-skill.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemEditSparkCtrl',\r\n\r\n['dntData','hCodeValues','items','itemColumnsToLoad',\r\nfunction(dntData,hCodeValues,items,itemColumnsToLoad) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  \r\n  if(this.item == null) return;\r\n  if('itemSource' in this.item) {\r\n    this.itemType = items[this.item.itemSource];\r\n  }\r\n  \r\n  if(!vm.itemType || !vm.itemType.sparkDnt) {\r\n    return\r\n  }\r\n  \r\n  if(vm.itemType.sparkDnt) {\r\n    dntData.init(vm.itemType.sparkDnt, itemColumnsToLoad.sparkDnt, null, vm.getSparks);\r\n  }\r\n  \r\n  this.sparks = null;\r\n\r\n  this.nextSpark = function() {\r\n    var index = getPotentialIndex();\r\n    index++;\r\n    if(index >= vm.sparks.length) {\r\n      index = 0;\r\n    }\r\n    var spark = vm.sparks[index]; \r\n    vm.item.sparkId = spark.id;\r\n    vm.item.sparkStats = hCodeValues.getStats(spark);\r\n    vm.onChange();\r\n  }\r\n  \r\n  this.isMoreSparks = function() {\r\n    return vm.sparks != null && getPotentialIndex() >= vm.sparks.length-1;\r\n  }\r\n  \r\n  this.isFirstSpark = function() {\r\n    return getPotentialIndex() == 0;\r\n  }\r\n  \r\n  this.prevSpark = function() {\r\n    var index = getPotentialIndex();\r\n    index--;\r\n    if(index < 0) {\r\n      index = vm.sparks.length-1;\r\n    }\r\n    var spark = vm.sparks[index]; \r\n    vm.item.sparkId = spark.id;\r\n    vm.item.sparkStats = hCodeValues.getStats(spark);\r\n    vm.onChange();\r\n  }\r\n  \r\n  this.removeSpark = function() {\r\n    vm.item.sparkId = null;\r\n    vm.item.sparkStats = null;\r\n    vm.onChange();\r\n  }\r\n  \r\n  this.getSparks = function() {\r\n    if(vm.item == null || vm.itemType == null) return null;\r\n    if(vm.sparks == null) {\r\n      var sid = vm.item.sparkTypeId;\r\n      if(sid) {\r\n        if(dntData.isLoaded(vm.itemType.sparkDnt)) {\r\n          vm.sparks = dntData.find(vm.itemType.sparkDnt, 'PotentialID', sid);\r\n        }\r\n      }\r\n    }\r\n    \r\n    return vm.sparks;\r\n  }\r\n\r\n  function getPotentialIndex() {\r\n    var potentialIndex = -1;\r\n    if(vm.item.sparkId > 0) {\r\n      angular.forEach(vm.sparks, function(spark, index) {\r\n        if(spark.id == vm.item.sparkId) {\r\n          potentialIndex = index;\r\n          return;\r\n        }\r\n      });\r\n    }\r\n      \r\n    return potentialIndex;\r\n  }\r\n\r\n  function reportProgress(msg) {\r\n    // console.log('progress: ' + msg);\r\n  }\r\n}])\r\n.directive('dngearsimItemEditSpark', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n      onChange: '&onChange',\r\n    },\r\n    controller: 'itemEditSparkCtrl',\r\n    controllerAs: 'editCtrl',\r\n    templateUrl: 'ui/item/item-edit-spark.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemEditTalismanCtrl',\r\n\r\n[function() {\r\n  'use strict';\r\n  \r\n  if(this.item == null) return;\r\n  if(this.item.itemSource != 'tman') {\r\n    return;\r\n  }\r\n  \r\n  this.setTalisman = function(amount) {\r\n    if(amount == 0) {\r\n      this.item.enchantmentNum = null;\r\n      this.item.enchantmentStats = [];\r\n    }\r\n    else {\r\n      this.item.enchantmentNum = amount;\r\n      \r\n      var extraStats = [];\r\n      angular.forEach(this.item.stats, function(stat, index) {\r\n        extraStats.push({id: stat.id, max: stat.max * (amount/100)});\r\n      });\r\n      \r\n      this.item.enchantmentStats = extraStats;\r\n    }\r\n    this.onChange();\r\n  }\r\n\r\n}])\r\n.directive('dngearsimItemEditTalisman', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n      onChange: '&onChange',\r\n    },\r\n    controller: 'itemEditTalismanCtrl',\r\n    controllerAs: 'editCtrl',\r\n    templateUrl: 'ui/item/item-edit-talisman.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemEditCtrl',\r\n\r\n['hCodeValues',\r\nfunction(hCodeValues) {\r\n  'use strict';\r\n  \r\n  var vm = this;\r\n  \r\n  if(!vm.item) {\r\n    return;\r\n  }\r\n  \r\n  vm.onUpdateItem = function() {\r\n    vm.updateItem();\r\n  }\r\n  \r\n}])\r\n.directive('dngearsimItemEdit', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n      onChange: '&onChange',\r\n      updateItem: '&updateItem'\r\n    },\r\n    controller: 'itemEditCtrl',\r\n    controllerAs: 'ctrl',\r\n    templateUrl: 'ui/item/item-edit.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemViewAttainmentCtrl',\r\n\r\n['$timeout','dntData','itemFactory','hCodeValues','translations',\r\n  function($timeout, dntData, itemFactory, hCodeValues, translations) {\r\n  'use strict';\r\n  \r\n  if(this.item == null) return;\r\n  \r\n  var vm = this;\r\n  vm.attainments = [];\r\n\r\n  var files = [\r\n    'itemgaintable.lzjson',\r\n    'itemgaintable_dragonjewel.lzjson',\r\n    'itemgaintable_enchant.lzjson',\r\n    'itemgaintable_etc.lzjson',\r\n    'itemgaintable_reboot.lzjson',\r\n    'itemgaintable_talisman.lzjson'];\r\n\r\n  for(var i=0;i<files.length;++i) {\r\n    dntData.init(files[i], null, function() {}, function() {\r\n      $timeout(function() {\r\n        vm.init();\r\n      });\r\n    });\r\n  }\r\n  \r\n  this.init = function() {\r\n    for(var i=0;i<files.length;++i) {\r\n      if(!dntData.isLoaded(files[i]) && !dntData.hasFailed(files[i])) {\r\n        return;\r\n      }\r\n    }\r\n    \r\n    vm.attainments = [];\r\n    files.forEach(function(file) {\r\n      var attainments = dntData.find(file, 'id', vm.item.id);\r\n      if(attainments.length) {\r\n        attainments.forEach(function(attainment) {\r\n          var text = attainment.ItemGainText;\r\n          if(text) {\r\n            var texts = text.split('{');\r\n            texts.forEach(function(singleText) {\r\n              var splitVal = singleText.split('}');\r\n              if(splitVal.length) {\r\n                if(splitVal[0].indexOf('#') == -1) {\r\n                  vm.attainments.push(translations.translate(splitVal[0]));\r\n                }\r\n              }\r\n            });\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n}])\r\n.directive('dngearsimItemViewAttainment', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n    },\r\n    controller: 'itemViewAttainmentCtrl',\r\n    controllerAs: 'ctrl',\r\n    templateUrl: 'ui/item/item-view-attainment.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemViewBoxCtrl',\r\n\r\n['$timeout','dntData','itemFactory',\r\n  function($timeout, dntData, itemFactory) {\r\n  'use strict';\r\n  \r\n  if(this.item == null) return;\r\n  if(this.item.typeId != 46 && this.item.typeId != 8 && this.item.typeId != 112 && this.item.typeId != 122 && this.item.typeId != 142 && this.item.typeId != 160) {\r\n    console.log('not box item type ' + this.item.typeId);\r\n    return;\r\n  }\r\n  \r\n  var vm = this;\r\n  \r\n  var pouchFileNames = [\r\n    'itemdroptable.lzjson',\r\n    'itemdroptable_abyss.lzjson',\r\n    'itemdroptable_apprentice.lzjson',\r\n    'itemdroptable_cook.lzjson',\r\n    'itemdroptable_darklair.lzjson',\r\n    'itemdroptable_dimension.lzjson',\r\n    'itemdroptable_disjoint.lzjson',\r\n    'itemdroptable_dnexpedition.lzjson',\r\n    'itemdroptable_event.lzjson',\r\n    'itemdroptable_farm.lzjson',\r\n    'itemdroptable_fishing.lzjson',\r\n    'itemdroptable_guildwar.lzjson',\r\n    'itemdroptable_item.lzjson',\r\n    'itemdroptable_monsteritem.lzjson',\r\n    'itemdroptable_propdrop.lzjson',\r\n    'itemdroptable_pvp.lzjson',\r\n    'itemdroptable_randomcompound.lzjson',\r\n    'itemdroptable_stageclear.lzjson',\r\n    'itemdroptable_themepark.lzjson',\r\n    'itemdroptable_union.lzjson']\r\n  \r\n  var allItemFileName = 'all-items.lzjson';\r\n  var charmItemtable = 'charmitemtable.lzjson';\r\n  var commonCharmItemtable = 'charmitemtable_common.lzjson';\r\n  \r\n  var files;\r\n  if(this.item.typeId == 46 || this.item.typeId == 112 || this.item.typeId == 122 || this.item.typeId == 142 || this.item.typeId == 160) {\r\n    files = [allItemFileName, charmItemtable, commonCharmItemtable];\r\n  }\r\n  else if (this.item.typeId == 8) {\r\n    files = [allItemFileName].concat(pouchFileNames);\r\n  }\r\n\r\n  for(var i=0;i<files.length;++i) {\r\n    dntData.init(files[i], null, function() {}, function() {\r\n      $timeout(function() {\r\n        vm.initBoxContents();\r\n      });\r\n    });\r\n  }\r\n  \r\n  this.initBoxContents = function() {\r\n    // console.log('init contents', this.item.fileName);\r\n\r\n    for(var i=0;i<files.length;++i) {\r\n      if(!dntData.isLoaded(files[i])) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    var datas = dntData.find(this.item.fileName + '.lzjson', 'id', this.item.id);\r\n    if(datas.length > 0) {\r\n      var d = datas[0];\r\n      vm.items = [];\r\n      \r\n      \r\n      if(vm.item.typeId == 46 || vm.item.typeId == 112 || vm.item.typeId == 122 || vm.item.typeId == 142 || vm.item.typeId == 160) {\r\n        vm.getCharmItems(d.TypeParam1);\r\n      }\r\n      else if (vm.item.typeId == 8) {\r\n        vm.getPouchItems(d.TypeParam1);\r\n      }\r\n      \r\n    }\r\n  }\r\n  \r\n  this.getPouchItems = function(boxType) {\r\n    for(var f=0;f<pouchFileNames.length;++f) {\r\n      vm.getPouchItemsFromFile(boxType, pouchFileNames[f]);\r\n    }\r\n  }\r\n  \r\n  this.getPouchItemsFromFile = function(boxType, pouchFileName) {\r\n    \r\n    var pouchData = dntData.find(pouchFileName, 'id', boxType);\r\n    if(pouchData.length == 0) {\r\n    }\r\n    else {\r\n      var gold = pouchData[0].GoldMin;\r\n\r\n      var itemIndex = 0;\r\n      do {\r\n        itemIndex++;\r\n        var isGroup = pouchData[0]['IsGroup' + itemIndex];\r\n        var pouchItem = pouchData[0]['Item' + itemIndex + 'Index'];\r\n        var pouchItemCount = pouchData[0]['Item' + itemIndex + 'Info'];\r\n        //console.log('pouch contains ' + pouchItem);\r\n        if(pouchItem) {\r\n          if(isGroup) {\r\n            vm.getPouchItems(pouchItem, pouchFileName);\r\n          }\r\n          else {\r\n            // console.log('adding item ' + pouchItem);\r\n            var itemds = dntData.find(allItemFileName, 'id', pouchItem);\r\n            if(itemds.length > 0) {\r\n              var basicItem = itemFactory.createBasicItem(itemds[0]);\r\n              // console.log('found item ' + basicItem.name);\r\n  \r\n              vm.items.push({\r\n                count: pouchItemCount,\r\n                gold: gold,\r\n                item: basicItem\r\n              });\r\n            }\r\n          }\r\n        }\r\n      } while(pouchItem);\r\n    }\r\n  }\r\n  \r\n  this.getCharmItems = function(boxType) {\r\n    var charmFiles = [charmItemtable, commonCharmItemtable];\r\n    for(var i=0;i<charmFiles.length;++i) {\r\n\r\n      var charmData = dntData.getData(charmFiles[i]);\r\n      // console.log('box: ' + boxType, charmData);\r\n      \r\n      for(var c=0;c<charmData.length;++c) {\r\n        var cd = charmData[c];\r\n        if(cd.CharmNum == boxType && cd.Look) {\r\n          \r\n          if(cd.CharmType) {\r\n            this.getCharmItems(cd.ItemID)\r\n          }\r\n          else {\r\n            var itemds = dntData.find(allItemFileName, 'id', cd.ItemID);\r\n            if(itemds.length > 0) {\r\n              vm.items.push({\r\n                count: cd.Count,\r\n                gold: cd.Gold,\r\n                item: itemFactory.createBasicItem(itemds[0])\r\n              });\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n}])\r\n.directive('dngearsimItemViewBox', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n    },\r\n    controller: 'itemViewBoxCtrl',\r\n    controllerAs: 'ctrl',\r\n    templateUrl: 'ui/item/item-view-box.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemViewCraftCtrl',\r\n\r\n['$timeout','dntData','itemFactory','hCodeValues','translations',\r\n  function($timeout, dntData, itemFactory, hCodeValues, translations) {\r\n  'use strict';\r\n  \r\n  if(this.item == null) return;\r\n  \r\n  var vm = this;\r\n  vm.crafts = [];\r\n\r\n  var cFiles = [\r\n    'itemcompoundtable.lzjson',\r\n    'itemcompoundtable_custom.lzjson',\r\n    'itemcompoundtable_glyph.lzjson',\r\n    'itemcompoundtable_glyph95.lzjson',\r\n    'itemcompoundtable_jewel.lzjson',\r\n    'itemcompoundtable_renewal.lzjson',\r\n    'itemcompoundtable_set.lzjson'];\r\n  \r\n  var dropFile = 'itemdroptable.lzjson';\r\n  \r\n  var allItemFileName = 'all-items.lzjson';\r\n  \r\n  var files = cFiles.concat([allItemFileName, dropFile]);\r\n  for(var i=0;i<files.length;++i) {\r\n    dntData.init(files[i], null, function() {}, function() {\r\n      $timeout(function() {\r\n        vm.initCrafts();\r\n      });\r\n    });\r\n  }\r\n  \r\n  this.initCrafts = function() {\r\n    for(var i=0;i<files.length;++i) {\r\n      if(!dntData.isLoaded(files[i]) && !dntData.hasFailed(files[i])) {\r\n        return;\r\n      }\r\n    }\r\n    \r\n    vm.crafts = [];\r\n    for(var i=0;i<cFiles.length;++i) {\r\n      vm.initCraft(cFiles[i], vm.item.id);\r\n    }\r\n\r\n    for(var di=1;di<=20;++di) {\r\n      var drops = dntData.find(dropFile, 'Item' + di + 'Index', vm.item.id);\r\n      if(drops.length) {\r\n        drops.forEach(function(drop) {\r\n          for(var i=0;i<cFiles.length;++i) {\r\n            vm.initCraft(cFiles[i], drop.id);\r\n          }\r\n        });\r\n      }\r\n    }\r\n    \r\n    var newCrafts = [];\r\n    for(var i=0;i<vm.crafts.length;++i) {\r\n      var found = false;\r\n      for(var j=0;j<newCrafts.length;++j) {\r\n        if(vm.crafts[i].gold == newCrafts[j].gold &&\r\n          vm.crafts[i].items.length == newCrafts[j].items.length) {\r\n            \r\n            found = true;\r\n            for(var k=0;k<vm.crafts[i].items.length;++k) {\r\n              if(vm.crafts[i].items[k].item.id != newCrafts[j].items[k].item.id ||\r\n                vm.crafts[i].items[k].num != newCrafts[j].items[k].num) {\r\n                  found = false;\r\n              }\r\n            }\r\n        }\r\n      }\r\n      \r\n      if(!found) {\r\n        newCrafts.push(vm.crafts[i]);\r\n      }\r\n    }\r\n    \r\n    vm.crafts = newCrafts;\r\n  }\r\n\r\n  this.initCraft = function(fileName, id) {\r\n    var fCrafts = dntData.find(fileName, 'SuccessItemID1', id);\r\n    \r\n    for(var i=0;i<fCrafts.length;++i) {\r\n      var c = fCrafts[i];\r\n      \r\n      var craft = {\r\n        id: c.id,\r\n        fileName: fileName.replace('.lzjson', ''),\r\n        gold: c.Cost/100/100,\r\n        items: [],\r\n      };\r\n      \r\n      var j=0;\r\n      for(;;) {\r\n        j++;\r\n        var itemColName = 'Slot' + j +'Id';\r\n        var qtyColName = 'Slot' + j +'Num';\r\n        if(!(itemColName in c)) {\r\n          break;\r\n        }\r\n\r\n        var items = dntData.find(allItemFileName, 'id', c[itemColName]);\r\n        if(items.length > 0) {\r\n          craft.items.push({\r\n            item: itemFactory.createBasicItem(items[0]),\r\n            num: c[qtyColName],\r\n          });\r\n        }\r\n      }\r\n      \r\n      vm.crafts.push(craft);\r\n    }\r\n  }\r\n\r\n}])\r\n.directive('dngearsimItemViewCraft', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n    },\r\n    controller: 'itemViewCraftCtrl',\r\n    controllerAs: 'ctrl',\r\n    templateUrl: 'ui/item/item-view-craft.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemViewExtractionCtrl',\r\n\r\n['$timeout','dntData','itemFactory','items',\r\n  function($timeout, dntData, itemFactory, items) {\r\n  'use strict';\r\n  \r\n  if(this.item == null) return;\r\n  \r\n  var vm = this;\r\n  \r\n  var extractFileName = 'itemdroptable_disjoint.lzjson';\r\n  var allItemFileName = 'all-items.lzjson';\r\n  \r\n  var files = [extractFileName,allItemFileName];\r\n  for(var i=0;i<files.length;++i) {\r\n    dntData.init(files[i], null, function() {}, function() {\r\n      $timeout(function() {\r\n        vm.initExtract();\r\n      });\r\n    });\r\n  }\r\n  \r\n  this.initExtract = function() {\r\n    for(var i=0;i<files.length;++i) {\r\n      if(!dntData.isLoaded(files[i])) {\r\n        return;\r\n      }\r\n    }\r\n    \r\n    var disjoint;\r\n    var d = itemFactory.getItemData(vm.item);\r\n    if(d && d.DisjointDrop1 > 0) {\r\n      disjoint = d.DisjointDrop1;\r\n    }\r\n    \r\n    var itemType = items[vm.item.itemSource];\r\n    if(itemType && d.EnchantID) {\r\n      var enchantments = dntData.find(itemType.enchantDnt, 'EnchantID', d.EnchantID);\r\n      if(!enchantments.length && itemType.enchantDnt2) {\r\n        enchantments = dntData.find(itemType.enchantDnt2, 'EnchantID', d.EnchantID);\r\n      }\r\n\r\n      for(var i=0;i<enchantments.length;++i) {\r\n        if(enchantments[i].EnchantLevel == vm.item.enchantmentNum) {\r\n          disjoint = enchantments[i].DisjointDrop;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    \r\n    vm.items = [];\r\n    if(disjoint) {\r\n      vm.getItems(disjoint);\r\n    }\r\n  }\r\n  \r\n  this.getGold = function() {\r\n    var d = itemFactory.getItemData(this.item);\r\n    return Number(d.Disjointamount)/100/100;\r\n  }\r\n  \r\n  this.getItems = function(disjoint) {\r\n    // console.log('checking ' + pouchFileName + ' for ' + boxType);\r\n    \r\n    var pouchData = dntData.find(extractFileName, 'id', disjoint);\r\n    if(pouchData.length == 0) {\r\n    }\r\n    else {\r\n      var gold = pouchData[0].GoldMin;\r\n\r\n      var itemIndex = 1;\r\n      while('Item' + itemIndex + 'Index' in pouchData[0]) {\r\n        var isGroup = pouchData[0]['IsGroup' + itemIndex];\r\n        var pouchItem = pouchData[0]['Item' + itemIndex + 'Index'];\r\n        var pouchItemCount = pouchData[0]['Item' + itemIndex + 'Info'];\r\n        //console.log('pouch contains ' + pouchItem);\r\n        if(pouchItem) {\r\n          if(isGroup) {\r\n            vm.getItems(pouchItem);\r\n          }\r\n          else {\r\n            var itemds = dntData.find(allItemFileName, 'id', pouchItem);\r\n            if(itemds.length > 0) {\r\n              //console.log('found item ');\r\n  \r\n              vm.items.push({\r\n                count: pouchItemCount,\r\n                gold: gold,\r\n                item: itemFactory.createBasicItem(itemds[0]),\r\n              });\r\n            }\r\n          }\r\n        }\r\n        itemIndex++;\r\n      }\r\n    }\r\n  }\r\n\r\n}])\r\n.directive('dngearsimItemViewExtraction', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n    },\r\n    controller: 'itemViewExtractionCtrl',\r\n    controllerAs: 'ctrl',\r\n    templateUrl: 'ui/item/item-view-extraction.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemViewPlateCtrl',\r\n\r\n['$timeout','dntData','itemFactory','hCodeValues','translations',\r\n  function($timeout, dntData, itemFactory) {\r\n  'use strict';\r\n  \r\n  if(this.item == null) return;\r\n  \r\n  var vm = this;\r\n  vm.items = [];\r\n  \r\n  var plateFile = 'platetable.lzjson';\r\n  var allItemFileName = 'all-items.lzjson';\r\n  \r\n  var allFiles = [plateFile,allItemFileName];\r\n  for(var i=0;i<allFiles.length;++i) {\r\n    dntData.init(allFiles[i], null, function() {}, function() {\r\n      $timeout(function() {\r\n        vm.initSets();\r\n      });\r\n    });\r\n  }\r\n  \r\n  this.initSets = function() {\r\n    for(var i=0;i<allFiles.length;++i) {\r\n      if(!dntData.isLoaded(allFiles[i])) {\r\n        return;\r\n      }\r\n    }\r\n    \r\n    vm.items = [];\r\n    getPlates();\r\n  }\r\n  \r\n  function getPlates() {\r\n    var rows = dntData.find(plateFile, 'ItemID', vm.item.id);\r\n    for(var r=0;r<rows.length;++r) {\r\n      var row = rows[r];\r\n      var col=0;\r\n      for(;;) {\r\n        col++;\r\n        var colName = 'CompoundTableIndex' + col;\r\n        if(!(colName in row)) {\r\n          break;\r\n        }\r\n\r\n        var itemData = dntData.find(allItemFileName, 'id', row[colName]);\r\n        if(itemData.length > 0) {\r\n          vm.items.push(itemFactory.createBasicItem(itemData[0]));\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n}])\r\n.directive('dngearsimItemViewPlate', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n    },\r\n    controller: 'itemViewPlateCtrl',\r\n    controllerAs: 'ctrl',\r\n    templateUrl: 'ui/item/item-view-plate.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemViewSetCtrl',\r\n\r\n['$timeout','dntData','itemFactory','hCodeValues','translations',\r\n  function($timeout, dntData, itemFactory) {\r\n  'use strict';\r\n  \r\n  if(this.item == null) return;\r\n  \r\n  var vm = this;\r\n  vm.items = [];\r\n  \r\n  var files = [\r\n  'partstable.optimised.json',\r\n  'partstable_cash.optimised.json',\r\n  'partstable_common2014.optimised.json',\r\n  'partstable_common2015.optimised.json',\r\n  'partstable_common2016.lzjson',\r\n  'partstable_commoncash.lzjson',\r\n  'partstable_equipment.optimised.json',\r\n  'partstable_event.lzjson',\r\n  'partstable_guild.lzjson',\r\n  'partstable_pvp.optimised.json',\r\n  'partstable_reboot.optimised.json',\r\n  'partstable_skilllevelup.lzjson',\r\n  'weapontable.optimised.json',\r\n  'weapontable_cash.optimised.json',\r\n  'weapontable_common2014.optimised.json',\r\n  'weapontable_common2015.optimised.json',\r\n  'weapontable_common2016.lzjson',\r\n  'weapontable_commoncash.lzjson',\r\n  'weapontable_equipment.optimised.json',\r\n  'weapontable_event.lzjson',\r\n  'weapontable_guild.lzjson',\r\n  'weapontable_pvp.optimised.json',\r\n  'weapontable_reboot.optimised.json',\r\n  //'weapontable_skilllevelup.lzjson'\r\n  ];\r\n  \r\n  var allItemFileName = 'all-items.lzjson';\r\n  \r\n  var allFiles = files.concat([allItemFileName]);\r\n  for(var i=0;i<allFiles.length;++i) {\r\n    dntData.init(allFiles[i], null, function() {}, function() {\r\n      $timeout(function() {\r\n        vm.initSets();\r\n      });\r\n    });\r\n  }\r\n  \r\n  this.initSets = function() {\r\n    for(var i=0;i<allFiles.length;++i) {\r\n      if(!dntData.isLoaded(allFiles[i])) {\r\n        return;\r\n      }\r\n    }\r\n    \r\n    vm.items = [];\r\n    for(var i=0;i<files.length;++i) {\r\n      getSetItems(files[i]);\r\n    }\r\n  }\r\n  \r\n  function getSetItems(fileName) {\r\n    var rows = dntData.find(fileName, 'SetItemID', vm.item.setId);\r\n    for(var r=0;r<rows.length;++r) {\r\n      var itemData = dntData.find(allItemFileName, 'id', rows[r].id);\r\n      if(itemData.length > 0) {\r\n        vm.items.push(itemFactory.createBasicItem(itemData[0]));\r\n      }\r\n    }\r\n  }\r\n\r\n}])\r\n.directive('dngearsimItemViewSet', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n    },\r\n    controller: 'itemViewSetCtrl',\r\n    controllerAs: 'ctrl',\r\n    templateUrl: 'ui/item/item-view-set.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemViewShopCtrl',\r\n\r\n['$timeout','dntData','itemFactory','hCodeValues','translations',\r\n  function($timeout, dntData, itemFactory, hCodeValues, translations) {\r\n  'use strict';\r\n  \r\n  if(this.item == null) return;\r\n  \r\n  var vm = this;\r\n  vm.shopCosts = [];\r\n  \r\n  var cShopFileName = 'combinedshoptable.lzjson';\r\n  var cSysShopFileName = 'combinedshoptable_system.lzjson';\r\n  var cCashShopFileName = 'combinedshoptable_cash.lzjson';\r\n  // var shopFileName = 'shoptable.lzjson';\r\n  var allItemFileName = 'all-items.lzjson';\r\n  \r\n  var files = [cCashShopFileName,cSysShopFileName,cShopFileName,allItemFileName];\r\n  for(var i=0;i<files.length;++i) {\r\n    dntData.init(files[i], null, function() {}, function() {\r\n      $timeout(function() {\r\n        vm.initShops();\r\n      });\r\n    });\r\n  }\r\n  \r\n  this.initShops = function() {\r\n    for(var i=0;i<files.length;++i) {\r\n      if(!dntData.isLoaded(files[i])) {\r\n        return;\r\n      }\r\n    }\r\n    \r\n    vm.shopCosts = [];\r\n    getCombinedCosts(cShopFileName);\r\n    getCombinedCosts(cSysShopFileName);\r\n    getCombinedCosts(cCashShopFileName);\r\n    // getShopCosts();\r\n    \r\n    var newShopCosts = [];\r\n    for(var i=0;i<vm.shopCosts.length;++i) {\r\n      var found = false;\r\n      for(var j=0;j<newShopCosts.length;++j) {\r\n        if(vm.shopCosts[i].tabName == newShopCosts[j].tabName &&\r\n          vm.shopCosts[i].gold == newShopCosts[j].gold &&\r\n          vm.shopCosts[i].item1.id == newShopCosts[j].item1.id &&\r\n          vm.shopCosts[i].numItem1.id == newShopCosts[j].numItem1.id &&\r\n          vm.shopCosts[i].item2.id == newShopCosts[j].item2.id &&\r\n          vm.shopCosts[i].numItem2.id == newShopCosts[j].numItem2.id) {\r\n            found = true;\r\n            break;\r\n        }\r\n      }\r\n      \r\n      if(!found) {\r\n        newShopCosts.push(vm.shopCosts[i]);\r\n      }\r\n    }\r\n    \r\n    vm.shopCosts = newShopCosts;\r\n  }\r\n  \r\n  /*\r\n  function getShopCosts() {\r\n    var shops = dntData.getData(shopFileName);\r\n    \r\n    for(var i=0;i<shops.length;++i) {\r\n      var s = shops[i];\r\n      \r\n      var c = 0;\r\n      for(;;) {\r\n        ++c;\r\n        \r\n        var colName = 'itemIndex' + c;\r\n        if(!(colName in s)) {\r\n          break;\r\n        }\r\n        \r\n        var itemId = s[colName];\r\n        if(!itemId) {\r\n          break;\r\n        }\r\n        \r\n        if(itemId == vm.item.id) {\r\n          s = {\r\n            shopName: s.ShopID,\r\n            tabName: translations.translate(s.TabNameID),\r\n            gold: s['Quantity' + c],\r\n          };\r\n          \r\n      \r\n          if(s.shopName in hCodeValues.shopNames) {\r\n            s.shopName = hCodeValues.shopNames[s.shopName];\r\n          }\r\n      \r\n          if(!s.shopName) {\r\n            s.shopName = s.ShopId;\r\n          }\r\n          vm.shopCosts.push(s);\r\n        }\r\n      }\r\n    }\r\n  }*/\r\n\r\n  function getCombinedCosts(fileName) {\r\n    var shops = dntData.find(fileName, 'itemindex', vm.item.id);\r\n    \r\n    for(var i=0;i<shops.length;++i) {\r\n      var s = shops[i];\r\n        \r\n      var item1s = dntData.find(allItemFileName, 'id', s.PurchaseItem1);\r\n      var item2s = dntData.find(allItemFileName, 'id', s.PurchaseItem2);\r\n      \r\n      var shopCost = {\r\n        shopName: s.ShopID,\r\n        tabName: translations.translate(s.TabNameID),\r\n        gold: 0,\r\n        nightmarePoints: 0,\r\n        dungeonPoints: 0,\r\n        nestPoints: 0,\r\n        ladderPoints: 0,\r\n        item1: itemFactory.createBasicItem(item1s[0]),\r\n        item2: itemFactory.createBasicItem(item2s[0]),\r\n        numItem1: 0,\r\n        numItem2: 0,\r\n      };\r\n      \r\n      if(shopCost.shopName in hCodeValues.shopNames) {\r\n        shopCost.shopName = hCodeValues.shopNames[shopCost.shopName];\r\n      }\r\n      \r\n      if(s.PurchaseType1 == 1) {\r\n        shopCost.gold += s.PurchaseItemValue1;\r\n      }\r\n      else if(s.PurchaseType1 == 3) {\r\n        shopCost.ladderPoints += s.PurchaseItemValue1;\r\n      }\r\n      else if(s.PurchaseType1 == 8) {\r\n        shopCost.nightmarePoints += s.PurchaseItemValue1;\r\n      }\r\n      else if(s.PurchaseType1 == 13) {\r\n        shopCost.nestPoints += s.PurchaseItemValue1;\r\n      }\r\n      else if(s.PurchaseType1 == 14) {\r\n        shopCost.dungeonPoints += s.PurchaseItemValue1;\r\n      }\r\n      else {\r\n        shopCost.numItem1 = s.PurchaseItemValue1;\r\n        shopCost.pointsId1 = s.PurchaseType1;\r\n      }\r\n      \r\n      if(s.PurchaseType2 == 1) {\r\n        shopCost.gold += s.PurchaseItemValue2;\r\n      }\r\n      else if(s.PurchaseType2 == 3) {\r\n        shopCost.ladderPoints += s.PurchaseItemValue2;\r\n      }\r\n      else if(s.PurchaseType2 == 8) {\r\n        shopCost.nightmarePoints += s.PurchaseItemValue2;\r\n      }\r\n      else if(s.PurchaseType1 == 13) {\r\n        shopCost.nestPoints += s.PurchaseItemValue2;\r\n      }\r\n      else if(s.PurchaseType1 == 14) {\r\n        shopCost.dungeonPoints += s.PurchaseItemValue2;\r\n      }\r\n      else {\r\n        shopCost.numItem2 = s.PurchaseItemValue2;\r\n        shopCost.pointsId2 = s.PurchaseType2;\r\n      }\r\n      \r\n      shopCost.gold = shopCost.gold/100/100;\r\n      \r\n      vm.shopCosts.push(shopCost);\r\n    }\r\n  }\r\n\r\n}])\r\n.directive('dngearsimItemViewShop', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n    },\r\n    controller: 'itemViewShopCtrl',\r\n    controllerAs: 'ctrl',\r\n    templateUrl: 'ui/item/item-view-shop.html'\r\n  };\r\n});","angular.module('dnsim').controller('itemViewTransferCtrl',\r\n\r\n['$timeout','dntData','itemFactory','hCodeValues',\r\n  function($timeout, dntData, itemFactory, hCodeValues) {\r\n  'use strict';\r\n  \r\n  if(this.item == null) return;\r\n  \r\n  var vm = this;\r\n  vm.matchingTransfers = [];\r\n  \r\n  var transferFileName = 'enchanttransfertable.lzjson';\r\n  var allItemFileName = 'all-items.lzjson';\r\n  var transferItemsFileName = 'enchanttransferitemtable.lzjson';\r\n  \r\n  var files = [transferFileName,allItemFileName,transferItemsFileName];\r\n  for(var i=0;i<files.length;++i) {\r\n    dntData.init(files[i], null, function() {}, function() {\r\n      $timeout(function() {\r\n        vm.initTransfers();\r\n      });\r\n    });\r\n  }\r\n  \r\n  this.initTransfers = function() {\r\n    for(var i=0;i<files.length;++i) {\r\n      if(!dntData.isLoaded(files[i])) {\r\n        return;\r\n      }\r\n    }\r\n    vm.matchingTransfers = [];\r\n    \r\n    var transferItem = dntData.find(transferItemsFileName, 'ItemID', vm.item.id);\r\n    if(transferItem && transferItem.length > 0) {\r\n      var transfers = dntData.find(transferFileName, 'EnchantLevel', vm.item.enchantmentNum);\r\n      \r\n      for(var i=0;i<transfers.length;++i) {\r\n        var t = transfers[i];\r\n        if(t.Rank == vm.item.rank.id && t.LevelLimit == vm.item.levelLimit) {\r\n          \r\n          var item1s = dntData.find(allItemFileName, 'id', t.NeedItemID1);\r\n          var item2s = dntData.find(allItemFileName, 'id', t.NeedItemID2);\r\n          \r\n          vm.matchingTransfers.push({\r\n            level: t.ResultLevel,\r\n            enchantmentNum: t.ResultEnchantLevel,\r\n            gold: t.NeedCoin/100/100,\r\n            rank: hCodeValues.rankNames[t.ResultRank],\r\n            numItem1: t.NeedItemCount1,\r\n            item1: itemFactory.createBasicItem(item1s[0]),\r\n            numItem2: t.NeedItemCount2,\r\n            item2: itemFactory.createBasicItem(item2s[0]),\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n}])\r\n.directive('dngearsimItemViewTransfer', function() {\r\n  return {\r\n    scope: true,\r\n    bindToController: {\r\n      item: '=item',\r\n    },\r\n    controller: 'itemViewTransferCtrl',\r\n    controllerAs: 'ctrl',\r\n    templateUrl: 'ui/item/item-view-transfer.html'\r\n  };\r\n});","angular.module('dnsim').controller('ItemCtrl',\r\n['$scope','$window','dntData','hCodeValues','items','jobs','exportLinkHelper','$routeParams','translations','$location','region','itemFactory','$timeout','statHelper','saveHelper',\r\nfunction($scope,$window,dntData,hCodeValues,items,jobs,exportLinkHelper,$routeParams,translations,$location,region,itemFactory,$timeout,statHelper,saveHelper) {\r\n  'use strict';\r\n  \r\n  region.setLocationByName($routeParams.region);\r\n  \r\n  $window.scrollTo(0, 0);\r\n  \r\n  $scope.jobName = null;\r\n  // console.log('search string: ', $routeParams.i);\r\n  $scope.item = exportLinkHelper.decodeItem($routeParams.i);\r\n  if('itemSource' in $scope.item) {\r\n    $scope.itemType = items[$scope.item.itemSource];\r\n  }\r\n  \r\n  $scope.item.setStats = null;\r\n  $scope.item.setId = null;\r\n  $scope.detail = null;\r\n  \r\n  $scope.getDescription = function() {\r\n    if($scope.item.description) {\r\n      return $scope.item.description;\r\n    }\r\n    else if($scope.itemType &&\r\n      $scope.itemType.name == 'title' &&\r\n      translations.isLoaded() &&\r\n      dntData.isLoaded($scope.itemType.mainDnt)) {\r\n\r\n      var itemData = dntData.find($scope.itemType.mainDnt, 'id', $scope.item.id);\r\n      if(itemData && itemData.length > 0 && itemData[0].DescriptionID > 0) {\r\n        return translations.translate(itemData[0].DescriptionID, itemData[0].DescriptionIDParam);\r\n      }\r\n    }\r\n    else if($scope.item.fileName &&\r\n      dntData.isLoaded($scope.item.fileName + '.lzjson')) {\r\n        \r\n      var itemData = dntData.find($scope.item.fileName + '.lzjson', 'id', $scope.item.id);\r\n      if(itemData && itemData.length > 0 && itemData[0].DescriptionID > 0) {\r\n        return translations.translate(itemData[0].DescriptionID, itemData[0].DescriptionIDParam);\r\n      } \r\n    }\r\n    return '';\r\n  }\r\n  \r\n  $scope.getExchangeType = function() {\r\n    // console.log('getting exchange');\r\n    var exchangeDnt = 'exchange.lzjson';\r\n    if(translations.isLoaded() &&\r\n      dntData.isLoaded(exchangeDnt) &&\r\n      $scope.item.exchangeType > 0) {\r\n        \r\n      // console.log('finding exchange ' + $scope.item.exchangeType);\r\n\r\n      var exchange = dntData.find(exchangeDnt, 'ExchangeType', $scope.item.exchangeType);\r\n      // console.log('got ' + exchange.length);\r\n      if(exchange && exchange.length > 0 && exchange[0].NameID > 0) {\r\n        // console.log('exchange name: ' + exchange[0].NameID);\r\n        return translations.translate(exchange[0].NameID).toLowerCase();\r\n      }\r\n    }\r\n    return '';\r\n  }\r\n  \r\n  $scope.setDetail = function(detail) {\r\n    $scope.detail = detail;\r\n  }\r\n  \r\n  $scope.getNumInSet = function() {\r\n    \r\n    var buildName = $scope.getBuildName();\r\n    if(buildName && $scope.item && $scope.item.setId) {\r\n      return statHelper.getNumItemsForSet($scope.builds[buildName].items, $scope.item.setId);\r\n    }\r\n    \r\n    return 0;\r\n  }\r\n  \r\n  $scope.getBuildName = function() {\r\n    var buildName = saveHelper.getCurrentBuild();\r\n    if($scope.builds) {\r\n      if(!buildName || !(buildName in $scope.builds)) {\r\n        var allBuildNames = Object.keys($scope.builds);\r\n        if(allBuildNames.length) {\r\n          buildName = allBuildNames[0];\r\n        }\r\n      }\r\n    }\r\n    \r\n    return buildName;\r\n  }\r\n\r\n  $scope.getSellingPrice = function() {\r\n    var itemData = itemFactory.getItemData($scope.item);\r\n    var retVal = '';\r\n    if('SellAmount' in itemData && itemData.SellAmount > 0) {\r\n\r\n      var gold = Math.floor(itemData.SellAmount / 10000);\r\n      if(gold) {\r\n        retVal += gold + 'gold ';\r\n      }\r\n\r\n      var silver = Math.floor(itemData.SellAmount / 100) % 100;\r\n      if(silver) {\r\n        retVal += silver + 'silver ';\r\n      }\r\n\r\n      var copper = itemData.SellAmount % 100;\r\n      if(copper) {\r\n        retVal += copper + 'copper ';\r\n      }\r\n    }\r\n    return retVal;\r\n  }\r\n  \r\n  $scope.getServerStorage = function() {\r\n    var itemData = itemFactory.getItemData($scope.item);\r\n    var retVal = '';\r\n    \r\n    if(itemData && 'IsCash' in itemData && itemData.IsCash == 0) {\r\n      if(itemData && 'AbleWStorage' in itemData) {\r\n        if(itemData.AbleWStorage == 1) {\r\n          retVal = 'can server storage';\r\n        }\r\n        else if(itemData.AbleWStorage == 0) {\r\n          if(itemData && 'Reversion' in itemData && itemData.Reversion) {\r\n            retVal = 'not transferable';\r\n          }\r\n        }\r\n      }\r\n\r\n      if(itemData && 'Reversion' in itemData) {\r\n        if(retVal.length) {\r\n          retVal += ', ';\r\n        }\r\n        \r\n        if(itemData.Reversion == 0) {\r\n          retVal += 'can trade';\r\n        }\r\n        else if(itemData.Reversion == 1) {\r\n          retVal += 'not tradable ';\r\n        }\r\n      }\r\n    }\r\n    return retVal;\r\n  }\r\n  \r\n  $scope.getMoreInfo = function() {\r\n    var sealTimes = 0;\r\n    var numStamps = 0;\r\n    \r\n    if($scope.moreInfoLoaded()) {\r\n      var itemData = itemFactory.getItemData($scope.item);\r\n      \r\n      if(itemData && 'IsCash' in itemData && itemData.IsCash == 0) {\r\n        if(itemData && 'SealID' in itemData && 'SealCount' in itemData) {\r\n          sealTimes = itemData.SealCount;\r\n            \r\n          var sealData = dntData.find('sealcounttable.lzjson', 'Type2', itemData.SealID);\r\n          if(sealData && sealData.length > 0 && sealData[0].Type1 == 0) {\r\n            \r\n            var colName = 'Count0';\r\n            if($scope.item.enchantmentNum) {\r\n              colName = 'Count' + $scope.item.enchantmentNum;\r\n            }\r\n            \r\n            if(colName in sealData[0]) {\r\n              numStamps = sealData[0][colName];\r\n            }\r\n          }\r\n        }\r\n      }\r\n      else if(itemData && 'IsCash' in itemData && 'CashTradeCount' in itemData && 'Reversion' in itemData && 'AbleWStorage' in itemData) {\r\n        if(itemData.Reversion == 2) {\r\n          if(itemData.CashTradeCount) {\r\n            return 'can server storage, cash trade count: ' + itemData.CashTradeCount;\r\n          }\r\n          else {\r\n            return 'can server storage, can use warranty';\r\n          }\r\n        }\r\n        else if(itemData.AbleWStorage) {\r\n          return 'can server storage';\r\n        }\r\n        else {\r\n          return 'not tradable';\r\n        }\r\n      }\r\n    }\r\n    \r\n    if(sealTimes && numStamps) {\r\n      return 'can stamp ' + sealTimes + ' times using ' + numStamps + '  stamps';\r\n    }\r\n    else {\r\n      return '';\r\n    }\r\n  }\r\n  \r\n  $scope.moreInfoLoaded = function() {\r\n    return dntData.isLoaded($scope.item.fileName + '.lzjson') &&\r\n      dntData.isLoaded('sealcounttable.lzjson');\r\n  }\r\n  \r\n  $scope.loadMoreInfo = function() {\r\n    dntData.init($scope.item.fileName + '.lzjson', null, $timeout);\r\n    dntData.init('sealcounttable.lzjson', null, $timeout);\r\n  }\r\n  \r\n  $scope.handleChange = function() {\r\n    // console.log('changes');\r\n    if($scope.item.itemSource != 'custom') {\r\n      $location.search('i', exportLinkHelper.encodeItem($scope.item));\r\n    }\r\n    else {\r\n      setFullStats();\r\n      $scope.item = angular.copy($scope.item);\r\n    }\r\n    getBuilds();\r\n  }\r\n  \r\n  function getJobName() {\r\n    var allJobs = jobs.getAllJobs();\r\n    angular.forEach(allJobs, function(job, index) {\r\n      if(job.id == $scope.item.needJobClass) {\r\n        $scope.jobName = job.name;\r\n      }\r\n    });\r\n  }\r\n  \r\n  function init() {\r\n    getBuilds();\r\n    $scope.preInitItem = $scope.item;\r\n    $scope.item = null;\r\n  \r\n    var anyToLoad = false;\r\n    \r\n    angular.forEach(exportLinkHelper.getDntFiles($scope.preInitItem), function(columns, fileName) {\r\n      if(!dntData.isLoaded(fileName)) {\r\n        dntData.init(fileName, columns, reportProgress, tryInit);\r\n        anyToLoad = true;\r\n      }\r\n    });\r\n    \r\n    if(!translations.isLoaded()) {\r\n      translations.init(reportProgress, tryInit);\r\n      anyToLoad = true;\r\n    }\r\n    \r\n    if(!jobs.isLoaded()) {\r\n      jobs.init(reportProgress, tryInit);\r\n      anyToLoad = true;\r\n    }\r\n    \r\n    if(!anyToLoad) {\r\n      tryInit();\r\n    }\r\n  }\r\n  init();\r\n\r\n  function isLoaded() {\r\n    var anyDntToLoad = false;\r\n    angular.forEach(exportLinkHelper.getDntFiles($scope.preInitItem), function(columns, fileName) {\r\n      if(!dntData.isLoaded(fileName)) {\r\n        anyDntToLoad = true;\r\n      }\r\n    });\r\n\r\n    return !anyDntToLoad && translations.isLoaded() && jobs.isLoaded();\r\n  }\r\n  \r\n  function tryInit() {\r\n    if(isLoaded()) {\r\n      $scope.item = exportLinkHelper.reloadItem($scope.preInitItem);\r\n      if($scope.item == null) {\r\n        return;\r\n      }\r\n      \r\n      setFullStats();\r\n      $window.document.title = 'dngearsim | ' + $scope.item.name;\r\n      if($scope.item.itemSource != 'custom') {\r\n      \r\n        if($scope.item.typeName == 'skills') {\r\n          if(!$scope.item.pve || $scope.item.pve != 'pvp') {\r\n            $scope.item.pve = 'pve';\r\n          }\r\n          else {\r\n            $scope.item.pve = 'pvp';\r\n          }\r\n        }\r\n        else {\r\n          if($scope.item.needJobClass > 0) {\r\n            getJobName();\r\n          }\r\n        }\r\n        \r\n        setFileName();\r\n      }\r\n\r\n      setupTabs();\r\n    }\r\n  }\r\n\r\n  function setupTabs() {\r\n    var itemData = itemFactory.getItemData($scope.item);\r\n    if(itemData.DisjointDrop1 > 0) {\r\n      $scope.canExtract = true;\r\n    }\r\n    \r\n    if((itemData.Type == 0 || itemData.Type == 1) && $scope.item.enchantmentNum > 0) {\r\n      $scope.canTransfer = true;\r\n    }\r\n    \r\n    if($scope.item.setId) {\r\n      $scope.isInSet = true;\r\n    }\r\n    \r\n    if($scope.item.typeId == 5) {\r\n      $scope.isPlate = true;\r\n    }\r\n    \r\n    if($scope.item.typeId == 46 || $scope.item.typeId == 8 || $scope.item.typeId == 112 || $scope.item.typeId == 122 || $scope.item.typeId == 142 || $scope.item.typeId == 160) {\r\n      $scope.hasContents = true;\r\n      $scope.detail = 'contents';\r\n    }\r\n    else if($scope.item.typeName != null) {\r\n      $scope.canUse = true;\r\n      $scope.detail = 'use';\r\n    }\r\n    else if($scope.canExtract) {\r\n      $scope.detail = 'extract';\r\n    }\r\n    else if($scope.canTransfer) {\r\n      $scope.detail = 'transfer';\r\n    }\r\n    else if($scope.isPlate) {\r\n      $scope.detail = 'plate';\r\n    }\r\n    else {\r\n      $scope.detail = 'attainment';\r\n    }\r\n  }\r\n  \r\n  function setFileName() {\r\n    if(!$scope.item.fileName) {\r\n      if($scope.item.itemSource in items && items[$scope.item.itemSource].mainDnt) {\r\n        $scope.item.fileName = items[$scope.item.itemSource].mainDnt.replace('.lzjson', '').replace('.json', '').replace('.optimised', '');\r\n      }\r\n    }\r\n  }\r\n  \r\n  function setFullStats() {\r\n    // full stats are cleared when publishing builds\r\n    $scope.item.fullStats = $scope.item.stats;\r\n    \r\n    if($scope.item.enchantmentStats != null && $scope.item.enchantmentStats.length > 0) {\r\n      $scope.item.fullStats = hCodeValues.mergeStats($scope.item.enchantmentStats, $scope.item.fullStats);\r\n    }\r\n    \r\n    if($scope.item.sparkStats != null && $scope.item.sparkStats.length > 0) {\r\n      $scope.item.fullStats = hCodeValues.mergeStats($scope.item.sparkStats, $scope.item.fullStats);\r\n    }\r\n  }\r\n  \r\n  function reportProgress(msg) {\r\n    // $scope.progress += '|' + msg;\r\n    // console.log('progress: ' + msg);\r\n  }\r\n  \r\n  function getBuilds() {\r\n    var builds = saveHelper.getSavedItems();\r\n    $scope.builds = builds;\r\n  }\r\n}]);","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('character', character);\r\nfunction character(dntData,itemColumnsToLoad,jobs,hCodeValues) {\r\n\r\n  var jobConversions = 'rebootplayerweighttable.lzjson';\r\n  var statCaps = 'playercommonleveltable.lzjson';\r\n  var jobBaseStats = 'playerleveltable.optimised.json';\r\n\r\n  var heroLevels = 'heroleveltable.lzjson';\r\n  var heroLevelPotentials = 'potentialtable_herolevel.lzjson';\r\n  \r\n  function reportProgress(msg) {\r\n    // console.log('progress: ' + msg);\r\n  }\r\n\r\n  return {\r\n    init: function(complete) {\r\n      jobs.init(reportProgress, complete);\r\n      dntData.init(jobConversions, itemColumnsToLoad.jobConversionColsToLoad, reportProgress, complete, false);\r\n      dntData.init(statCaps, itemColumnsToLoad.statCapColsToLoad, reportProgress, complete, false);\r\n      dntData.init(jobBaseStats, itemColumnsToLoad.jobBaseStatColsToLoad, reportProgress, complete, false);\r\n      dntData.init(heroLevels, null, reportProgress, complete, false);\r\n      dntData.init(heroLevelPotentials, null, reportProgress, complete, false);\r\n    },\r\n    \r\n    getHeroStats: function(heroLevel) {\r\n      var heroStats = [];\r\n      if(heroLevel > 0) {\r\n        var index = dntData.findFast(heroLevels, 'id', heroLevel);\r\n        if(index.length == 1) {\r\n          var h = dntData.getRow(heroLevels, index[0]);\r\n          if(h) {\r\n            var pIndex = dntData.findFast(heroLevelPotentials, 'PotentialID', h.HeroLevelAbilityID);\r\n            if(pIndex.length == 1) {\r\n              var p = dntData.getRow(heroLevelPotentials, pIndex[0]);\r\n              if(p) {\r\n                heroStats = hCodeValues.getStats(p);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return heroStats;\r\n    },\r\n    \r\n    getStatCaps: function(level) {\r\n      if(level > 0) {\r\n        var index = dntData.findFast(statCaps, 'id', level);\r\n        if(index.length == 1) {\r\n          return dntData.getRow(statCaps, index[0]);\r\n        }\r\n      }\r\n      \r\n      return {};\r\n    },\r\n    \r\n    getConversions: function(jobId) {\r\n      if(jobId > 0) {\r\n        var index = dntData.findFast(jobConversions, 'id', jobId);\r\n        if(index.length == 1) {\r\n          return dntData.getRow(jobConversions, index[0]);\r\n        }\r\n      }\r\n      \r\n      return {};\r\n    },\r\n    \r\n    getBaseStats: function(level, jobId) {\r\n      if(level > 0 && jobId > 0) {\r\n        var index = dntData.findFast(jobBaseStats, 'id', (Number(jobId) * 100) + Number(level) - 100);\r\n        if(index.length == 1) {\r\n          return dntData.getRow(jobBaseStats, index[0]);\r\n        }\r\n      }\r\n      \r\n      return {};\r\n    }\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('itemColumnsToLoad',[itemColumnsToLoad]);\r\nfunction itemColumnsToLoad() {\r\n  return {\r\n    mainDnt: {\r\n      NameID: true, DescriptionID: true, NameIDParam: true, DescriptionIDParam: true,\r\n      Type: true,TypeParam1: true,TypeParam2: true, TypeParam3: true, LevelLimit: true, NeedJobClass: true, Rank: true,\r\n      State1: true, StateValue1: true, State1_Max: true,\r\n      State2: true, StateValue2: true, State2_Max: true,\r\n      State3: true, StateValue3: true, State3_Max: true,\r\n      State4: true, StateValue4: true, State4_Max: true,\r\n      State5: true, StateValue5: true, State5_Max: true,\r\n      State6: true, StateValue6: true, State6_Max: true,\r\n      State7: true, StateValue7: true, State7_Max: true,\r\n      State8: true, StateValue8: true, State8_Max: true,\r\n      State9: true, StateValue9: true, State9_Max: true,\r\n      State10: true,StateValue10: true,State10_Max: true,\r\n      EnchantID: true,\r\n      SkillID: true,\r\n      dragonjeweltype: true, AbleWStorage: true, ExchangeType:true, IconImageIndex: true, IsCash: true, DisjointDrop1: true, Disjointamount: true\r\n    },\r\n    partsDnt: {\r\n      SetItemID: true\r\n    },\r\n    enchantDnt: {\r\n      EnchantID: true,EnchantLevel: true,EnchantRatio: true,BreakRatio: true,MinDown: true,MaxDown: true,NeedCoin: true,\r\n      DisjointDrop: true,\r\n      NeedItemID1: true,NeedItemCount1: true,NeedItemID2: true,NeedItemCount2: true,NeedItemID3: true,NeedItemCount3: true,NeedItemID4: true,NeedItemCount4: true,NeedItemID5: true,NeedItemCount5: true,ProtectItemCount: true,\r\n      State1: true,State1Value: true,State2: true,State2Value: true,State3: true,State3Value: true,State4: true,State4Value: true,State5: true,State5Value: true,State6: true,State6Value: true,State7: true,State7Value: true,State8: true,State8Value: true,State9: true,State9Value: true,State10: true,State10Value: true\r\n    },\r\n    potentialDnt : {\r\n      PotentialID: true, PotentialNo: true,PotentialRatio: true,\r\n      State1: true,State1Value: true,\r\n      State2: true,State2Value: true,\r\n      State3: true,State3Value: true,\r\n      State4: true,State4Value: true,\r\n      State5: true,State5Value: true,\r\n      State6: true,State6Value: true,\r\n      State7: true,State7Value: true,\r\n      State8: true,State8Value: true,\r\n      State9: true,State9Value: true,\r\n      State10: true,State10Value: true,\r\n      State11: true,State11Value: true,\r\n      State12: true,State12Value: true,\r\n      State13: true,State13Value: true,\r\n      State14: true,State14Value: true,\r\n      State15: true,State15Value: true,\r\n      State16: true,State16Value: true\r\n    },\r\n    gemDnt: {\r\n      Type: true\r\n    },\r\n    setDnt : null,\r\n    sparkDnt: null,\r\n    jobsDnt: {\r\n      JobName: true,JobNumber: true,BaseClass: true,ParentJob: true, EnglishName: true, JobIcon: true\r\n    },\r\n    jobBaseStatColsToLoad: {\r\n      Strength:true,Agility:true,Intelligence:true,Stamina:true,AggroperPvE:true,BaseMP:true\r\n    },\r\n    statCapColsToLoad: {\r\n      Cbase: true,\r\n      Cdefense: true,\r\n      Ccritical: true,\r\n      Cfinaldamage: true,\r\n      CcriticalDamage: true,\r\n    },\r\n    jobConversionColsToLoad: {\r\n      HP: true,StrengthAttack: true,AgilityAttack: true,IntelligenceAttack: true,PhysicalDefense: true,MagicDefense: true,Critical: true,CriticalResistance: true,Stiff: true,StiffResistance: true,Stun: true,StunResistance: true,MoveSpeed: true,MoveSpeedRevision: true,DownDelay: true,ElementAttack: true,ElementDefense: true,ElementDefenseMin: true,ElementDefenseMax: true,StrengthIntelligenceToCriticalDamage: true\r\n    }\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('dntData', ['$rootScope','$timeout',dntData]);\r\n\r\nfunction dntData($rootScope,$timeout) {\r\n  \r\n  function createLoader(dntLocation, file, colsToLoad) {\r\n\r\n    var loader = {\r\n      reader: new DntReader(),\r\n      \r\n      loaded: false,\r\n      startedLoading: false,\r\n      \r\n      file: file,\r\n      \r\n      dntLocation: dntLocation,\r\n      progressCallback: null,\r\n      completeCallbacks : [],\r\n      \r\n      init: function(progress, complete, ignoreErrors) {\r\n        \r\n        if(this.loaded) {\r\n          if(complete) {\r\n            complete();\r\n          }\r\n        }\r\n        else {\r\n          this.progressCallback = progress;\r\n          if(complete) {\r\n            this.completeCallbacks.push(complete);\r\n          }\r\n          \r\n          if(!this.startedLoading) {\r\n            this.startedLoading = true;\r\n            var t = this;\r\n            \r\n            this.reader.colsToLoad = colsToLoad;\r\n            \r\n            if(this.dntLocation && \r\n              this.dntLocation.url &&\r\n              this.dntLocation.url.length) {\r\n\r\n              $rootScope.$broadcast('DNTDATA_LOAD_EVENT');\r\n\r\n              $timeout(function() {\r\n                t.reader.loadDntFromServerFile(\r\n                  t.dntLocation.url + '/' + file,\r\n                  function(msg) {\r\n                    if(t.progressCallback) {\r\n                      t.progressCallback(msg);\r\n                    }\r\n                  }, \r\n                  function(result, fileName) {\r\n                    // console.info('dnt loading complete : ' + file);\r\n                    t.loaded = true;\r\n                    \r\n                    angular.forEach(t.completeCallbacks, function(value, key) {\r\n                      if(value) {\r\n                        value();\r\n                      }\r\n                    });\r\n                    t.completeCallbacks = [];\r\n                    $rootScope.$broadcast('DNTDATA_LOAD_EVENT');\r\n                  },\r\n                  function(msg) {\r\n                    t.failed = true;\r\n                    if(ignoreErrors) {\r\n                      t.loaded = true;\r\n                      console.log('ignoring the error - this file may not exist yet for the region');\r\n                      angular.forEach(t.completeCallbacks, function(value, key) {\r\n                        if(value) {\r\n                          value();\r\n                        }\r\n                      });\r\n                      t.completeCallbacks = [];\r\n                      $rootScope.$broadcast('DNTDATA_LOAD_EVENT');\r\n                    }\r\n                    else {\r\n                      t.startedLoading = false;\r\n                      t.loaded = false;\r\n                      $rootScope.$broadcast('DNTDATA_LOAD_ERROR');\r\n                    }\r\n                  }  );\r\n              });\r\n            }\r\n            else {\r\n              // console.log(\"dnt location not set!\");\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \r\n      reset: function() {\r\n        this.reader = new DntReader();\r\n        this.loaded = false;\r\n        this.startedLoading = false;\r\n      }\r\n    }\r\n  \r\n    return loader;\r\n  };\r\n  \r\n  return {\r\n    loaders : {},\r\n    findIndexes : {},\r\n    dntLocation : null,\r\n    \r\n    setLocation: function(location) {\r\n      this.dntLocation = location;\r\n      var t = this;\r\n      angular.forEach(this.loaders, function(value, key) {\r\n        if(value.dntLocation != location) {\r\n          value.dntLocation = location;\r\n          t.reset(key);\r\n        }\r\n      });\r\n    },\r\n    \r\n    init : function (fileName, colsToLoad, progress, complete, ignoreErrors) {\r\n      if(ignoreErrors !== false) {\r\n        ignoreErrors = true;\r\n      }\r\n\r\n      if(!progress) {\r\n        progress = function() {};\r\n      }\r\n      if(!(fileName in this.loaders)) {\r\n        if(fileName.length > 0) {\r\n          this.loaders[fileName] = createLoader(this.dntLocation, fileName, colsToLoad);\r\n        }\r\n      }\r\n      this.loaders[fileName].init(progress, complete, ignoreErrors);\r\n    },\r\n    getData : function (fileName) {\r\n      if(this.isLoaded(fileName)) {\r\n        var reader = this.loaders[fileName].reader;\r\n        var retVal = new Array(reader.numRows);\r\n        for(var i=0;i<reader.numRows;++i) {\r\n          retVal[i] = reader.getRow(i);\r\n        }\r\n        \r\n        return retVal;\r\n      }\r\n      else {\r\n        return [];\r\n      }\r\n    },\r\n    find : function(fileName, column, value) {\r\n      var results = this.findFast(fileName, column, value);\r\n      var retVal = [];\r\n      var numResults = results.length;\r\n      for(var i=0;i<numResults;++i) {\r\n        retVal.push(this.getRow(fileName, results[i]));\r\n      }\r\n      \r\n      return retVal;\r\n    },\r\n    findFast : function(fileName, column, value) {\r\n      \r\n      if(this.isLoaded(fileName)) {\r\n        if(!(fileName in this.findIndexes)){\r\n          this.findIndexes[fileName] = {};\r\n        }\r\n        \r\n        var reader = this.loaders[fileName].reader;\r\n        var colIndex = reader.columnIndexes[column];\r\n        \r\n        var findIndex = this.findIndexes[fileName];\r\n        \r\n        if(!(column in findIndex)) {\r\n          var index = {}\r\n          findIndex[column] = index;\r\n          \r\n          var results = [];\r\n          \r\n          var data = reader.data;\r\n          var len = data.length;\r\n          for(var r=0;r<len;++r) {\r\n            var d = data[r];\r\n            var val = d[colIndex];\r\n\r\n            if(!(val in index)) {\r\n              index[val] = [r];\r\n            }\r\n            else {\r\n              index[val].push(r);\r\n            }\r\n          }\r\n        }\r\n        \r\n        if(value in findIndex[column]) {\r\n          return findIndex[column][value];\r\n        }\r\n        else {\r\n          return [];\r\n        }\r\n      }\r\n      \r\n      return [];\r\n    },\r\n    isLoaded : function(fileName) {\r\n      return fileName in this.loaders && this.loaders[fileName].loaded;\r\n    },\r\n    hasFailed : function(fileName) {\r\n      return fileName in this.loaders && this.loaders[fileName].failed;\r\n    },\r\n    hasStartedLoading : function(fileName) {\r\n      return this.isLoaded(fileName) || (fileName in this.loaders && this.loaders[fileName].startedLoading);\r\n    },\r\n    reset : function(fileName) {\r\n      if(fileName in this.loaders) {\r\n        this.loaders[fileName].reset();\r\n        delete this.loaders[fileName];\r\n        delete this.findIndexes[fileName];\r\n      }\r\n    },\r\n    resetAll : function() {\r\n      var t = this;\r\n      angular.forEach(this.loaders, function(value, key) {\r\n        t.reset(key);\r\n      });\r\n    },\r\n    anyLoading : function() {\r\n      var t = this;\r\n      var found = 0;\r\n      angular.forEach(this.loaders, function(value, key) {\r\n        if(!value.loaded && value.startedLoading) {\r\n          found++;\r\n        }\r\n      });\r\n      \r\n      return found;\r\n    },\r\n    getNumRows : function(fileName) {\r\n      if(this.isLoaded(fileName)) {\r\n        return this.loaders[fileName].reader.numRows;\r\n      }\r\n      else {\r\n        return 0;\r\n      }\r\n    },\r\n    getRow : function(fileName, index) {\r\n      if(this.isLoaded(fileName)) {\r\n        return this.loaders[fileName].reader.getRow(index);\r\n      }\r\n      else {\r\n        return {};\r\n      }\r\n    },\r\n    lookupValue: function(fileName, data, columnName) {\r\n      if(this.isLoaded(fileName)) {\r\n        return data[this.loaders[fileName].reader.columnNames[columnName]];\r\n      }\r\n      else {\r\n        return null;\r\n      }\r\n    },\r\n    convertData: function(fileName, data) {\r\n      if(this.isLoaded(fileName)) {\r\n        return this.loaders[fileName].reader.convertData(data);\r\n      }\r\n      else {\r\n        return null;\r\n      }\r\n    },\r\n    getValue : function(fileName, index, columnName) {\r\n      if(this.isLoaded(fileName)) {\r\n        return this.loaders[fileName].reader.getValue(index, columnName);\r\n      }\r\n      else {\r\n        return null;\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('dntInit', ['items','jobs','dntData','itemFactory',dntInit]);\r\nfunction dntInit(items,jobs,dntData,itemFactory) {\r\n  return function(progress) {\r\n    \r\n    progress('starting init');\r\n    \r\n    var allFactories = [jobs];\r\n    \r\n    var dntFiles = {};\r\n    angular.forEach(items, function(item, key) {\r\n      if(key != 'all') {\r\n        angular.forEach(item, function(value, prop) {\r\n          if(prop.indexOf('Dnt') == prop.length-3) {\r\n            var newFactory = { \r\n              init: function(progress, complete) {\r\n                dntData.init(value, null, progress, complete);\r\n              },\r\n              isLoaded: function() {\r\n                return dntData.isLoaded(value);\r\n              },\r\n              fileName: value,\r\n            };\r\n            \r\n            allFactories.push(newFactory);\r\n          }\r\n        });\r\n      }\r\n    });\r\n    \r\n    function initFactory(index) {\r\n    \r\n      if(index < allFactories.length) {\r\n        allFactories[index].init(progress, function() { \r\n          if(allFactories[index].isLoaded()) {\r\n            if('fileName' in allFactories[index]) {\r\n              progress('dnt loaded: ' + allFactories[index].fileName);\r\n            }\r\n            initFactory(index+1);\r\n          }\r\n        });\r\n      }\r\n      else {\r\n        progress('Full initialise complete');\r\n      }\r\n    }\r\n    \r\n    initFactory(0);\r\n  }\r\n}\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('dntReset',['items','jobs','dntData',dntReset]);\r\nfunction dntReset(items, jobs, dntData) {\r\n  return function() {\r\n    \r\n    angular.forEach(items, function(source, name) {\r\n      source.reset();\r\n    });\r\n    \r\n    jobs.reset();\r\n    dntData.resetAll();\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('dvStatcardHelper', dvStatcardHelper);\r\nfunction dvStatcardHelper() {\r\n  'use strict';\r\n\r\n  // Conversions between dngs stat IDs and dvstatcard keys\r\n  var statMap = {\r\n      0: 'statStr',\r\n      1: 'statAgi',\r\n      2: 'statInt',\r\n      3: 'statVit',\r\n      4: 'statPDmgMin',\r\n      5: 'statPDmgMax',\r\n      6: 'statMDmgMin',\r\n      7: 'statMDmgMax',\r\n      8: 'statPDef',\r\n      9: 'statMDef',\r\n      12: 'statCrit',\r\n      16: 'statFire',\r\n      17: 'statIce',\r\n      18: 'statLight',\r\n      19: 'statDark',\r\n      25: 'statHp',\r\n      26: 'statMana',\r\n      29: 'statFD',\r\n      103: 'statCritDmg',\r\n  };\r\n\r\n  //    Converts dngs stat IDs to dvstatcard stat keys\r\n  function convertStat(stat) {\r\n    var ret = statMap[stat.id];\r\n    return ret || 'unknown';\r\n  };\r\n\r\n  function convertPercentToNum(val) {\r\n      return val * 100;\r\n  };\r\n\r\n  //    Stats that need to have some conversion applied between dngs and dvstatcard\r\n  var adjustments = {\r\n      16: convertPercentToNum,\r\n      17: convertPercentToNum,\r\n      18: convertPercentToNum,\r\n      19: convertPercentToNum,\r\n  }\r\n\r\n  //    Convert between numerical standards between dngs and dvstatcard\r\n  function adjustStat(stat) {\r\n      var func = adjustments[stat.id];\r\n      if (func) {\r\n          return func(stat.max);\r\n      }\r\n      return stat.max;\r\n  };\r\n\r\n  return {\r\n      convertStats: function(build, buildName, calcStats) {\r\n        var ret = {\r\n            characterName: buildName,\r\n            remark: 'Imported from DNGearsim',\r\n            classId: build.job.id,\r\n            statHeroLevel: build.heroLevel,\r\n        }\r\n        for (var k in calcStats) {\r\n            var v = calcStats[k];\r\n            ret[convertStat(v)] = adjustStat(v);\r\n        }\r\n        return ret;\r\n      },\r\n      cardImportUrl: 'https://redirect.divinitor.com/dngsimport',\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('exportLinkHelper', exportLinkHelper);\r\nfunction exportLinkHelper($http,items,dntData,itemFactory,hCodeValues,itemColumnsToLoad,statHelper,translations,itemCategory,region) {\r\n\r\n  return {\r\n    \r\n    encodeItem: function(item, small) {\r\n      if(item) {\r\n        var itemString;\r\n\r\n        if(item.typeName == 'custom')  {\r\n          itemString = '_custom';\r\n          angular.forEach(item.stats, function(stat, index) {\r\n            if(index > 0) {\r\n              itemString += '|';\r\n            }\r\n            else {\r\n              itemString += ':C';\r\n            }\r\n            itemString += stat.id.toString(36) + '=' + stat.max;\r\n          });\r\n        }\r\n        else if(item.id) {\r\n          itemString = 'I' + item.id.toString(36) + ':_';\r\n          if('itemSource' in item) {\r\n            itemString += item.itemSource;\r\n          }\r\n          else if('itemTypeName' in item) {\r\n            // this is to support groups saved with the old property name\r\n            itemString += item.itemTypeName;\r\n          }\r\n          else if(item.fileName) {\r\n            itemString += ':F' + item.fileName;\r\n          }\r\n        \r\n          if(item.enchantmentNum || item.enchantmentNum == 0) {\r\n            itemString += ':E' + item.enchantmentNum.toString(36);\r\n          }\r\n          if(item.pid > 0) {\r\n            itemString += ':P' + item.pid.toString(36);\r\n          }\r\n          // if(item.setId > 0) {\r\n            // itemString += ':S' + item.setId.toString(36);\r\n          // }\r\n          if(item.sparkId > 0) {\r\n            itemString += ':H' + item.sparkId.toString(36);\r\n          }\r\n          if(item.typeName == 'skills') {\r\n            itemString += ':J' + item.baseJobName;\r\n          }\r\n          if(item.pve) {\r\n            itemString += ':V' + item.pve;\r\n          }\r\n        }\r\n        \r\n        if(item.name && !small) {\r\n          itemString += ':.' + item.name.replace(/ /g, '-').replace(/\\//g, ' ');\r\n        }\r\n\r\n        return itemString;\r\n      }\r\n      \r\n      return '';\r\n    },\r\n    \r\n    decodeItem: function(itemStr) {\r\n      var item = {};\r\n      \r\n      if(itemStr) {\r\n        angular.forEach(itemStr.split(':'), function(itemBit, bitIndex) {\r\n          if(itemBit.charAt(0) == 'I') {\r\n            item.id = parseInt(itemBit.substr(1), 36);\r\n          }\r\n          else if(itemBit.charAt(0) == 'E') {\r\n            item.enchantmentNum = parseInt(itemBit.substr(1), 36);\r\n          }\r\n          else if(itemBit.charAt(0) == 'P') {\r\n            item.pid = parseInt(itemBit.substr(1), 36);\r\n          }\r\n          else if(itemBit.charAt(0) == 'S') {\r\n            item.setId = parseInt(itemBit.substr(1), 36);\r\n          }\r\n          else if(itemBit.charAt(0) == 'H') {\r\n            item.sparkId = parseInt(itemBit.substr(1), 36);\r\n          }\r\n          else if(itemBit.charAt(0) == 'J') {\r\n            item.baseJobName = itemBit.substr(1);\r\n          }\r\n          else if(itemBit.charAt(0) == 'V') {\r\n            item.pve = itemBit.substr(1);\r\n          }\r\n          else if(itemBit.charAt(0) == '_') {\r\n            item.itemSource = itemBit.substr(1);\r\n          }\r\n          else if(itemBit.charAt(0) == '.') {\r\n            item.name = itemBit.substr(1).replace('-', ' ');\r\n          }\r\n          else if(itemBit.charAt(0) == 'C') {\r\n            item.stats = [];\r\n            var statString = itemBit.substr(1);\r\n            angular.forEach(statString.split('|'), function(statBit, statBitIndex) {\r\n              var splitStat = statBit.split('=');\r\n              item.stats.push({\r\n                id: parseInt(splitStat[0], 36),\r\n                max: Number(splitStat[1])\r\n              });\r\n            });\r\n          }\r\n          else if(itemBit.charAt(0) == 'F') {\r\n            \r\n            item.fileName = itemBit.substr(1);\r\n            angular.forEach(items, function(itemSource, key) {\r\n              if(itemSource.mainDnt && itemSource.mainDnt.indexOf(item.fileName + '.') == 0) {\r\n                item.itemSource = key;\r\n              }\r\n            });\r\n          }\r\n        });\r\n      }\r\n      \r\n      return item;\r\n    },\r\n    \r\n    createGroupLink: function(groupName, group) {\r\n      var itemStrings = [];\r\n      var self = this;\r\n      \r\n      if(group == null) {\r\n        return '';\r\n      }\r\n      \r\n      angular.forEach(group.items, function(item, key) {\r\n        var itemString = self.encodeItem(item, true);  \r\n        if(itemString && itemString.length) {\r\n          itemStrings.push(itemString);\r\n        }\r\n      });\r\n  \r\n      var retVal = 'view-group?region=';\r\n      if(region.dntLocation && region.dntLocation.region) {\r\n        retVal += region.dntLocation.region;\r\n      }\r\n      \r\n      if(group.enemyLevel) {\r\n        retVal += '&e=' + group.enemyLevel;\r\n      }\r\n      if(group.playerLevel) {\r\n        retVal += '&p=' + group.playerLevel;\r\n      }\r\n      if(group.heroLevel) {\r\n        retVal += '&h=' + group.heroLevel;\r\n      }\r\n      if(group.job && group.job.id) {\r\n        retVal += '&j=' + group.job.id;\r\n      }\r\n      if(group.damageType && group.damageType.id) {\r\n        retVal += '&d=' + group.damageType.id;\r\n      }\r\n      if(group.element && group.element.id) {\r\n        retVal += '&t=' + group.element.id;\r\n      }\r\n      if(group.secondaryElement && group.secondaryElement.id) {\r\n        retVal += '&s=' + group.secondaryElement.id;\r\n      }\r\n      retVal += '&g=' + encodeURI(groupName) + '&i=' + itemStrings.join(',');\r\n      return retVal;\r\n    },\r\n\r\n    reloadSkill: function(item) {\r\n\r\n        if(!item.enchantmentNum) {\r\n          item.enchantmentNum = 1;\r\n        }\r\n        \r\n        var skillDnt = 'skilltable_character' + item.baseJobName + '.lzjson';\r\n        var pv = 'pve';\r\n        if(item.pve == 'pvp') {\r\n          pv = 'pvp';\r\n        }\r\n        var skillLevelDnt = 'skillleveltable_character' + item.baseJobName + pv + '.lzjson';\r\n        \r\n        var skillData = dntData.find(skillDnt, 'id', item.id)[0];\r\n        if(!skillData) {\r\n          console.log('cannot get skill data from ', skillDnt);\r\n        }\r\n        var skillLevelDatas = dntData.getData(skillLevelDnt);\r\n\r\n        var skillLevelVals = {};\r\n        angular.forEach(skillLevelDatas, function(value, index) {\r\n          if(value.SkillIndex == item.id && value.SkillLevel == item.enchantmentNum) {\r\n            skillLevelVals = value;\r\n          }\r\n        });\r\n        \r\n        var newItem = {\r\n          id: item.id,\r\n          itemSource: item.itemSource,\r\n          typeName: item.itemSource,\r\n          needJobClass: skillData.NeedJob,\r\n          baseJobName: item.baseJobName,\r\n          rank: hCodeValues.rankNames[0],\r\n          enchantmentNum: item.enchantmentNum,\r\n          name: translations.translate(skillData.NameID, skillData.NameIDParam),\r\n          description: translations.translate(skillLevelVals.SkillExplanationID, skillLevelVals.SkillExplanationIDParam),\r\n          icon: skillData.IconImageIndex,\r\n          pve: item.pve\r\n        };\r\n        \r\n        newItem.stats = statHelper.getSkillStats(newItem, skillData, skillLevelDatas);\r\n        return newItem;\r\n    },\r\n\r\n    reloadSourceItem: function(item) {\r\n      var itemType = items[item.itemSource];\r\n      var ds = dntData.findFast(itemType.mainDnt, 'id', item.id);\r\n      if(!ds.length) {\r\n        console.log('item ' + item.id + ' not found in ' + itemType.mainDnt);\r\n        return;\r\n      }\r\n\r\n      var rowNum = ds[0];\r\n      var typeParam1 = dntData.getValue(itemType.mainDnt, rowNum, 'TypeParam1');\r\n    \r\n      var p = null;\r\n      \r\n      var ps = dntData.find(itemType.potentialDnt, 'id', item.pid);\r\n      if(!ps.length) {\r\n        ps = dntData.find(itemType.potentialDnt, 'PotentialID', typeParam1);\r\n      }\r\n      \r\n      if(!ps.length) {\r\n        ps = dntData.find(itemType.potentialDntEx, 'id', item.pid);\r\n        if(!ps.length) {\r\n          ps = dntData.find(itemType.potentialDntEx, 'PotentialID', typeParam1);\r\n        }\r\n      }\r\n      \r\n      if(ps.length > 0) {\r\n        p = ps[0];\r\n        \r\n        if(p.PotentialID != typeParam1) {\r\n          // this happened one time\r\n          // not sure how but it corrupted the stats\r\n          p = null;\r\n          console.log('bad potential');\r\n        }\r\n      }\r\n      \r\n      var newItem = itemFactory.createItem(itemType, rowNum, p);\r\n      itemFactory.initItem(newItem);\r\n      itemCategory.setItemCategory(newItem);\r\n      newItem.gemSlot = item.gemSlot;\r\n\r\n      var usePartDnt = null;\r\n      if(newItem.typeName != 'weapons' && newItem.typeId != 0) {\r\n        usePartDnt = 'partsDnt';\r\n      }\r\n      else {\r\n        usePartDnt = 'weaponDnt';\r\n      }\r\n\r\n      if(usePartDnt) {\r\n        if(dntData.isLoaded(itemType[usePartDnt]) && dntData.isLoaded(itemType.setDnt)) {\r\n          newItem.setStats = [];\r\n          var parts = dntData.find(itemType[usePartDnt], 'id', item.id);\r\n          if(parts.length > 0) {\r\n            newItem.setId = parts[0].SetItemID;\r\n            var sets = dntData.find(itemType.setDnt, 'id', parts[0].SetItemID);\r\n            if(sets.length > 0) {\r\n              newItem.setStats = hCodeValues.getStats(sets[0]);\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      newItem.fullStats = newItem.stats;\r\n      if(item.enchantmentNum >= 0) {\r\n        newItem.enchantmentNum = item.enchantmentNum;\r\n        \r\n        if(newItem.typeName == 'skills') {\r\n          // would this even happen?\r\n        }\r\n        else if(newItem.typeName == 'talisman') {\r\n          var extraStats = [];\r\n          angular.forEach(newItem.stats, function(stat, index) {\r\n            extraStats.push({id: stat.id, max: stat.max * (newItem.enchantmentNum/100)});\r\n          });\r\n          \r\n          newItem.enchantmentStats = extraStats;\r\n        }\r\n        else if(itemType.enchantDnt) {\r\n          var enchantments = dntData.find(itemType.enchantDnt, 'EnchantID', newItem.enchantmentId);\r\n          if(!enchantments.length && itemType.enchantDnt2) {\r\n            enchantments = dntData.find(itemType.enchantDnt2, 'EnchantID', newItem.enchantmentId);\r\n          }\r\n\r\n          angular.forEach(enchantments, function(enchantment, index) {\r\n            if(enchantment.EnchantLevel == newItem.enchantmentNum) {\r\n              newItem.enchantmentStats = hCodeValues.getStats(enchantment);\r\n            }\r\n          });\r\n        }\r\n        else if(itemType.petLevelDnt) {\r\n          var petLevels = dntData.find(itemType.petLevelDnt, 'PetLevelTypeID', newItem.enchantmentId);\r\n          angular.forEach(petLevels, function(enchantment, index) {\r\n            if(enchantment.PetLevel == newItem.enchantmentNum) {\r\n              newItem.enchantmentStats = hCodeValues.getStats(enchantment);\r\n            }\r\n          });\r\n        }\r\n      }\r\n\r\n      if(newItem.enchantmentStats) {\r\n        newItem.fullStats = hCodeValues.mergeStats(newItem.enchantmentStats, newItem.stats);\r\n      }\r\n      \r\n      if(item.sparkId > 0) {\r\n        newItem.sparkId = item.sparkId;\r\n        var sparks = dntData.find(itemType.sparkDnt, 'id', item.sparkId);\r\n        if(sparks.length > 0) {\r\n          newItem.sparkStats = hCodeValues.getStats(sparks[0]);\r\n          newItem.fullStats = hCodeValues.mergeStats(newItem.fullStats, newItem.sparkStats);\r\n        }\r\n      }\r\n      else if(newItem.dragonjeweltype) {\r\n        newItem.offensiveGemSlots = 0;\r\n        newItem.increasingGemSlots = 0;\r\n        var itemData = dntData.find('dragonjewelslottable.lzjson', 'DragonJewelID', newItem.dragonjeweltype);\r\n        if(itemData && itemData.length > 0) {\r\n          if(itemData[0].DragonJewelSlot1 == 1) newItem.offensiveGemSlots++;\r\n          if(itemData[0].DragonJewelSlot2 == 1) newItem.offensiveGemSlots++;\r\n          if(itemData[0].DragonJewelSlot3 == 1) newItem.offensiveGemSlots++;\r\n          if(itemData[0].DragonJewelSlot4 == 1) newItem.offensiveGemSlots++;\r\n          \r\n          if(itemData[0].DragonJewelSlot1 == 2) newItem.increasingGemSlots++;\r\n          if(itemData[0].DragonJewelSlot2 == 2) newItem.increasingGemSlots++;\r\n          if(itemData[0].DragonJewelSlot3 == 2) newItem.increasingGemSlots++;\r\n          if(itemData[0].DragonJewelSlot4 == 2) newItem.increasingGemSlots++;\r\n        }\r\n      }\r\n      \r\n      return newItem;\r\n    },\r\n    \r\n    reloadItem: function(item) {\r\n\r\n      if(item == null) {\r\n        // console.log('cannot reload null item');\r\n        return;\r\n      }\r\n      \r\n      // support for old property name\r\n      if('itemTypeName' in item && !item.itemSource) {\r\n        item.itemSource = item.itemTypeName;\r\n      }\r\n      \r\n      // console.log('checking ' + item.itemSource)\r\n      if(item.itemSource == 'rbTech') {\r\n        item.itemSource = 'tech';\r\n        // console.log('changed to ' + item.itemSource)\r\n      }\r\n      \r\n      if(item.itemSource == 'custom' || item.typeName == 'custom') {\r\n        item.typeName = 'custom';\r\n        return item;\r\n      }\r\n      else if(item.itemSource == 'skills' || item.typeName == 'skills') {\r\n        return this.reloadSkill(item);\r\n      }\r\n      else if(item.itemSource in items) {\r\n        var itemType = items[item.itemSource];\r\n        var ds = dntData.findFast(itemType.mainDnt, 'id', item.id);\r\n        if(ds.length) {\r\n          return this.reloadSourceItem(item);\r\n        }\r\n      }\r\n      \r\n      if(item.fileName) {\r\n        var datas = dntData.findFast(item.fileName + '.lzjson', 'id', item.id);\r\n        if(datas.length > 0) {\r\n          var row = datas[0];\r\n          var d = dntData.getRow(item.fileName + '.lzjson', row);\r\n          var newItem = itemFactory.createBasicItem(d);\r\n          newItem.row = row;\r\n          newItem.needJobClass = d.NeedJobClass;\r\n          newItem.exchangeType = d.ExchangeType;\r\n          newItem.fileName = item.fileName;\r\n          newItem.gemSlot = item.gemSlot;\r\n          newItem.description = translations.translate(d.DescriptionID, d.DescriptionIDParam);\r\n          itemFactory.initItem(newItem);\r\n          return newItem;\r\n        }\r\n        else {\r\n          return {name: 'unknown item'};\r\n        }\r\n      }\r\n      else {\r\n        return {name: 'unknown item source: ' + item.itemSource};\r\n      }\r\n    },\r\n    \r\n    getDntFiles: function(item) {\r\n      if(item == null) {\r\n        return {};\r\n      }\r\n\r\n      var dntFiles = {};\r\n      if(!item.itemSource && item.itemTypeName in items) {\r\n        item.itemSource = item.itemTypeName;\r\n      }\r\n      \r\n      if(item.itemSource == 'rbTech') {\r\n        item.itemSource = 'tech';\r\n      }\r\n      \r\n      if(item.itemSource in items) {\r\n        var itemType = items[item.itemSource];\r\n        \r\n        dntFiles['exchange.lzjson'] = null;\r\n        dntFiles[itemType.mainDnt] = itemColumnsToLoad.mainDnt;\r\n        \r\n        for(var fileType in itemType) {\r\n          if(fileType.indexOf('Dnt') > 0) {\r\n            if(fileType != 'enchantDnt' || fileType != 'enchantDnt2' || item.enchantmentNum) {\r\n              dntFiles[itemType[fileType]] = itemColumnsToLoad[fileType];\r\n            }\r\n          }\r\n        }\r\n      }\r\n      \r\n      if(item.itemSource == 'skills' || item.typeName == 'skills') {\r\n          var skillDnt = 'skilltable_character' + item.baseJobName + '.lzjson';\r\n          dntFiles[skillDnt] = null;\r\n          var skillLevelDnt = 'skillleveltable_character' + item.baseJobName + 'pve' + '.lzjson';\r\n          dntFiles[skillLevelDnt] = null;\r\n          skillLevelDnt = 'skillleveltable_character' + item.baseJobName + 'pvp' + '.lzjson';\r\n          dntFiles[skillLevelDnt] = null;\r\n      }\r\n      \r\n      if(item.fileName) {\r\n        dntFiles[item.fileName + '.lzjson'] = null;\r\n      }\r\n    \r\n      return dntFiles;\r\n    }\r\n  };\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('groupHelper', ['exportLinkHelper',groupHelper]);\r\nfunction groupHelper(exportLinkHelper) {\r\n  'use strict';\r\n  \r\n  return {\r\n    reloadGroup: function(groupName, group) {\r\n      var newItems = [];\r\n      angular.forEach(group.items, function(item, key) {\r\n        var newItem = exportLinkHelper.reloadItem(item);\r\n        if(newItem) {\r\n          newItems.push(newItem);\r\n        }\r\n      });\r\n      \r\n      return newItems;\r\n    },\r\n    \r\n    getDntFiles: function(group) {\r\n\r\n      var allDntFiles = {};\r\n      angular.forEach(group.items, function(item, key1) {\r\n        \r\n        var dntFiles = exportLinkHelper.getDntFiles(item);\r\n\r\n        angular.forEach(dntFiles, function(value, key) {\r\n          allDntFiles[key] = value;\r\n        });\r\n      });\r\n      \r\n      return allDntFiles;\r\n    }\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('itemCategory',\r\n['itemFactory','items','dntData',itemCategory]);\r\nfunction itemCategory(itemFactory,items,dntData) {\r\n\r\n  return {\r\n    categories: [\r\n      {path: 'everything', name:'everything', searchType: 'everything', hideInBuild: true},\r\n      {path: 'titles', name:'titles', sourceType: 'titles', hideRank: true, hideJob: true, hideLevel: true, numItemText: '1', maxCat: 1},\r\n      {path: 'weapons', name:'weapons', sourceType: 'equipment', numItemText: '2', maxExchange: 1, maxCat: 2, limitExchange: [1,2]},\r\n      {path: 'armour', name:'armour', sourceType: 'equipment', numItemText: '5', maxExchange: 1, maxCat: 5, limitExchange: [3,4,5,6,7]},\r\n      {path: 'accessories', name:'accessories', sourceType: 'equipment', hideJob: true, maxCat: 4, maxExchange: 2, limitExchange: [8,9,10], tId: 7604},\r\n      {path: 'techs', name:'techs', sourceType: 'techs', maxCat: 4, maxExchange: 2, limitExchange: [8,9,10], hideJob: true},\r\n      {path: 'offensive-gems', name:'offensive gems', sourceType: 'gems', hideJob: true, maxCat: 4, maxExchange: 4, limitExchange: [54], limitGemType: 1},\r\n      {path: 'increasing-gems', name:'increasing gems', sourceType: 'gems', hideJob: true, maxCat: 14, maxExchange: 14, limitExchange: [54], limitGemType: 2},\r\n      {path: 'enhancement-plates', name:'enhancement plates', sourceType: 'plates', hideJob: true, numItemText: '8+3', maxCat: 11, maxExchange: 15, limitExchange: [33], limitRank: [0,1,2,3]},\r\n      {path: 'expedition-plates', name:'expedition plates', sourceType: 'plates', hideRank: true, hideJob: true, numItemText: '4', maxCat: 4, maxExchange: 15, limitExchange: [33], limitRank: [4,5]},\r\n      {path: 'talisman', name:'talisman', sourceType: 'talisman', hideJob: true, numItemText: '8+4', maxCat: 12, maxExchange: 12, limitExchange: [52,53], tId: 1000054149},\r\n      {path: 'costume', name:'costume', sourceType: 'cash', numItemText: '7', maxCat: 7, maxExchange: 1, hideLevel: true, limitExchange: [16,17,18,19,20,21,22], tId: 7607},\r\n      {path: 'imprint', name:'imprint', sourceType: 'imprint', numItemText: '7', maxCat: 7, hideLevel: true, hideJob: true, tId: 1000108314},\r\n      {path: 'cash', name:'cash', sourceType: 'cash', numItemText: '8', maxCat: 8, maxExchange: 2, hideJob: true, hideLevel: true, limitExchange: [23,24,25,26,27,28,29], tId: 7608},\r\n      {path: 'extras', name:'extras', sourceType: 'xtras', limitExchange: [47], hideJob: true, hideLevel: true, tId: 4504},\r\n      {path: 'skills', name:'skills', searchType: 'skills'},\r\n      {path: 'custom', name:'custom', searchType: 'custom', hideInSearch: true},\r\n      ],\r\n      \r\n    byName: function(name) {\r\n      var retVal = null;\r\n      angular.forEach(this.categories, function(category, index) {\r\n        if(category.name == name) {\r\n          retVal = category;\r\n        }\r\n      });\r\n      \r\n      return retVal;\r\n    },\r\n      \r\n    byPath: function(name) {\r\n      var retVal = null;\r\n      angular.forEach(this.categories, function(category, index) {\r\n        if(category.path == name) {\r\n          retVal = category;\r\n        }\r\n      });\r\n      \r\n      return retVal;\r\n    },\r\n    \r\n    getItems: function(name) {\r\n      var cat = this.byName(name);\r\n      if(cat && 'sourceType' in cat) {\r\n        var retVal = [];\r\n        angular.forEach(items, function(source, sourceName) {\r\n          if(source.type == cat.sourceType && retVal) {\r\n            if(!source.items && !source.loading) {\r\n              itemFactory.loadItems(source);\r\n            }\r\n            \r\n            if(source.items) {\r\n              retVal = retVal.concat(source.items);\r\n            }\r\n            else {\r\n              retVal = null; // if any are null just return null\r\n            }\r\n          }\r\n        });\r\n        \r\n        var catItems = [];\r\n        if(retVal) {\r\n          var vm = this;\r\n          angular.forEach(retVal, function(item, index) {\r\n            if(item.typeName == name) {\r\n              catItems.push(item);\r\n            }\r\n            else if(vm.isItemForCat(cat, item, item.data)) {\r\n              item.typeName = name;\r\n              catItems.push(item);\r\n            }\r\n          });\r\n        }\r\n        \r\n        return catItems;\r\n      }\r\n      else {\r\n        return null;\r\n      }\r\n    },\r\n    \r\n    isItemForCat: function(cat, item) {\r\n\r\n      if(!(item.itemSource in items)) {\r\n        return false;\r\n      }\r\n      \r\n      if(items[item.itemSource].type != cat.sourceType) {\r\n        return false;\r\n      }\r\n      \r\n      if(item.itemType == cat.name) {\r\n        return true;\r\n      }\r\n      \r\n      var anyMatch;\r\n      if(cat.limitExchange) {\r\n        anyMatch = false;\r\n        for(var i=0;i<cat.limitExchange.length;++i) {\r\n          if(cat.limitExchange[i] == item.exchangeType || (item.rawData && cat.limitExchange[i] == item.rawData.ExchangeType)) {\r\n            anyMatch = true;\r\n          }\r\n        }\r\n\r\n        if(!anyMatch) {\r\n          return false;\r\n        }\r\n      }\r\n\r\n      if(cat.limitRank) {\r\n        anyMatch = false;\r\n        for(var i=0;i<cat.limitRank.length;++i) {\r\n          if((item.rank && cat.limitRank[i] == item.rank.id) || (item.rawData && cat.limitRank[i] == item.rawData.Rank)) {\r\n            anyMatch = true;\r\n          }\r\n        }\r\n\r\n        if(!anyMatch) {\r\n          return false;\r\n        }\r\n      }\r\n\r\n      if(cat.limitGemType) {\r\n        var gemTypes = dntData.find(items.gem.gemDnt, 'id', item.id);\r\n        if(gemTypes.length > 0) {\r\n          \r\n          if(gemTypes[0].Type != cat.limitGemType) {\r\n            return false;\r\n          }\r\n        }\r\n      }\r\n      \r\n      return true;\r\n    },\r\n    \r\n    init: function(name, complete) {\r\n      var cat = this.byName(name);\r\n      if(cat && 'sourceType' in cat) {\r\n        var sources = _.filter(items, function(source) {\r\n          return (source.type == cat.sourceType);\r\n        });\r\n\r\n        var numComplete = 0;\r\n        _.each(sources, function(source) {\r\n          source.init(function() {}, function() {\r\n              numComplete++;\r\n              if(numComplete == sources.length) {\r\n                complete();\r\n              }\r\n          });\r\n        });\r\n      }\r\n    },\r\n    \r\n    setItemCategory: function (item, rawData) {\r\n      var vm = this;\r\n      \r\n      angular.forEach(this.categories, function(cat, index) {\r\n        if(vm.isItemForCat(cat, item, rawData)) {\r\n          item.typeName = cat.name;\r\n        }\r\n      });\r\n    },\r\n    \r\n    getItemsByCategory: function(items) {\r\n      var itemMap = {};\r\n      if(items) {\r\n        var types = {};\r\n        angular.forEach(items, function(item, index) {\r\n          if(item) {\r\n            if(!(item.typeName in types)) {\r\n              types[item.typeName] = [];\r\n            }\r\n            types[item.typeName].push(item);\r\n          }\r\n        });\r\n        \r\n        angular.forEach(this.categories, function(category, index) {\r\n\r\n          if(category.name in types) {\r\n            \r\n            var sorted = types[category.name].sort(function(item1, item2) {\r\n              if(category.name == 'talisman') {\r\n                \r\n                var enh1 = item1.enchantmentNum;\r\n                if(!enh1) enh1 = 0;\r\n                var enh2 = item2.enchantmentNum;\r\n                if(!enh2) enh2 = 0;\r\n                \r\n                if(enh1 != enh2) {\r\n                  return enh2 - enh1;\r\n                }\r\n              }\r\n              else if(item1.itemSource == 'gem' || item1.itemSource == 'plate') {\r\n                if(item1.gemSlot || item2.gemSlot) {\r\n                  if(!item1.gemSlot) {\r\n                    return 1;\r\n                  }\r\n                  else if(!item2.gemSlot) {\r\n                    return -1;\r\n                  }\r\n                  return item1.gemSlot - item2.gemSlot;\r\n                }\r\n                else if(item2.levelLimit != item1.levelLimit) {\r\n                  return item2.levelLimit - item1.levelLimit;\r\n                }\r\n              }\r\n              else if('exchangeType' in item1 && 'exchangeType' in item2) {\r\n                return item1.exchangeType - item2.exchangeType;\r\n              }\r\n              \r\n              return item1.name.localeCompare(item2.name);\r\n            });\r\n            itemMap[category.name] = sorted;\r\n          }\r\n          else {\r\n            itemMap[category.name] = [];\r\n          }\r\n        });\r\n        \r\n        /*\r\n        angular.forEach(items, function(item, index) {\r\n          if(item && !(item.typeName in itemMap)) {\r\n            // console.log('we dont know ' + item.typeName + ' anymore')\r\n            itemMap.typeError = true;\r\n          }\r\n        });\r\n        */\r\n      }\r\n      return itemMap;\r\n    },\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('excludeService', excludeService);\r\n\r\nfunction excludeService() {\r\n return {\r\n     ids: [{\r\n            name: 'unbound plates',\r\n            min: 0,\r\n            max: 0\r\n        }\r\n     ],\r\n };\r\n}\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('itemFactory',itemFactory);\r\n\r\nfunction itemFactory(translations,dntData,hCodeValues,items) {\r\n  \r\n  return {\r\n    loadItems: loadItems,\r\n    initItem: initItem,\r\n    createItem: createItem,\r\n    getItemData: getItemData,\r\n    createBasicItem: createBasicItem,\r\n  };\r\n  \r\n  function createItem(itemType, row, p) {\r\n    \r\n    // data and potential are used to initialise name and stats\r\n    // this is only done when needed\r\n    // they are then removed from the object\r\n    return {\r\n      row: row,\r\n      potential : p,\r\n      id: dntData.getValue(itemType.mainDnt, row, 'id'),\r\n      itemSource : itemType.name,\r\n      levelLimit : dntData.getValue(itemType.mainDnt, row, 'LevelLimit'),\r\n      needJobClass : dntData.getValue(itemType.mainDnt, row, 'NeedJobClass'),\r\n      typeId : dntData.getValue(itemType.mainDnt, row, 'Type'),\r\n      exchangeType: dntData.getValue(itemType.mainDnt, row, 'ExchangeType'),\r\n      rank : hCodeValues.rankNames[dntData.getValue(itemType.mainDnt, row, 'Rank')],\r\n      pid: null,\r\n      name : null,\r\n      stats : null,\r\n      potentialRatio : null,\r\n      typeName : null,\r\n      sparkId: null,\r\n    };\r\n  }\r\n\r\n  function isDataLoaded(itemType) {\r\n    \r\n    if(!dntData.isLoaded(itemType.mainDnt)) {\r\n      return false;\r\n    }\r\n    \r\n    if(!translations.isLoaded()) {\r\n      return false;\r\n    }\r\n    \r\n    if('potentialDnt' in itemType && !dntData.isLoaded(itemType.potentialDnt)) {\r\n      return false;\r\n    }\r\n    \r\n    if('potentialDntEx' in itemType && !dntData.isLoaded(itemType.potentialDntEx)) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n\r\n  }\r\n  \r\n  function loadItems(itemType) {\r\n\r\n    if(!isDataLoaded(itemType)) {\r\n      return null;\r\n    }\r\n    \r\n    var start = new Date().getTime();\r\n    \r\n    itemType.items = [];\r\n    var numRows = dntData.getNumRows(itemType.mainDnt);\r\n    for(var r=0;r<numRows;++r) {\r\n      var dType = dntData.getValue(itemType.mainDnt, r, 'Type');\r\n\r\n      var state1Max = dntData.getValue(itemType.mainDnt, r, 'State1_Max');\r\n      var dStateValue1 = dntData.getValue(itemType.mainDnt, r, 'StateValue1');\r\n      var dTypeParam1 = dntData.getValue(itemType.mainDnt, r, 'TypeParam1');\r\n        \r\n      // skip items with no data\r\n      if(state1Max > 0 || dStateValue1 > 0 || dTypeParam1 > 0 || dType == 35) {        \r\n        var potentials = [];\r\n        if(dTypeParam1 > 0 && 'potentialDnt' in itemType) {\r\n          potentials = dntData.find(itemType.potentialDnt, 'PotentialID', dTypeParam1);\r\n          \r\n          if(!potentials.length && 'potentialDntEx' in itemType) {\r\n            potentials = dntData.find(itemType.potentialDntEx, 'PotentialID', dTypeParam1);\r\n          }\r\n        }\r\n        \r\n        var numPotentials = potentials.length;\r\n        if(!numPotentials) {\r\n          potentials = [null];\r\n          numPotentials = 1;\r\n        }\r\n\r\n        for(var p=0;p<numPotentials;++p) {\r\n          var found = false;          \r\n          if(!found) {\r\n            itemType.items.push(createItem(itemType, r, potentials[p], 0));\r\n          }\r\n        }\r\n      }\r\n    }\r\n            \r\n    var end = new Date().getTime();\r\n    var time = end - start;\r\n    console.log('item init time: ' + (time/1000) + 's for ' + itemType.name);\r\n  }\r\n  \r\n  function initItem(item) {\r\n    \r\n    if(item.row >= 0) {\r\n      var d;\r\n      if(item.itemSource && item.itemSource in items) {\r\n        d = dntData.getRow(items[item.itemSource].mainDnt, item.row);\r\n      }\r\n      else if(item.fileName) {\r\n        d = dntData.getRow(item.fileName + '.lzjson', item.row);\r\n      }\r\n      delete item.row;\r\n\r\n      var p = item.potential;\r\n  \r\n      if(item.name == null) {\r\n        item.name = translations.translate(d.NameID, d.NameIDParam);\r\n      }\r\n      \r\n      if(!item.sparkTypeId && d.TypeParam2 > 0) {\r\n        item.sparkTypeId = d.TypeParam2;\r\n      }\r\n      \r\n      if(item.stats == null) {\r\n        var stats = hCodeValues.getStats(d);\r\n        if(p) {\r\n          var potentialStats = hCodeValues.getStats(p);\r\n          stats = hCodeValues.mergeStats(stats, potentialStats);\r\n        }\r\n        \r\n        item.stats = stats;\r\n      }\r\n      \r\n      if(d.SkillID && !item.skillId) {\r\n        item.skillId = d.SkillID;\r\n      }\r\n      \r\n      if(item.iconIndex == null) {\r\n        item.icon = d.IconImageIndex;\r\n        if(!item.icon && item.itemSource == 'title') {\r\n          item.icon = 12417;\r\n        }\r\n      }\r\n      \r\n      if(d.dragonjeweltype >= 0) {\r\n        item.dragonjeweltype = d.dragonjeweltype;\r\n      }\r\n      \r\n      if(d.EnchantID && !item.enchantmentId) {\r\n        item.enchantmentId = d.EnchantID;\r\n      }\r\n      \r\n      if(d.EnchantID && !item.enchantmentId) {\r\n        item.enchantmentId = d.EnchantID;\r\n      }\r\n      else if(d.Type == 35) {\r\n        item.itemSource = 'xtras';\r\n        var itemType = items[item.itemSource];\r\n        if(itemType) {\r\n          // item.fileName = itemType.mainDnt;\r\n          var petData = dntData.find(itemType.petDnt, 'id', d.id);\r\n          if(petData && petData.length) {\r\n            item.enchantmentId = petData[0].PetLevelTypeID;\r\n          }\r\n        }\r\n      }\r\n      \r\n      if(p) {\r\n        item.pid = p.id;\r\n      }\r\n      \r\n      delete item.potential;\r\n    }\r\n  }\r\n  \r\n  function getItemData(item) {\r\n    var itemType = items[item.itemSource];\r\n    \r\n    if(item.fileName && dntData.isLoaded(item.fileName + '.lzjson')) {\r\n      var result = getItemDataFromFile(item.fileName + '.lzjson', item);\r\n      if(result) {\r\n        return result;\r\n      }\r\n    }\r\n    \r\n    if(item.fileName && dntData.isLoaded(item.fileName + '.optimised.json')) {\r\n      var result = getItemDataFromFile(item.fileName + '.optimised.json', item);\r\n      if(result) {\r\n        return result;\r\n      }\r\n    }\r\n    \r\n    if(itemType && dntData.isLoaded(itemType.mainDnt)) {\r\n      var result = getItemDataFromFile(itemType.mainDnt, item);\r\n      if(result) {\r\n        return result;\r\n      }\r\n    }\r\n    \r\n    return [];\r\n  }\r\n  \r\n  function getItemDataFromFile(fileName, item) {\r\n    if(fileName) {\r\n      var itemData = dntData.find(fileName, 'id', item.id);\r\n      if(itemData && itemData.length > 0) {\r\n        return itemData[0];\r\n      }\r\n    }\r\n    \r\n    return null;\r\n  }\r\n  \r\n  function createBasicItem(d) {\r\n    if(!d) {\r\n      return [];\r\n    }\r\n    return {\r\n      id: d.id,\r\n      name: translations.translate(d.NameID, d.NameIDParam),\r\n      rank: hCodeValues.rankNames[d.Rank],\r\n      icon: d.IconImageIndex,\r\n      levelLimit : d.LevelLimit,\r\n      fileName: d.fileName,\r\n      typeId: d.Type\r\n    };\r\n  }\r\n}\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('items',\r\n['translations','dntData','itemColumnsToLoad',items]);\r\nfunction items(translations,dntData,itemColumnsToLoad) {\r\n  \r\n  var itemSources = {\r\n    \r\n      title : {\r\n        mainDnt: 'appellationtable.optimised.json', \r\n        type: 'titles', \r\n        minLevel: 0, \r\n        minRank: 0 },\r\n      // wspr: { mainDnt: 'itemtable_source.dnt', type: 'wellspring', minLevel: 24 },\r\n      \r\n      tech: { \r\n        mainDnt: 'itemtable_skilllevelup.optimised.json', \r\n        potentialDnt: 'potentialtable.optimised.json',\r\n        potentialDntEx: 'potentialtable_reboot.optimised.json',\r\n        sparkDnt: 'potentialtable_potentialjewel.optimised.json',\r\n        gemSlotDnt: 'dragonjewelslottable.lzjson',\r\n        type: 'techs', \r\n        minLevel: 60,\r\n        minRank: 0},\r\n      \r\n      tman: { \r\n        mainDnt: 'itemtable_talisman.optimised.json', \r\n        type: 'talisman', \r\n        potentialDnt: 'potentialtable_talismanitem.optimised.json',\r\n        minLevel: 24,\r\n        minRank: 0 },\r\n      \r\n      gem: { \r\n        mainDnt: 'itemtable_dragonjewel.optimised.json', \r\n        potentialDnt: 'potentialtable_dragonjewel.optimised.json',\r\n        potentialDntEx: 'potentialtable_reboot.optimised.json',\r\n        enchantDnt: 'enchanttable_dragonjewel.optimised.json', \r\n        gemDnt: 'dragonjeweltable.optimised.json',\r\n        type: 'gems',\r\n        minLevel: 24,\r\n        minRank: 3},\r\n      \r\n      plate: { \r\n        mainDnt : 'itemtable_glyph.optimised.json', \r\n        potentialDnt: 'potentialtable_glyph.optimised.json',\r\n        type: 'plates',\r\n        minLevel: 16,\r\n        minRank: 2 },\r\n      plate95: { \r\n        mainDnt : 'itemtable_glyph95.lzjson', \r\n        potentialDnt: 'potentialtable_glyph95.lzjson',\r\n        type: 'plates',\r\n        minLevel: 1,\r\n        minRank: 1,\r\n        ignoreErrors: true },\r\n\r\n      items: {\r\n        mainDnt: 'itemtable.optimised.json', \r\n        partsDnt: 'partstable.optimised.json', \r\n        weaponDnt: 'weapontable.optimised.json', \r\n        enchantDnt: 'enchanttable.optimised.json', \r\n        potentialDnt: 'potentialtable.optimised.json',\r\n        setDnt: 'setitemtable.optimised.json',\r\n        gemSlotDnt: 'dragonjewelslottable.lzjson',\r\n        type: 'equipment',\r\n        minLevel: 80,\r\n        minRank: 3 },\r\n      eq: {\r\n        mainDnt: 'itemtable_equipment.optimised.json', \r\n        partsDnt: 'partstable_equipment.optimised.json', \r\n        weaponDnt: 'weapontable_equipment.optimised.json', \r\n        enchantDnt: 'enchanttable.optimised.json', \r\n        potentialDnt: 'potentialtable.optimised.json',\r\n        sparkDnt: 'potentialtable_potentialjewel.optimised.json',\r\n        setDnt: 'setitemtable.optimised.json',\r\n        gemSlotDnt: 'dragonjewelslottable.lzjson',\r\n        type: 'equipment',\r\n        minLevel: 21,\r\n        minRank: 3 },\r\n      rbeq: { \r\n        mainDnt: 'itemtable_reboot.optimised.json', \r\n        partsDnt: 'partstable_reboot.optimised.json', \r\n        weaponDnt: 'weapontable_reboot.optimised.json', \r\n        enchantDnt: 'enchanttable_reboot.optimised.json',\r\n        enchantDnt2: 'enchanttable_95.lzjson',\r\n        potentialDnt: 'potentialtable_reboot.optimised.json',\r\n        setDnt: 'setitemtable.optimised.json',\r\n        gemSlotDnt: 'dragonjewelslottable.lzjson',\r\n        type: 'equipment',\r\n        minLevel: 24,\r\n        minRank: 3 },\r\n      pvpeq: { \r\n        mainDnt: 'itemtable_pvp.optimised.json',\r\n        partsDnt: 'partstable_pvp.optimised.json', \r\n        weaponDnt: 'weapontable_pvp.optimised.json', \r\n        enchantDnt: 'enchanttable.optimised.json', \r\n        setDnt: 'setitemtable.optimised.json',\r\n        type: 'equipment',\r\n        gemSlotDnt: 'dragonjewelslottable.lzjson',\r\n        minLevel: 24,\r\n        minRank: 3 },\r\n\r\n      cCommon: {\r\n        mainDnt: 'itemtable_commoncash.lzjson', \r\n        partsDnt: 'partstable_commoncash.lzjson', \r\n        weaponDnt: 'weapontable_commoncash.lzjson', \r\n        setDnt: 'setitemtable_cash.lzjson',\r\n        type: 'cash',\r\n        minLevel: 0,\r\n        ignoreErrors: true,\r\n        minRank: 4 },\r\n      cClone: {\r\n        mainDnt: 'itemtable_cashclone.optimised.json',\r\n        partsDnt: 'partstable_cashclone.optimised.json',\r\n        type: 'cash',\r\n        minLevel: 0,\r\n        ignoreErrors: true,\r\n        minRank: 4 },\r\n      c2016: { \r\n        mainDnt: 'itemtable_common2016.optimised.json', \r\n        partsDnt: 'partstable_common2016.optimised.json', \r\n        weaponDnt: 'weapontable_common2016.optimised.json', \r\n        setDnt: 'setitemtable_cash.optimised.json',\r\n        type: 'cash',\r\n        minLevel: 0,\r\n        minRank: 0 },\r\n      c2017: { \r\n        mainDnt: 'itemtable_common2017.optimised.json', \r\n        partsDnt: 'partstable_common2017.optimised.json', \r\n        weaponDnt: 'weapontable_common2017.optimised.json', \r\n        setDnt: 'setitemtable_cash.optimised.json',\r\n        type: 'cash',\r\n        minLevel: 0,\r\n        ignoreErrors: true,\r\n        minRank: 0 },\r\n      c2015: { \r\n        mainDnt: 'itemtable_common2015.optimised.json', \r\n        partsDnt: 'partstable_common2015.optimised.json', \r\n        weaponDnt: 'weapontable_common2015.optimised.json', \r\n        setDnt: 'setitemtable_cash.optimised.json',\r\n        type: 'cash',\r\n        minLevel: 0,\r\n        minRank: 0 },\r\n      c2014: { \r\n        mainDnt: 'itemtable_common2014.optimised.json', \r\n        partsDnt: 'partstable_common2014.optimised.json', \r\n        weaponDnt: 'weapontable_common2014.optimised.json', \r\n        setDnt: 'setitemtable_cash.optimised.json',\r\n        type: 'cash',\r\n        minLevel: 0,\r\n        minRank: 0 },\r\n      cash: { \r\n        mainDnt: 'itemtable_cash.optimised.json', \r\n        partsDnt: 'partstable_cash.optimised.json', \r\n        weaponDnt: 'weapontable_cash.optimised.json', \r\n        setDnt: 'setitemtable_cash.optimised.json',\r\n        type: 'cash',\r\n        minLevel: 0,\r\n        minRank: 0 },\r\n      event: {\r\n        mainDnt: 'itemtable_event.optimised.json',\r\n        partsDnt: 'partstable_event.optimised.json',\r\n        weaponDnt: 'weapontable_event.optimised.json',\r\n        setDnt: 'setitemtable_cash.optimised.json',\r\n        type: 'cash',\r\n        minLevel: 0,\r\n        minRank: 0 },\r\n      xtras: {\r\n        mainDnt: 'itemtable_vehicle.optimised.json',\r\n        partsDnt: 'vehiclepartstable.optimised.json',\r\n        setDnt: 'setitemtable_cash.optimised.json',\r\n        petDnt: 'vehicletable.lzjson',\r\n        petLevelDnt: 'petleveltable.lzjson', \r\n        type: 'xtras',\r\n        minLevel: 0,\r\n        minRank: 0 },\r\n      imprint: {\r\n        mainDnt: 'itemtable_imprinting.optimised.json',\r\n        type: 'imprint',\r\n        minLevel: 0,\r\n        minRank: 0 },\r\n    };\r\n    \r\n    // now that the sources are set up add some methods on them for initialisation\r\n    // each source will store the items from that source for reuse by searches\r\n    angular.forEach(itemSources, function(itemSource, key) {\r\n      itemSource.name = key;\r\n      itemSource.loading = false;\r\n      itemSource.items = null;\r\n      itemSource.init = init; // decalared below\r\n      itemSource.reset = function() {\r\n        itemSource.items = null;\r\n        itemSource.loading = false;\r\n      };\r\n    });\r\n\r\n    return itemSources;\r\n  \r\n  \r\n    function init(progress, complete) {\r\n      var itemSource = this;\r\n      itemSource.loading = true;\r\n  \r\n      if(itemSource.items) {\r\n        complete();\r\n      }\r\n      else {\r\n        \r\n        translations.init(progress, function() {\r\n          doComplete(itemSource, complete)\r\n        });\r\n        dntData.init(itemSource.mainDnt, itemColumnsToLoad.mainDnt, progress, function() {\r\n          doComplete(itemSource, complete)\r\n        }, itemSource.ignoreErrors);\r\n        if('potentialDnt' in itemSource) {\r\n          dntData.init(itemSource.potentialDnt, itemColumnsToLoad.potentialDnt, progress, function() {\r\n            doComplete(itemSource, complete)\r\n          }, itemSource.ignoreErrors);\r\n        }\r\n        if('potentialDntEx' in itemSource) {\r\n          dntData.init(itemSource.potentialDntEx, itemColumnsToLoad.potentialDnt, progress, function() {\r\n            doComplete(itemSource, complete)\r\n          }, itemSource.ignoreErrors);\r\n        }\r\n        if('gemDnt' in itemSource) {\r\n          dntData.init(itemSource.gemDnt, itemColumnsToLoad.gemDnt, progress, function() {\r\n            doComplete(itemSource, complete)\r\n          }, itemSource.ignoreErrors);\r\n        }\r\n  \r\n        doComplete(itemSource, complete);\r\n      }\r\n    }\r\n    \r\n    function doComplete(itemSource, complete) {\r\n      if(translations.isLoaded() && \r\n      dntData.isLoaded(itemSource.mainDnt) && \r\n      (!('potentialDnt' in itemSource) || dntData.isLoaded(itemSource.potentialDnt) || dntData.hasFailed(itemSource.potentialDnt)) &&\r\n      (!('potentialDntEx' in itemSource) || dntData.isLoaded(itemSource.potentialDntEx) || dntData.hasFailed(itemSource.potentialDntEx)) &&\r\n      (!('gemDnt' in itemSource) || dntData.isLoaded(itemSource.gemDnt) || dntData.hasFailed(itemSource.gemDnt))\r\n      ) {\r\n        complete();\r\n        itemSource.loading = false;\r\n      }\r\n    }\r\n  };\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('jobs', ['dntData', 'translations', 'itemColumnsToLoad', jobs]);\r\nfunction jobs(dntData, translations, itemColumnsToLoad) {\r\n  \r\n  var fileName ='jobtable.lzjson';\r\n  var colsToLoad = itemColumnsToLoad.jobsDnt;\r\n  \r\n  return {\r\n    fileName : fileName,\r\n    allJobs : null,\r\n    \r\n    isLoaded : function() {\r\n      return dntData.isLoaded(fileName);\r\n    },\r\n    \r\n    hasStartedLoading: function() {\r\n      return dntData.hasStartedLoading(fileName);\r\n    },\r\n    \r\n    init : function(progress, complete) {\r\n      dntData.init(fileName, colsToLoad, progress, function() {\r\n        complete();\r\n        }, false);\r\n    },\r\n\r\n    reset : function() {\r\n      this.allJobs = null;\r\n      dntData.reset(fileName);\r\n    },\r\n    \r\n    getFinalJobs : function () {\r\n      var jobs = [];\r\n      var alljobs = this.getAllJobs();\r\n      if(alljobs) {\r\n        var numRows = alljobs.length;\r\n        for(var r=0;r<numRows;++r) {\r\n          if(alljobs[r].d.JobNumber == 2 && alljobs[r].d.JobIcon > 0) {\r\n            jobs.push(alljobs[r]);\r\n          }\r\n        }\r\n      }\r\n      \r\n      return jobs;\r\n    },\r\n    \r\n    getBaseJobs : function () {\r\n      var retVal=[];\r\n      var baseJobs = {};\r\n\r\n      var self = this;\r\n      angular.forEach(this.getFinalJobs(), function(job, key) {\r\n        baseJobs[self.getBaseJobName(job)] = job;\r\n      });\r\n\r\n      angular.forEach(baseJobs, function(job, jobName) {\r\n        retVal.push(jobName);\r\n      });\r\n\r\n      return retVal;\r\n    },\r\n    \r\n    getAllJobs : function () {\r\n      if(this.allJobs == null && this.isLoaded() && translations.isLoaded()) {\r\n        var jobs = [];\r\n        var data = dntData.getData(fileName);\r\n        var numRows = data.length;\r\n        for(var r=0;r<numRows;++r) {\r\n          jobs[jobs.length] = this.createJob(data[r]);\r\n        }\r\n        \r\n        this.allJobs = jobs;\r\n      }\r\n      return this.allJobs;\r\n    },\r\n    \r\n    getById: function(id) {\r\n      var data = this.getAllJobs();\r\n      if(data) {\r\n        var numRows = data.length;\r\n        for(var r=0;r<numRows;++r) {\r\n          if(data[r].id == id) {\r\n            return data[r];\r\n          }\r\n        }\r\n      }\r\n    },\r\n    \r\n    createJob : function(d) {\r\n      var t = this;\r\n      return {\r\n          d : d,\r\n          id : d.id,\r\n          name : translations.translate(d.JobName),\r\n          isClassJob : function(c) {\r\n            return t.isClassJob(d, c);\r\n          }\r\n        };\r\n    },\r\n    \r\n    isClassJob : function (d, c) {\r\n      if(c == 0) return true;\r\n      if(d.id == c) {\r\n        return true;\r\n      }\r\n      \r\n      var parentJob = d.ParentJob;\r\n      \r\n      if(!parentJob) return false;\r\n      if(parentJob == c) return true;\r\n\r\n      var parentJobData = this.getById(parentJob);\r\n      if(parentJobData) {\r\n        return this.isClassJob(parentJobData.d, c);\r\n      }\r\n      \r\n      return false;\r\n    },\r\n    \r\n    getBaseJobName : function(job) {\r\n      if(this.isLoaded()) {\r\n        var alljobs = this.getAllJobs();\r\n        if(alljobs) {\r\n          var numRows = alljobs.length;\r\n          for(var r=0;r<numRows;++r) {\r\n            if(alljobs[r].id == (job.d.BaseClass+1) && alljobs[r].d.EnglishName) {\r\n              return alljobs[r].d.EnglishName;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      \r\n      return null;\r\n    },\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('onlineService', ['$window','$q','hCodeValues',onlineService]);\r\n\r\nfunction onlineService($window, $q, hCodeValues) {\r\n  // console.log('setup online service');\r\n  \r\n  var service = {\r\n    login: login,\r\n    getUser: function() {\r\n      return firebase.auth().currentUser;\r\n    },\r\n    signOut: signOut,\r\n    deleteAccount: deleteAccount,\r\n    \r\n    getUserBuilds: getUserBuilds,\r\n    deleteBuild: deleteBuild,\r\n    saveBuild: saveBuild,\r\n    getBuild: getBuild,\r\n    getClassBuilds: getClassBuilds,\r\n    \r\n    getProfile: getProfile,\r\n    saveProfile: saveProfile,\r\n    \r\n    stripBuildName: stripBuildName\r\n  };\r\n  \r\n  init();\r\n  \r\n  return service;\r\n  \r\n  function init() {\r\n    // console.log('init');\r\n    firebase.initializeApp({\r\n      apiKey: 'AIzaSyC-Mckgho1xAI2SQzsKnpsr2ObDKOhdSrE',\r\n      authDomain: 'dngearsim.firebaseapp.com',\r\n      databaseURL: 'https://dngearsim.firebaseio.com',\r\n      storageBucket: 'dngearsim.appspot.com',\r\n    });\r\n  }\r\n  \r\n  function login() {\r\n    return $q(function(resolve, reject) {\r\n      var auth = firebase.auth();\r\n        \r\n      auth.onAuthStateChanged(function(user) {\r\n        if(user == null) {\r\n          // console.log('redirecting');\r\n          $window.location.href = 'login.html';\r\n        }\r\n        else {\r\n          // console.log('logged in');\r\n          resolve(user);\r\n        }\r\n      });\r\n    });\r\n  }\r\n  \r\n  function getProfile(uid) {\r\n    // console.log('get profile');\r\n    return $q(function(resolve, reject) {\r\n      firebase.database().ref('profile/' + uid).once('value', function(storedProfile) {\r\n        if(storedProfile) {\r\n          resolve(storedProfile.val());\r\n        }\r\n        else {\r\n          resolve({});\r\n        }\r\n      });\r\n    });\r\n  }\r\n  \r\n  function getBuild(uid, buildName) {\r\n    // console.log('get build');\r\n    return $q(function(resolve, reject) {\r\n      firebase.database().ref('builds/' + uid + '/' + stripBuildName(buildName)).once('value', function(storedProfile) {\r\n        if(storedProfile) {\r\n          resolve(decompressBuild(storedProfile.val()));\r\n        }\r\n        else {\r\n          resolve({});\r\n        }\r\n      });\r\n    });\r\n  }\r\n  \r\n  function saveProfile(profile) {\r\n    return $q(function(resolve, reject) {\r\n      var user = service.getUser();\r\n      if(user) {\r\n        profile = angular.copy(profile);\r\n        deleteNullProperties(profile, true);\r\n        firebase.database().ref('profile/' + user.uid).set(profile).then(resolve);\r\n      }\r\n    });\r\n  }\r\n  \r\n  function getUserBuilds(uid) {\r\n    // console.log('get builds');\r\n    return $q(function(resolve, reject) {\r\n      // console.log('getting builds');\r\n      firebase.database().ref('builds/' + uid).once('value', function(storedBuilds) {\r\n        if(storedBuilds) {\r\n          var retVal = {};\r\n          var val = storedBuilds.val();\r\n          for(var buildName in val) {\r\n            retVal[buildName] = decompressBuild(val[buildName]);\r\n          }\r\n          resolve(retVal);\r\n        }\r\n        else {\r\n          resolve({});\r\n        }\r\n      });\r\n    });\r\n  }\r\n  \r\n  function getClassBuilds(job) {\r\n    // console.log('get class builds');\r\n    return $q(function(resolve, reject) {\r\n      // console.log('getting builds', job.id);\r\n      firebase.database().ref('job-builds/' + job.id).once('value', function(jobBuilds) {\r\n        // console.log('ok');\r\n        if(jobBuilds) {\r\n          resolve(jobBuilds.val());\r\n        }\r\n        else {\r\n          resolve({});\r\n        }\r\n      });\r\n    });\r\n  }\r\n  \r\n  function compressBuild(build) {\r\n    \r\n    if(build.items) {\r\n      _.each(build.items, function(item) {\r\n        delete item.fullStats;\r\n      });\r\n    }\r\n    \r\n    var stringifiedData = JSON.stringify(build);\r\n    return LZString.compressToUTF16(stringifiedData);\r\n  }\r\n  \r\n  function decompressBuild(compressedBuild) {\r\n    var stringifiedData = LZString.decompressFromUTF16(compressedBuild);\r\n    var build = JSON.parse(stringifiedData);\r\n    \r\n    if(build.items) {\r\n      _.each(build.items, function(item) {\r\n        item.fullStats = item.stats;\r\n        \r\n        if(item.enchantmentStats && item.enchantmentStats.length) {\r\n          item.fullStats = hCodeValues.mergeStats(item.enchantmentStats, item.fullStats);\r\n        }\r\n        \r\n        if(item.sparkStats && item.sparkStats.length) {\r\n          item.fullStats = hCodeValues.mergeStats(item.sparkStats, item.fullStats);\r\n        }\r\n      });\r\n    }\r\n    \r\n    return build;\r\n  }\r\n  \r\n  function saveBuild(buildName, build) {\r\n    var user = service.getUser();\r\n    var actions = [];\r\n    if(user) {\r\n      build = angular.copy(build);\r\n      deleteNullProperties(build, true);\r\n      // console.log('saving', build);\r\n      actions.push(\r\n        firebase.database().ref('builds/' + user.uid + '/' + stripBuildName(buildName)).set(compressBuild(build))\r\n      );\r\n      \r\n      if(build.job && build.job.id) {\r\n        // console.log('saving build');\r\n          \r\n        var data = {};\r\n        if(build.playerLevel) {\r\n          data.lev = build.playerLevel;\r\n        }\r\n        if(build.region) {\r\n          data.region = build.region;\r\n        }\r\n        if(build.guild) {\r\n          data.guild = build.guild;\r\n        }\r\n        if(build.about) {\r\n          data.about = build.about;\r\n        }\r\n        \r\n        deleteNullProperties(data, true);\r\n          \r\n        actions.push(\r\n          firebase.database().ref('job-builds/' + build.job.id + '/' + user.uid + '/' + stripBuildName(buildName)).set(data)\r\n        );\r\n      }\r\n    }\r\n    return $q.all(actions);\r\n  }\r\n  \r\n  function deleteNullProperties(test, recurse) {\r\n    for (var i in test) {\r\n        if (test[i] === undefined) {\r\n            delete test[i];\r\n        } else if (recurse && typeof test[i] === 'object') {\r\n            deleteNullProperties(test[i], recurse);\r\n        }\r\n    }\r\n  }\r\n  \r\n  function signOut() {\r\n    var auth = firebase.auth();\r\n    return $q(function(resolve, reject) {\r\n      auth.signOut().then(function() {\r\n        resolve();\r\n      }, function(error) {\r\n        reject();\r\n      });\r\n    });\r\n  }\r\n  \r\n  function deleteAccount(builds) {\r\n    var auth = firebase.auth();\r\n    var user = service.getUser();\r\n    \r\n    return $q(function(resolve, reject) {\r\n      \r\n      var pList = [\r\n        firebase.database().ref('builds/' + user.uid).remove(),\r\n        firebase.database().ref('profile/' + user.uid).remove(),\r\n        firebase.database().ref('private/' + user.uid).remove()];\r\n        \r\n      var jobIds = [];\r\n      for(var buildName in builds) {\r\n        if(builds[buildName].job) {\r\n          jobIds.push(builds[buildName].job.id);\r\n        }\r\n      }\r\n      \r\n      jobIds = _.uniq(jobIds);\r\n      _.each(jobIds, function(id) {\r\n        pList.push(\r\n          firebase.database().ref('job-builds/' + id + '/' + user.uid).remove()\r\n        )\r\n      });\r\n        \r\n      $q.all(pList).then(function() {\r\n        // console.log('deleted data');\r\n        user.delete().then(function() {\r\n          // console.log('deleted user');\r\n          auth.signOut().then(function() {\r\n            // console.log('signed out');\r\n            resolve();\r\n          }, function(error) {\r\n            reject();\r\n          });\r\n        });\r\n      });\r\n    });\r\n  }\r\n  \r\n  function deleteBuild(buildName, build) {\r\n    \r\n    var pList = [];\r\n    var user = service.getUser();\r\n    if(user) {\r\n      pList.push(\r\n        firebase.database().ref('builds/' + user.uid + '/' + stripBuildName(buildName)).remove());\r\n      \r\n      if(build.job) {\r\n        pList.push(\r\n          firebase.database().ref('job-builds/' + build.job.id + '/' + user.uid + '/' + stripBuildName(buildName)).remove());\r\n      }\r\n    }\r\n    \r\n    return $q.all(pList);\r\n  }\r\n  \r\n  function stripBuildName(buildName) {\r\n    return buildName.replace(/[.$\\[\\]#\\/]/g, '');\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('quickAddHelper', quickAddHelper);\r\nfunction quickAddHelper(dntData, translations, itemColumnsToLoad, itemCategory,itemFactory,jobs,hCodeValues) {\r\n\r\n  return {\r\n    getItem: getItem,\r\n    findData: findData\r\n  };\r\n  \r\n  function getItem(datas) {\r\n    var item = null;\r\n    for(var d=0;d<datas.length;++d) {\r\n      if(datas[d].def.isItemStep) {\r\n        item = datas[d].value;\r\n      }\r\n    }\r\n    \r\n    for(var d=0;d<datas.length;++d) {\r\n      if(datas[d].def.alterItem) {\r\n        datas[d].def.alterItem(datas[d].value.id, item);\r\n      }\r\n    }\r\n    \r\n    return item;\r\n  }\r\n  \r\n  function findData(category, build, datas, maxItems) {\r\n    if(!maxItems) {\r\n      maxItems = 9999;\r\n    }\r\n    \r\n    var allItems = itemCategory.getItems(category.name);\r\n    var retVal = [];\r\n    var numItems = allItems.length;\r\n\r\n    var sortFunc = null;\r\n    var sortId = null;\r\n    \r\n    for(var i=0;i<numItems;++i) {\r\n      \r\n      var item = allItems[i];\r\n      \r\n      if(!category.hideJob && build.job.id > 0 && item.needJobClass > 0 && !jobs.isClassJob(build.job.d, item.needJobClass)) {\r\n        continue;\r\n      }\r\n      itemFactory.initItem(item);\r\n      \r\n      var addItem = true;\r\n      for(var d=0;d<datas.length;++d) {\r\n        if(!datas[d].def.matchesItem || datas[d].def.matchesItem(datas[d].value.id, item)) {\r\n          if('sortFunc' in datas[d].def) {\r\n            sortFunc = datas[d].def.sortFunc;\r\n            sortId = datas[d].value.id;\r\n          }\r\n        }\r\n        else {\r\n          addItem = false;\r\n          break;\r\n        }\r\n      }\r\n      \r\n      if(addItem) {\r\n        retVal.push(item);\r\n      }\r\n      \r\n      if(retVal.length >= maxItems) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    retVal = filterDuplicates(retVal);\r\n\r\n    retVal = retVal.sort(function(item1, item2) {\r\n      if(sortFunc) {\r\n        return sortFunc(sortId, item1, item2);\r\n      }\r\n      else {\r\n        return item1.name.localeCompare(item2.name);\r\n      }\r\n    });\r\n    \r\n    return retVal;\r\n  }\r\n\r\n  function filterDuplicates(items) {\r\n    var retVal = [];\r\n    for(var i=0;i<items.length;++i) {\r\n        var found = false;\r\n        for(var j=0;j<i;++j) {\r\n            if(areSameItem(items[i], items[j])) {\r\n                found = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(!found) {\r\n            retVal.push(items[i]);\r\n        }\r\n    }\r\n\r\n    return retVal;\r\n  }\r\n\r\n  function areSameItem(item1, item2) {\r\n      if(item1.name != item2.name || item1.stats.length != item2.stats.length || item1.rank != item2.rank || item1.levelLimit != item1.levelLimit) {\r\n          return false;\r\n      }\r\n\r\n      return _.isEqual(item1.stats, item2.stats);\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('quickAdd', quickAdd);\r\nfunction quickAdd(dntData, translations, itemColumnsToLoad, itemCategory,itemFactory,jobs,hCodeValues, quickAddSteps, quickAddHelper) {\r\n\r\n  return {\r\n    categorySteps: {\r\n      titles: ['titleStep'],\r\n      weapons: ['exchangeStep','levelStep','rankStep','itemNameStep','hasStatStep','itemStep','enhanceStep'],\r\n      armour: ['exchangeStep','levelStep','rankStep','itemNameStep','hasStatStep','itemStep','enhanceStep'],\r\n      accessories: ['accExchangeStep','levelStep','rankStep','itemNameStep','hasStatStep','itemStep'],\r\n      techs: ['exchangeStep','levelStep','rankStep','techSkillStep','itemNameStep','hasStatStep','itemStep'],\r\n      'offensive gems': ['levelStep','gemRankStep','itemNameStep','numStatsStep','hasStatStep','itemStep','enhanceStep'],\r\n      'increasing gems': ['levelStep','gemRankStep','itemNameStep','numStatsStep','hasStatStep','itemStep','enhanceStep'],\r\n      'enhancement plates': ['levelStep','rankStep','distinctItemNameStep','numStatsStep','hasStatStep','itemStep'],\r\n      'expedition plates': ['levelStep','distinctItemNameStep','numStatsStep','highStatStep','hasStatStep','itemStep'],\r\n      talisman: ['levelStep','talismanRankStep','distinctItemNameStep','numStatsStep','hasStatStep','itemStep','enhanceTalismanStep'],\r\n      costume: ['exchangeStep','rankStep','itemNameStep','itemStep'],\r\n      imprint: ['rankStep','itemNameStep','highStatStep','itemStep'],\r\n      cash: ['accExchangeStep','rankStep','itemNameStep','itemStep'],\r\n      custom: ['customStep'],\r\n    },\r\n    getOptions: function(category, build, datas) {\r\n      var t = this;\r\n      if(category.name in this.categorySteps) {\r\n        var stepName = this.getStepName(category, datas.length);\r\n        var stepDef = quickAddSteps[stepName];\r\n        var allOptions = stepDef.getOptions(category, build, datas);\r\n        if(stepDef.isItemStep) {\r\n          return allOptions;\r\n        }\r\n        else {\r\n          if(stepDef.minOptions) {\r\n              var unfilteredItems = quickAddHelper.findData(category, build, datas, 50);\r\n          }\r\n\r\n          var newOptions = _.filter(allOptions, function(option) {\r\n            var tempDatas = datas.concat([\r\n              t.createData(option, category, datas.length)\r\n            ]);\r\n\r\n            var items;\r\n            if(stepDef.minOptions) {\r\n              if(allOptions[0] == option) {\r\n                return true;\r\n              }\r\n\r\n              items = quickAddHelper.findData(category, build, tempDatas, 50);\r\n              if(items.length > 0 && items.length < 50) {\r\n                return items.length < unfilteredItems.length;\r\n              }\r\n            }\r\n            else {\r\n              items = quickAddHelper.findData(category, build, tempDatas, 1);\r\n            }\r\n            return items.length;\r\n          });\r\n\r\n          if(stepDef.minOptions && newOptions.length < stepDef.minOptions) {\r\n            return [allOptions[0]];\r\n          }\r\n\r\n          return newOptions;\r\n        }\r\n      }\r\n      else {\r\n        return [];\r\n      }\r\n    },\r\n    hasOptions: function(category, build, datas) {\r\n      if(category.name in this.categorySteps) {\r\n        var stepName = this.getStepName(category, datas.length);\r\n        if(quickAddSteps[stepName].hasOptions) {\r\n          return quickAddSteps[stepName].hasOptions(category, build, datas);\r\n        }\r\n        else {\r\n          return quickAddSteps[stepName].getOptions(category, build, datas).length > 0;\r\n        }\r\n      }\r\n      else {\r\n        return false;\r\n      }\r\n    },\r\n    isValidStepNumber: function(category, stepNumber) {\r\n      return this.categorySteps[category.name].length > stepNumber;\r\n    },\r\n    createData: function(value, category, stepNumber) {\r\n      var stepName = this.getStepName(category, stepNumber);\r\n      var def = quickAddSteps[stepName];\r\n      \r\n      return {\r\n        step: stepName,\r\n        value: value,\r\n        def: def,\r\n      };\r\n    },\r\n    getItem: quickAddHelper.getItem,\r\n    getStepName: function(category, stepNumber) {\r\n      return this.categorySteps[category.name][stepNumber];\r\n    }\r\n  };\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('quickAddSteps', quickAddSteps);\r\nfunction quickAddSteps(dntData, translations, itemColumnsToLoad, itemCategory,itemFactory,jobs,hCodeValues, quickAddHelper) {\r\n\r\n  return {\r\n      exchangeStep: {\r\n        name: 'type',\r\n        getOptions: function(category, build, datas) {\r\n          \r\n          var exchanges = [];\r\n          \r\n          for(var e=0;e<category.limitExchange.length;++e) {\r\n            var exId = category.limitExchange[e];\r\n            \r\n            var numExchange = 0;\r\n            if(build.items) {\r\n              for(var i=0;i<build.items.length;++i) {\r\n                if(build.items[i].exchangeType == exId) {\r\n                  numExchange++;\r\n                }\r\n              }\r\n            }\r\n            \r\n            if(numExchange >= category.maxExchange) {\r\n              continue;\r\n            }\r\n            \r\n            var exchange = dntData.find('exchange.lzjson','ExchangeType',exId);\r\n            var exName = '';\r\n            if(exchange && exchange.length > 0 && exchange[0].NameID > 0) {\r\n              exName = translations.translate(exchange[0].NameID).toLowerCase();\r\n            }\r\n            exchanges.push({id: exId, name: exName.toLowerCase()});\r\n          }\r\n          \r\n          return exchanges;\r\n        },\r\n        matchesItem: function(id, item) {\r\n          return item.exchangeType == id;\r\n        }\r\n      },\r\n      accExchangeStep: {\r\n        name: 'type',\r\n        getOptions: function(category, build, datas) {\r\n          \r\n          var exchanges = [];\r\n          \r\n          for(var e=0;e<category.limitExchange.length;++e) {\r\n            var exId = category.limitExchange[e];\r\n            \r\n            var numExchange = 0;\r\n            for(var i=0;i<build.items.length;++i) {\r\n              if(build.items[i] && build.items[i].exchangeType == exId) {\r\n                numExchange++;\r\n              }\r\n            }\r\n            \r\n            if(exId == 10 || exId == 25) {\r\n              if(numExchange >= 2) {\r\n                continue;\r\n              }\r\n            }\r\n            else {\r\n              if(numExchange >= 1) {\r\n                continue;\r\n              }\r\n            }\r\n            \r\n            var exchange = dntData.find('exchange.lzjson','ExchangeType',exId);\r\n            if(exchange && exchange.length > 0 && exchange[0].NameID > 0) {\r\n              var exName = translations.translate(exchange[0].NameID).toLowerCase();\r\n              \r\n              exchanges.push({id: exId, name: exName.toLowerCase()});\r\n            }\r\n          }\r\n          \r\n          return exchanges;\r\n        },\r\n        matchesItem: function(id, item) {\r\n          return item.exchangeType == id;\r\n        }\r\n      },\r\n      levelStep: {\r\n        name: 'level',\r\n        getOptions: function(category, build, datas) {\r\n          \r\n          return [\r\n          { id: 95, name: 'level 95' },\r\n          { id: 93, name: 'level 93' },\r\n          { id: 90, name: 'level 90' },\r\n          { id: 80, name: 'level 80' },\r\n          { id: 70, name: 'level 70' }, \r\n          { id: 60, name: 'level 60' }, \r\n          { id: 50, name: 'level 50' }, \r\n          { id: 40, name: 'level 40' }, \r\n          { id: 32, name: 'level 32' }, \r\n          { id: 24, name: 'level 24' }, \r\n          ];\r\n        },\r\n        matchesItem: function(id, item) {\r\n          return item.levelLimit == id;\r\n        }\r\n      },\r\n      talismanRankStep: {\r\n        name: 'rank',\r\n        getOptions: function(category, build, datas) {\r\n          \r\n          return [\r\n          { id: 3, name: 'epic' },\r\n          { id: 2, name: 'rare' },\r\n          { id: 999, name: 'quality high grade' },\r\n          { id: 1, name: 'magic' },\r\n          { id: 0, name: 'normal' },\r\n          ];\r\n        },\r\n        matchesItem: function(id, item) {\r\n          itemFactory.initItem(item);\r\n          if(item.name) {\r\n            // todo: change this to use the name id\r\n            var index = Math.max(\r\n              item.name.indexOf('Quality'),\r\n              item.name.indexOf('High Grade'));\r\n              \r\n            if(id == 999) {\r\n              return index === 0;\r\n            }\r\n            else {\r\n              return item.rank && item.rank.id == id && index != 0;\r\n            }\r\n          }\r\n          return false;\r\n        }\r\n      },\r\n      gemRankStep: {\r\n        name: 'rank',\r\n        getOptions: function(category, build, datas) {\r\n          \r\n          return [\r\n          { id: 5, name: 'legendary' },\r\n          { id: 4, name: 'unique' },\r\n          { id: 999, name: 'quality high grade epic' },\r\n          { id: 3, name: 'epic' },\r\n          ];\r\n        },\r\n        matchesItem: function(id, item) {\r\n          itemFactory.initItem(item);\r\n          if(item.name) {\r\n            var index = Math.max(\r\n              item.name.indexOf('Quality'),\r\n              item.name.indexOf('High Grade'));\r\n            if(id == 999) {\r\n              return item.rank && item.rank.id == 3 && index >= 0;\r\n            }\r\n            else {\r\n              return item.rank && item.rank.id == id && index < 0;\r\n            }\r\n          }\r\n          return false;\r\n        }\r\n      },\r\n      rankStep: {\r\n        name: 'rank',\r\n        getOptions: function(category, build, datas) {\r\n          \r\n          var values = [];\r\n          for(var id in hCodeValues.rankNames) {\r\n            values.push(hCodeValues.rankNames[id]);\r\n          }\r\n          return values;\r\n        },\r\n        matchesItem: function(id, item) {\r\n          return item.rank && item.rank.id == id;\r\n        }\r\n      },\r\n      enhanceTalismanStep: {\r\n        name: 'slot',\r\n        getOptions: function(category, build, datas) {\r\n          \r\n          return [\r\n          { id: 100, name: '+100% slot' },\r\n          { id: 75, name: '+75% slot' },\r\n          { id: 25, name: '+25% slot' },\r\n          { id: 0, name: '+0% slot' },\r\n          ];\r\n        },\r\n        alterItem: function(id, item) {\r\n          item.enchantmentNum = id;\r\n        }\r\n      },\r\n      titleStep: {\r\n        name: 'select',\r\n        getOptions: function(category, build, datas) {\r\n          var allTitles = quickAddHelper.findData(category, build, datas, 9999);\r\n          var usefulTitles = [];\r\n          for(var i=0;i<allTitles.length;++i) {\r\n            switch(allTitles[i].id) {\r\n              case 1975: // Manticore Expert\r\n              case 1973: // Returned\r\n              case 1008: // Dark Knight\r\n              case 230: // Miraculous\r\n              case 279: // Provoking\r\n              case 2032: // Sharing Goddess's Grief\r\n              case 2033: // Grief-stricken\r\n              case 1313: // Jakard's Demise\r\n              case 2188: // Teary eyed\r\n              // case 1280: // Dragon Tamer\r\n              // case 339: // Cow Wrangler\r\n                usefulTitles.push(allTitles[i]);\r\n                break;\r\n            }\r\n          }\r\n          \r\n          return usefulTitles;\r\n        },\r\n        hasOptions: function(category, build, datas) {\r\n          return true;\r\n        },\r\n        isItemStep: true,\r\n      },\r\n      enhanceStep: {\r\n        name: 'enhance',\r\n        getOptions: function(category, build, datas) {\r\n          \r\n          var item = quickAddHelper.getItem(datas);\r\n          if(item && item.enchantmentId) {\r\n            return [\r\n            { id: 15, name: 'enhance to +15' },\r\n            { id: 14, name: 'enhance to +14' },\r\n            { id: 13, name: 'enhance to +13' },\r\n            { id: 12, name: 'enhance to +12' },\r\n            { id: 11, name: 'enhance to +11' },\r\n            { id: 10, name: 'enhance to +10' },\r\n            { id: 9, name: 'enhance to +9' },\r\n            { id: 8, name: 'enhance to +8' },\r\n            { id: 7, name: 'enhance to +7' },\r\n            { id: 6, name: 'enhance to +6' },\r\n            { id: 5, name: 'enhance to +5' },\r\n            { id: 4, name: 'enhance to +4' },\r\n            { id: 3, name: 'enhance to +3' },\r\n            { id: 2, name: 'enhance to +2' },\r\n            { id: 1, name: 'enhance to +1' },\r\n            { id: 0, name: 'not enhanced' },\r\n            ];\r\n          }\r\n          else {\r\n            return [{ id: 0, name: 'not enhanced' }];\r\n          }\r\n        },\r\n        alterItem: function(id, item) {\r\n          item.enchantmentNum = id;\r\n        }\r\n      },\r\n      itemStep: {\r\n        name: 'select',\r\n        getOptions: function(category, build, datas) {\r\n          return quickAddHelper.findData(category, build, datas);\r\n        },\r\n        isItemStep: true,\r\n        hideName: true,\r\n      },\r\n      namedItemStep: {\r\n        name: 'select',\r\n        getOptions: function(category, build, datas) {\r\n          return quickAddHelper.findData(category, build, datas);\r\n        },\r\n        isItemStep: true,\r\n      },\r\n      techSkillStep: {\r\n        name: 'skill',\r\n        getOptions: function(category, build, datas) {\r\n          var items = quickAddHelper.findData(category, build, datas, 1);\r\n          \r\n          // eventually show all the skills\r\n          // but for now\r\n          if(items.length > 0) {\r\n            return [{id: items[0].skillId, name: items[0].skillId}];\r\n          }\r\n          else {\r\n            return [];\r\n          }\r\n        },\r\n        matchesItem: function(id, item) {\r\n          return item.skillId == id;\r\n        }\r\n      },\r\n      itemNameStep: {\r\n        name: 'item',\r\n        getOptions: function(category, build, datas) {\r\n          var items = quickAddHelper.findData(category, build, datas);\r\n          var itemNames = {};\r\n          var itemNamesList = [];\r\n          for(var i=0;i<items.length;++i) {\r\n            var name = items[i].name;\r\n            if(!(name in itemNames)) {\r\n              itemNames[name] = true;\r\n              itemNamesList.push({\r\n                id: name,\r\n                name: name,\r\n              });\r\n            }\r\n          }\r\n          \r\n          return itemNamesList;\r\n        },\r\n        matchesItem: function(id, item) {\r\n          return item.name == id;\r\n        },\r\n        isItemStep: true,\r\n      },\r\n      distinctItemNameStep: {\r\n        name: 'item',\r\n        getOptions: function(category, build, datas) {\r\n          var items = quickAddHelper.findData(category, build, datas);\r\n          var itemNames = {};\r\n          var itemNamesList = [];\r\n          \r\n          for(var i=0;i<build.items.length;++i) {\r\n            var item = build.items[i];\r\n            itemNames[item.name] = true;\r\n          }\r\n          \r\n          for(var i=0;i<items.length;++i) {\r\n            var name = items[i].name;\r\n            if(!(name in itemNames)) {\r\n              itemNames[name] = true;\r\n              itemNamesList.push({\r\n                id: name,\r\n                name: name,\r\n              });\r\n            }\r\n          }\r\n          \r\n          return itemNamesList;\r\n        },\r\n        matchesItem: function(id, item) {\r\n          return item.name == id;\r\n        },\r\n        isItemStep: true,\r\n      },\r\n      numStatsStep: {\r\n        name: 'Num Stats',\r\n        getOptions: function(category, build, datas) {\r\n          var items = quickAddHelper.findData(category, build, datas);\r\n          var numStats = {};\r\n          \r\n          for(var i=0;i<items.length;++i) {\r\n            var len = 0;\r\n            for(var j=0;j<items[i].stats.length;++j) {\r\n              var stat = hCodeValues.stats[items[i].stats[j].id];\r\n              if(stat && !stat.hide) {\r\n                len++;\r\n              }\r\n            }\r\n            numStats[len + 'x stats'] = len;\r\n          }\r\n          \r\n          var retVal = [];\r\n          for(var val in numStats) {\r\n            retVal.push({\r\n              id: numStats[val],\r\n              name: val,\r\n            });\r\n          }\r\n          \r\n          retVal = retVal.sort(function(a, b) {\r\n              return a.id - b.id;\r\n            });\r\n          \r\n          return retVal;\r\n        },\r\n        matchesItem: function(id, item) {\r\n          var len = 0;\r\n          for(var j=0;j<item.stats.length;++j) {\r\n            var stat = hCodeValues.stats[item.stats[j].id];\r\n            if(stat && !stat.hide) {\r\n              len++;\r\n            }\r\n          }\r\n            \r\n          return len == id;\r\n        },\r\n        isItemStep: true,\r\n      },\r\n      highStatStep: {\r\n        name: 'High Stat',\r\n        getOptions: function(category, build, datas) {\r\n          var items = quickAddHelper.findData(category, build, datas);\r\n            \r\n          var allItem = { id: -1, name: 'all' };\r\n          var retVal = [allItem];\r\n          if(items.length > 1) {\r\n            var allStats = {};\r\n            \r\n            for(var i=0;i<items.length;++i) {\r\n              for(var j=0;j<items[i].stats.length;++j) {\r\n                var stat = hCodeValues.stats[items[i].stats[j].id];\r\n                if(stat && stat.quickHigh && !('high ' + stat.name in allStats)) {\r\n                  allStats['high ' + stat.name] = stat.id;\r\n                }\r\n              }\r\n            }\r\n\r\n            for(var val in allStats) {\r\n              retVal.push({\r\n                id: allStats[val],\r\n                name: val,\r\n              });\r\n            }\r\n            \r\n            if(retVal.length <= 2) {\r\n              retVal = [allItem];\r\n            }\r\n            else {\r\n              retVal = retVal.sort(function(a, b) {\r\n                  return a.id - b.id;\r\n                });\r\n            }\r\n          }\r\n          \r\n          return retVal;\r\n        },\r\n        matchesItem: function(id, item) {\r\n          if(id == -1) {\r\n            return true;\r\n          }\r\n          \r\n          var largestVal = 0;\r\n          var selectedVal = 0;\r\n          \r\n          for(var j=0;j<item.stats.length;++j) {\r\n            var val = item.stats[j];\r\n            var stat = hCodeValues.stats[val.id];\r\n            if(stat.quickHigh) {\r\n              if(val.id == id) {\r\n                selectedVal += val.max;\r\n              }\r\n              else if(val.max > largestVal) {\r\n                largestVal = val.max;\r\n              }\r\n            }\r\n          }\r\n          \r\n          return selectedVal > largestVal;\r\n        },\r\n        sortFunc: function(id, item1, item2) {\r\n          var val1 = 0;\r\n          var val2 = 0;\r\n          \r\n          for(var i=0;i<item1.stats.length;++i) {\r\n            if(item1.stats[i].id == id) {\r\n              val1 = item1.stats[i].max;\r\n              break;\r\n            }\r\n          }\r\n          for(var j=0;j<item2.stats.length;++j) {\r\n            if(item2.stats[j].id == id) {\r\n              val2 = item2.stats[j].max;\r\n              break;\r\n            }\r\n          }\r\n          return val2 - val1;\r\n        },\r\n        isItemStep: false,\r\n        minOptions: 3,\r\n      },\r\n      hasStatStep: {\r\n        name: 'Has Stat',\r\n        getOptions: function(category, build, datas) {\r\n          var items = quickAddHelper.findData(category, build, datas);\r\n            \r\n          var allItem = { id: -1, name: 'all' };\r\n          var retVal = [allItem];\r\n          if(items.length > 1) {\r\n            var allStats = {};\r\n            \r\n            for(var i=0;i<items.length;++i) {\r\n              for(var j=0;j<items[i].stats.length;++j) {\r\n                var stat = hCodeValues.stats[items[i].stats[j].id];\r\n                if(stat && stat.searchable && !('high ' + stat.name in allStats)) {\r\n                  allStats['has ' + stat.name] = stat.id;\r\n                }\r\n              }\r\n            }\r\n\r\n            for(var val in allStats) {\r\n              retVal.push({\r\n                id: allStats[val],\r\n                name: val,\r\n              });\r\n            }\r\n            \r\n            if(retVal.length <= 2) {\r\n              retVal = [allItem];\r\n            }\r\n            else {\r\n              retVal = retVal.sort(function(a, b) {\r\n                  return a.id - b.id;\r\n                });\r\n            }\r\n          }\r\n          \r\n          return retVal;\r\n        },\r\n        matchesItem: function(id, item) {\r\n          if(id == -1) {\r\n            return true;\r\n          }\r\n          \r\n          for(var j=0;j<item.stats.length;++j) {\r\n            var val = item.stats[j];\r\n            var stat = hCodeValues.stats[val.id];\r\n            if(stat.searchable) {\r\n              if(val.id == id) {\r\n                return true;\r\n              }\r\n            }\r\n          }\r\n          \r\n          return false;\r\n        },\r\n        sortFunc: function(id, item1, item2) {\r\n          var val1 = 0;\r\n          var val2 = 0;\r\n          \r\n          for(var i=0;i<item1.stats.length;++i) {\r\n            if(item1.stats[i].id == id) {\r\n              val1 = item1.stats[i].max;\r\n              break;\r\n            }\r\n          }\r\n          for(var j=0;j<item2.stats.length;++j) {\r\n            if(item2.stats[j].id == id) {\r\n              val2 = item2.stats[j].max;\r\n              break;\r\n            }\r\n          }\r\n          return val2 - val1;\r\n        },\r\n        isItemStep: false,\r\n        minOptions: 3,\r\n      },\r\n      customStep: {\r\n        name: 'misc',\r\n        getOptions: function(category, build, datas) {\r\n          return hCodeValues.customItems;\r\n        },\r\n        isItemStep: true,\r\n      },\r\n    }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('region', ['translations','dntReset','dntData','$route',region]);\r\nfunction region(translations,dntReset,dntData,$route) {\r\n  \r\n  var alternativeFiles = {region: 'ALT', name: 'Alternative user specified files', url : ''};\r\n  var hostedFiles =[\r\n      {region: 'sea', name: 'south east asia', url : 'https://seadnfiles.firebaseapp.com'},\r\n      {region: 'na', name: 'north america', url : 'https://dnna.firebaseapp.com'},\r\n      {region: 'eu', name: 'europe', url : 'https://eufiles.firebaseapp.com'},\r\n      {region: 'ina', name: 'indonesia ', url : 'https://inafiles-da491.firebaseapp.com'},\r\n      {region: 'th', name: 'thailand', url : 'https://thdnfiles.firebaseapp.com'},\r\n      {region: 'vn', name: 'vietnam ', url : 'https://vndnfiles.firebaseapp.com'},\r\n      {region: 'tw', name: 'taiwan ', url : 'https://twdnfiles.firebaseapp.com'},\r\n      // {region: 'jdn', name: 'japan ', url : 'https://jdnfiles-59d57.firebaseapp.com'},\r\n      {region: 'cdn', name: 'china ', url : 'https://cdnfiles.firebaseapp.com'},\r\n      {region: 'kdn', name: 'korea ', url : 'https://kdnfiles.firebaseapp.com'},\r\n    ];\r\n  \r\n  var dntLocationRegion = localStorage.getItem('lastDNTRegion');\r\n  var dntLocation = null;\r\n  if(dntLocationRegion) {\r\n    angular.forEach(hostedFiles, function(hostedFile, index) {\r\n      if(hostedFile.region == dntLocationRegion) {\r\n        dntLocation = hostedFile;\r\n      }\r\n    });\r\n  }\r\n\r\n  var lastTFile = localStorage.getItem('UIStrings_file');\r\n  var tlocation = null;\r\n  if(lastTFile) {\r\n    angular.forEach(hostedFiles, function(hostedFile, index) {\r\n      if(hostedFile.region != alternativeFiles.region && lastTFile.indexOf(hostedFile.url) > -1) {\r\n        tlocation = hostedFile;\r\n      }\r\n    });\r\n  }\r\n  \r\n  if(tlocation == null) {\r\n    tlocation = dntLocation;\r\n  }\r\n\r\n  return {\r\n    hostedFiles : hostedFiles,\r\n    alternativeFiles : alternativeFiles,\r\n    dntLocation : dntLocation,\r\n    tlocation : tlocation,\r\n    \r\n    setCustomUrl: function(url) {\r\n      // console.log('setting custom location');\r\n      this.alternativeFiles.url = url;\r\n\r\n      var newFiles = [];\r\n      angular.forEach(hostedFiles, function(hostedFile, index) {\r\n        if(hostedFile.region != alternativeFiles.region) {\r\n          newFiles.push(hostedFile);\r\n        }\r\n      });\r\n  \r\n      newFiles.push(alternativeFiles);\r\n      hostedFiles = newFiles;\r\n      this.hostedFiles = newFiles;\r\n    },\r\n    \r\n    setLocationByName: function(locationName) {\r\n      var newLocation = null;\r\n      \r\n      angular.forEach(hostedFiles, function(hostedFile, index) {\r\n        if(hostedFile.region == locationName) {\r\n          newLocation = hostedFile;\r\n        }\r\n      });\r\n        \r\n      this.setLocation(newLocation);\r\n    },\r\n    \r\n    setLocation: function(location) {\r\n      if(location && location != this.dntLocation) {\r\n        this.dntLocation = location;\r\n        dntReset();\r\n        localStorage.setItem('lastDNTRegion', location.region);\r\n        dntReset();\r\n        $route.reload();\r\n      }\r\n\r\n      var override = this.getOverride();\r\n      if(this.tlocation == null || !override) {\r\n        this.setTLocation(location);\r\n      }\r\n      \r\n      this.init();\r\n      \r\n      // $route.reload();\r\n    },\r\n    \r\n    setTLocation: function(location) {\r\n      \r\n      if(location != this.tlocation) {\r\n        \r\n        this.tlocation = location;\r\n        sessionStorage.removeItem('UIStrings');\r\n        localStorage.removeItem('UIStrings_file');\r\n        dntReset();\r\n        translations.reset();\r\n        if(location) {\r\n          var override = this.getOverride();\r\n          translations.small = !override;\r\n          translations.location = this.tlocation.url;\r\n          translations.region = this.tlocation.region;\r\n          translations.init(function() {}, function() {\r\n            $route.reload();\r\n          });\r\n        }\r\n      }\r\n    },\r\n    \r\n    getOverride: function() {\r\n      if(localStorage.getItem('tOverride')) {\r\n        return true;\r\n      }\r\n      else {\r\n        return false;\r\n      }\r\n    },\r\n    \r\n    setOverride: function(value) {\r\n      if(!value) {\r\n        localStorage.removeItem('tOverride');\r\n      }\r\n      else {\r\n        localStorage.setItem('tOverride', '1');\r\n      }\r\n      this.setTLocation(this.dntLocation);\r\n    },\r\n    \r\n    init: function() {\r\n      if(this.getOverride()) {\r\n        translations.small = false;\r\n      }\r\n      else {\r\n        this.tLocation = this.dntLocation;\r\n        translations.small = true;\r\n      }\r\n      \r\n      if(this.tlocation) {\r\n        translations.location = this.tlocation.url;\r\n        translations.region = this.tlocation.region;\r\n      }\r\n      dntData.setLocation(this.dntLocation);\r\n    }\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('saveHelper', ['itemCategory',saveHelper]);\r\nfunction saveHelper(itemCategory) {\r\n  return {\r\n    saveItem: function(groupName, item) {\r\n      var groups = this.getSavedItems();\r\n      if(groupName in groups && Array.isArray(groups[groupName].items)) {\r\n        \r\n        groups[groupName].items.push(item);\r\n        groups[groupName].lastUpdate = (new Date()).getTime();\r\n        this.updatedSavedItems(groupName, groups[groupName].items);\r\n      }\r\n      else {\r\n        this.updatedSavedItems(groupName, [item]);\r\n      }\r\n    },\r\n    \r\n    saveBuildSelection : function(buildName, builds) {\r\n      this.setCurrentBuild(buildName);\r\n      if(builds && buildName in builds && builds[buildName].job && builds[buildName].job.id) {\r\n        localStorage.setItem('jobNumber', builds[buildName].job.id);\r\n      }\r\n    },\r\n    \r\n    importGroup: function(groupName, updatedItems) {\r\n      var items = this.getSavedItems();\r\n      groupName = this.getUniqueGroupName(groupName, items);\r\n      this.updatedSavedItems(groupName, updatedItems);\r\n      return groupName;\r\n    },\r\n    \r\n    getUniqueGroupName: function(groupName, existingGroups) {\r\n      var groupNameIndex = 0;\r\n      if(groupName.lastIndexOf(')') == groupName.length-1) {\r\n        var startIndex = groupName.lastIndexOf('(');\r\n        if(startIndex > 0) {\r\n          var foundIndex = Number(groupName.substr(startIndex+1, groupName.length-startIndex-2));\r\n          if(foundIndex > 0) {\r\n            groupNameIndex = foundIndex + 1;\r\n            groupName = groupName.substr(0, startIndex - 1);\r\n          }\r\n        }\r\n      }\r\n      \r\n      var originalName = groupName;\r\n      for(;;) {\r\n        var groupName = originalName;\r\n        if(groupNameIndex > 0) {\r\n          groupName = originalName + ' (' + groupNameIndex + ')';\r\n        }\r\n        \r\n        if(groupName in existingGroups) {\r\n          groupNameIndex++;\r\n        }\r\n        else {\r\n          break;\r\n        }\r\n      }\r\n      \r\n      return groupName;\r\n    },\r\n    \r\n    deleteBuild: function(buildName) {\r\n      var builds = this.getSavedItems();\r\n      if(buildName in builds) {\r\n          delete builds[buildName];\r\n          this.setCurrentBuild(null);\r\n          this.saveBuilds(builds);\r\n      }\r\n    },\r\n    \r\n    updatedSavedItems: function(groupName, updatedItems) {\r\n      var items = this.getSavedItems();\r\n      if(groupName in items) {\r\n        items[groupName].items = updatedItems;\r\n        items[groupName].lastUpdate = (new Date()).getTime();\r\n      }\r\n      else {\r\n        items[groupName] = {items : updatedItems, lastUpdate: (new Date()).getTime()};\r\n          // console.log('created group');\r\n      }\r\n      \r\n      this.saveBuilds(items);\r\n    },\r\n    \r\n    saveBuilds: function(builds) {\r\n      var stringifiedData = JSON.stringify(builds);\r\n      localStorage.setItem('savedItems', LZString.compressToUTF16(stringifiedData));\r\n    },\r\n\r\n    saveBuild: function(oldGroupName, newGroupName, build) {\r\n      this.updateBuild(\r\n        oldGroupName, \r\n        newGroupName,\r\n        build.enemyLevel,\r\n        build.playerLevel,\r\n        build.heroLevel,\r\n        build.job,\r\n        build.damageType,\r\n        build.element,\r\n        build.secondaryElement,\r\n        build.critResist,\r\n        build.eleResist,\r\n        build.enemyStatCaps, \r\n        build.playerStatCaps, \r\n        build.conversions, \r\n        build.baseStats, \r\n        build.heroStats);\r\n    },\r\n    \r\n    updateBuild: function(\r\n      oldGroupName, newGroupName, enemyLevel, playerLevel, heroLevel, job, damageType, element, secondaryElement, critResist, eleResist,\r\n      enemyStatCaps, playerStatCaps, conversions, baseStats, heroStats) {\r\n        \r\n      var savedItems = this.getSavedItems();\r\n      \r\n      if(newGroupName in savedItems || oldGroupName == newGroupName) {\r\n        // console.log('not changing name');\r\n        newGroupName = oldGroupName;\r\n      }\r\n      else if(oldGroupName in savedItems) {\r\n        var group = savedItems[oldGroupName];\r\n        savedItems[newGroupName] = group;\r\n        delete savedItems[oldGroupName];\r\n      }\r\n      \r\n      savedItems[newGroupName].enemyLevel = enemyLevel;\r\n      savedItems[newGroupName].playerLevel = playerLevel;\r\n      savedItems[newGroupName].heroLevel = heroLevel;\r\n      savedItems[newGroupName].job = job;\r\n      savedItems[newGroupName].damageType = damageType;\r\n      savedItems[newGroupName].element = element;\r\n      savedItems[newGroupName].secondaryElement = secondaryElement;\r\n      savedItems[newGroupName].critResist = critResist;\r\n      savedItems[newGroupName].eleResist = eleResist;\r\n      savedItems[newGroupName].enemyStatCaps = enemyStatCaps;\r\n      savedItems[newGroupName].playerStatCaps = playerStatCaps;\r\n      savedItems[newGroupName].conversions = conversions;\r\n      savedItems[newGroupName].baseStats = baseStats;\r\n      savedItems[newGroupName].heroStats = heroStats;\r\n      \r\n      this.saveBuilds(savedItems);\r\n    },\r\n    \r\n    getSavedItems: function() {\r\n      try {\r\n        var stringifiedData = LZString.decompressFromUTF16(localStorage.getItem('savedItems'));\r\n        var savedItems = JSON.parse(stringifiedData);\r\n        return savedItems;\r\n      }\r\n      catch(ex) {\r\n      }\r\n      \r\n      return {};\r\n    },\r\n    \r\n    currentBuild: null,\r\n    getCurrentBuild: function() {\r\n      if(!this.currentBuild) {\r\n        this.currentBuild = localStorage.getItem('currentGroup');\r\n        if(this.currentBuild) {\r\n          var savedItems = this.getSavedItems();\r\n          if(!(this.currentBuild in savedItems)) {\r\n            localStorage.removeItem('currentGroup');\r\n            this.currentBuild = null;\r\n          }\r\n        }\r\n      }\r\n      \r\n      return this.currentBuild;\r\n    },\r\n    \r\n    setCurrentBuild: function(buildName) {\r\n      this.currentBuild = buildName;\r\n      if(!buildName) {\r\n        localStorage.removeItem('currentGroup', buildName);\r\n      }\r\n      else {\r\n        localStorage.setItem('currentGroup', buildName);\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('statHelper', ['hCodeValues',statHelper]);\r\nfunction statHelper(hCodeValues) {\r\n\r\n  return {\r\n    \r\n    getSetStats: function(groupItems) {\r\n      var stats = [];\r\n      var sets = {};\r\n      \r\n      angular.forEach(groupItems, function(value, key) {\r\n        if(value !== null && value.setStats != null) {\r\n          if(value.setId in sets) {\r\n            sets[value.setId].numItems++;\r\n          }\r\n          else {\r\n            sets[value.setId] = { numItems : 1, stats : value.setStats };\r\n          }\r\n        }\r\n      });\r\n      \r\n      angular.forEach(sets, function(value, key) {\r\n        angular.forEach(value.stats, function(stat, index) {\r\n          if(stat.needSetNum <= value.numItems) {\r\n            stats.push(stat);\r\n          }\r\n        });\r\n      });\r\n      \r\n      return hCodeValues.mergeStats(stats);\r\n    },\r\n    \r\n    getNumItemsForSet: function(items, setId) {\r\n      var numItems = 0;\r\n      angular.forEach(items, function(value, key) {\r\n        if(value && value.setId && value.setId == setId) {\r\n          numItems++;\r\n        }\r\n      });\r\n      \r\n      return numItems;\r\n    },\r\n    \r\n    getCombinedStats: function(groupItems) {\r\n      var stats = [];\r\n      \r\n      angular.forEach(groupItems, function(value, key) {\r\n        if(value) {\r\n          \r\n          if(value.fullStats) {\r\n            stats = stats.concat(value.fullStats);\r\n          }\r\n          else if(value.stats) {\r\n            stats = stats.concat(value.stats);\r\n          }\r\n        }\r\n      });\r\n      \r\n      return hCodeValues.mergeStats(stats);\r\n    },\r\n    \r\n    getCalculatedStatsFromItems: function(group, items) {\r\n      var nakedStats = this.getNakedStats(group);\r\n      var combinedStats = this.getCombinedStats(items);\r\n      var setStats = this.getSetStats(items);\r\n      var allStats = nakedStats.concat(combinedStats).concat(setStats);\r\n      if(group.heroStats != null && group.heroStats.length > 0) {\r\n        allStats = allStats.concat(group.heroStats);\r\n      }\r\n      allStats = hCodeValues.mergeStats(allStats);\r\n      \r\n      return this.getCalculatedStats(group, allStats);\r\n    },\r\n    \r\n    getCalculatedStats: function(group, combinedStats) {\r\n      \r\n      var retVal = [];\r\n      var statLookup = {};\r\n      if(!group.conversions || !group.enemyStatCaps || !group.playerStatCaps) {\r\n        return [];\r\n      }\r\n      \r\n      angular.forEach(combinedStats, function(stat, index) {\r\n        statLookup[stat.id] = stat;\r\n      });\r\n      \r\n      function getPc(stat) {\r\n        var statDef = hCodeValues.stats[stat.id];\r\n        if(statLookup[statDef.pc]) {\r\n          return Number(statLookup[statDef.pc].max);\r\n        }\r\n        else {\r\n          return 0;\r\n        }\r\n      }\r\n      \r\n      function getSkillPc(stat) {\r\n        var statDef = hCodeValues.stats[stat.id];\r\n        if(statLookup[statDef.skPc]) {\r\n          return Number(statLookup[statDef.skPc].max);\r\n        }\r\n        else {\r\n          return 0;\r\n        }\r\n      }\r\n      \r\n      function applyPc(stat) {\r\n        stat.max = Math.floor(\r\n          stat.max * (1+getPc(stat)) * (1+getSkillPc(stat))\r\n          );\r\n      }\r\n      \r\n      function dupeStat(id) {\r\n        var stat = statLookup[id];\r\n        if(stat) {\r\n          return {id: id, max: Number(stat.max), pc: stat.pc};\r\n        }\r\n        else {\r\n          return {id: id, max: 0, pc: 0};\r\n        }\r\n      }\r\n      \r\n      function addStat(stat) {\r\n        if(stat.max > 0) {\r\n          retVal.push(stat);\r\n        }\r\n      }\r\n\r\n      var critResist;\r\n      if(!('critResist' in group)) {\r\n        critResist = 0.20;\r\n      }\r\n      else {\r\n        critResist = group.critResist / 100.0;\r\n      }\r\n\r\n      var eleResist;\r\n      if(!('eleResist' in group)) {\r\n        eleResist = 0;\r\n      }\r\n      else {\r\n        eleResist = group.eleResist / 100.0;\r\n      }\r\n      \r\n      // base stats\r\n      var str = dupeStat(0);\r\n      applyPc(str);\r\n      addStat(str);\r\n      \r\n      var agi = dupeStat(1);\r\n      applyPc(agi);\r\n      addStat(agi);\r\n      \r\n      var int = dupeStat(2);\r\n      applyPc(int);\r\n      addStat(int);\r\n\r\n      var vit = dupeStat(3);\r\n      applyPc(vit);\r\n      addStat(vit);\r\n\r\n      // add vit to hp\r\n      var hp = dupeStat(25);\r\n      hp.max += (vit.max * Number(group.conversions.HP));\r\n      applyPc(hp);\r\n      addStat(hp);\r\n      \r\n      // defs\r\n      var def = dupeStat(8);\r\n      def.max += (vit.max * Number(group.conversions.PhysicalDefense));\r\n      applyPc(def);\r\n      addStat(def);\r\n      \r\n      var defpc = dupeStat(1008);\r\n      // defpc.max = Math.max(0.85, Number(def.max)/Number(group.enemyStatCaps.Cdefense));\r\n      defpc.max = Math.min(0.85,def.max/Number(group.enemyStatCaps.Cdefense));\r\n      addStat(defpc);\r\n      \r\n      var mdef = dupeStat(9);\r\n      mdef.max += (int.max * Number(group.conversions.MagicDefense));\r\n      applyPc(mdef);\r\n      addStat(mdef);\r\n      \r\n      var mdefpc = dupeStat(1009);\r\n      // mdefpc.max = Math.max(0.85, Number(mdef.max)/Number(group.enemyStatCaps.Cdefense));\r\n      mdefpc.max = Math.min(0.85,mdef.max/Number(group.enemyStatCaps.Cdefense));\r\n      addStat(mdefpc);\r\n      \r\n      // attack power - like fd but for bufs\r\n      // this shows as blue damage\r\n      // i think there are magic and phis variants of this but doesnt matter\r\n      var aPwr = dupeStat(3000);\r\n      \r\n      var minPdmg = dupeStat(4);\r\n      var maxPdmg = dupeStat(5);\r\n\r\n      // physical damage\r\n      if(!group.damageType || group.damageType.id != 2) {\r\n        var extraPdmg = dupeStat(32);\r\n        var extraPdmgMod= dupeStat(101);\r\n        var paPwr = dupeStat(3001);\r\n        \r\n        // special stats for zeal\r\n        var intToPdmg = dupeStat(10164);\r\n        \r\n        minPdmg.max += extraPdmg.max;\r\n        minPdmg.max += Math.floor(str.max*Number(group.conversions.StrengthAttack));\r\n        minPdmg.max += Math.floor(agi.max*Number(group.conversions.AgilityAttack));\r\n        \r\n        minPdmg.max = Math.floor(minPdmg.max*(1+(getPc(minPdmg) + extraPdmgMod.max)));\r\n        minPdmg.max = Math.floor(minPdmg.max * (1+aPwr.max+paPwr.max));\r\n        minPdmg.max += Math.floor(intToPdmg.max * int.max);\r\n        addStat(minPdmg);\r\n  \r\n        maxPdmg.max += extraPdmg.max;\r\n        maxPdmg.max += Math.floor(str.max*Number(group.conversions.StrengthAttack));\r\n        maxPdmg.max += Math.floor(agi.max*Number(group.conversions.AgilityAttack));\r\n        \r\n        maxPdmg.max = Math.floor(maxPdmg.max*(1+(getPc(maxPdmg) + extraPdmgMod.max)));\r\n        maxPdmg.max = Math.floor(maxPdmg.max * (1+aPwr.max+paPwr.max));\r\n        maxPdmg.max += Math.floor(intToPdmg.max * int.max);\r\n        addStat(maxPdmg);\r\n      }\r\n      \r\n      var minMdmg = dupeStat(6);\r\n      var maxMdmg = dupeStat(7);\r\n      \r\n      // magic damage\r\n      if(!group.damageType || group.damageType.id != 1) {\r\n        var extraMdmg = dupeStat(33);\r\n        var extraMdmgMod = dupeStat(102);\r\n        var maPwr = dupeStat(3002);\r\n        \r\n        // special stats for zeal\r\n        var strToMdmg = dupeStat(10165);\r\n        var intToMdmg = dupeStat(10372);\r\n        \r\n        minMdmg.max += extraMdmg.max;\r\n        minMdmg.max += Math.floor(int.max*Number(group.conversions.IntelligenceAttack));\r\n\r\n        minMdmg.max = Math.floor(minMdmg.max*(1+(getPc(minMdmg) + extraMdmgMod.max)));\r\n        minMdmg.max = minMdmg.max * (1+aPwr.max+maPwr.max);\r\n        minMdmg.max += Math.floor(strToMdmg.max * str.max);\r\n        minMdmg.max += Math.floor(intToMdmg.max * int.max);\r\n        addStat(minMdmg);\r\n        \r\n        maxMdmg.max += extraMdmg.max;\r\n        maxMdmg.max += (int.max*Number(group.conversions.IntelligenceAttack));\r\n        \r\n        maxMdmg.max = Math.floor(maxMdmg.max*(1+(getPc(maxMdmg) + extraMdmgMod.max)));\r\n        maxMdmg.max = maxMdmg.max * (1+aPwr.max+maPwr.max);\r\n        maxMdmg.max += Math.floor(strToMdmg.max * str.max);\r\n        maxMdmg.max += Math.floor(intToMdmg.max * int.max);\r\n        addStat(maxMdmg);\r\n      }\r\n      \r\n      \r\n      // crit chance %\r\n      var crit = dupeStat(12);\r\n      crit.max += (agi.max*Number(group.conversions.Critical));\r\n      applyPc(crit);\r\n      \r\n      var skCrit = dupeStat(4012);\r\n      crit.max += skCrit.max;\r\n      addStat(crit);\r\n      var itemCrit = dupeStat(1012);\r\n      \r\n      var critChance = Math.min(0.89, (crit.max / Number(group.enemyStatCaps.Ccritical)) + itemCrit.max);\r\n      retVal.push({id: 1012, max: critChance});\r\n\r\n      // crit damage %\r\n      var cDmg = dupeStat(103);\r\n      cDmg.max += ((str.max+int.max) * Number(group.conversions.StrengthIntelligenceToCriticalDamage));\r\n      applyPc(cDmg);\r\n      addStat(cDmg);\r\n\r\n      var itemCtriDmg = dupeStat(1103);\r\n      var critDamagePc = Math.min(1, (cDmg.max / group.playerStatCaps.CcriticalDamage) + itemCtriDmg.max);\r\n      addStat({id: 1103, max: critDamagePc + 2});\r\n\r\n      // fd\r\n      var fd = dupeStat(29);\r\n      addStat(fd);\r\n      var maxFd = Number(group.enemyStatCaps.Cfinaldamage);\r\n      \r\n      var fdPc = dupeStat(1029);\r\n      fdPc.max += Math.min(Math.max(0.35*Number(fd.max)/maxFd,Math.pow(Number(fd.max)/maxFd,2.2)),1);\r\n      addStat(fdPc);\r\n      \r\n      // elements\r\n      var firePc = dupeStat(16);\r\n      addStat(firePc);\r\n      \r\n      var icePc = dupeStat(17);\r\n      addStat(icePc);\r\n      \r\n      var lightPc = dupeStat(18);\r\n      addStat(lightPc);\r\n      \r\n      var darkPc = dupeStat(19);\r\n      addStat(darkPc);\r\n      \r\n      // average damage\r\n      function addAvgDamageStat(id, min, max) {\r\n        \r\n        var nonEleDamage = (min+max)/2;\r\n        // add crit\r\n        nonEleDamage += (critChance * (critDamagePc+1) * nonEleDamage * (1 - critResist));\r\n        // apply fd\r\n        nonEleDamage = nonEleDamage * (1 + fdPc.max);\r\n        \r\n        // apply element(s)\r\n        var avgDmg = nonEleDamage;\r\n        if(group.element && group.element.id > 0) {\r\n          var elementStat = statLookup[hCodeValues.elements[group.element.id].dmgStat];\r\n          if(elementStat) {\r\n            avgDmg = avgDmg * (1 + Number(elementStat.max)) * (1 - Number(eleResist));\r\n          }\r\n        }\r\n        addStat({id: id, max: avgDmg});\r\n        var secElementId = 0;\r\n        var priElementId = 0;\r\n        if(group.element) {\r\n          priElementId = group.element.id;\r\n        }\r\n        else {\r\n          priElementId = 0;\r\n        }\r\n        if(group.secondaryElement) {\r\n          secElementId = group.secondaryElement.id;\r\n        }\r\n        else {\r\n          secElementId = 0;\r\n        }\r\n        \r\n        if(secElementId != priElementId) {\r\n          if(secElementId > 0) {\r\n            var secondaryElementStat = statLookup[hCodeValues.elements[group.secondaryElement.id].dmgStat];\r\n            if(secondaryElementStat) {\r\n              var secAvgDmg = nonEleDamage * (1+Number(secondaryElementStat.max)) * (1 - Number(eleResist));\r\n              addStat({id: id + 1000, max: secAvgDmg});\r\n            }\r\n          }\r\n          else {\r\n            addStat({id: id + 1000, max: nonEleDamage});\r\n          }\r\n        }\r\n      }\r\n      \r\n      // average damages\r\n      if(!group.damageType || group.damageType.id == 1 || group.damageType.id == 0) {\r\n        addAvgDamageStat(1004, minPdmg.max, maxPdmg.max);\r\n      }\r\n\r\n      if(!group.damageType || group.damageType.id == 2 || group.damageType.id == 0) {\r\n        addAvgDamageStat(1006, minMdmg.max, maxMdmg.max);\r\n      }\r\n      \r\n      if(!group.damageType || group.damageType.id == 3) {\r\n        addAvgDamageStat(1001, minMdmg.max+minPdmg.max, maxMdmg.max+maxPdmg.max);\r\n      }\r\n      \r\n      // Equivalent HP\r\n      var pdefEqHp = dupeStat(2008);\r\n      pdefEqHp.max = hp.max / (1-defpc.max);\r\n      \r\n      var mdefEqHp = dupeStat(2009);\r\n      mdefEqHp.max = hp.max / (1-mdefpc.max);\r\n      \r\n      var eqHp = dupeStat(3008);\r\n      eqHp.max = (pdefEqHp.max + mdefEqHp.max) / 2;\r\n      addStat(eqHp);\r\n      \r\n      return retVal;\r\n    },\r\n    \r\n    getNakedStats: function(group) {\r\n      \r\n      if(\r\n        group.baseStats && \r\n        group.baseStats.Strength > 0) {\r\n\r\n        return [\r\n          {id:0, max:group.baseStats.Strength},\r\n          {id:1, max:group.baseStats.Agility},\r\n          {id:2, max:group.baseStats.Intelligence},\r\n          {id:3, max:group.baseStats.Stamina}\r\n          ];\r\n      }\r\n      else {\r\n        return [];\r\n      }\r\n    },\r\n    \r\n    getSkillStats : function (item, data, skillData) {\r\n\r\n      var skillLevelVals = null;\r\n      angular.forEach(skillData, function(value, index) {\r\n        if(value.SkillIndex == item.id && value.SkillLevel == item.enchantmentNum) {\r\n          skillLevelVals = value;\r\n          return;\r\n        }\r\n      });\r\n      \r\n      if(!skillLevelVals) {\r\n        return null;\r\n      }\r\n      \r\n      var index = 1;\r\n      var effects = [];\r\n      var stillCols = true;\r\n      \r\n      while(stillCols) {\r\n        var colName = 'EffectClass' + index;\r\n        var valColName = 'EffectClassValue' + index;\r\n        if(data && colName in data && valColName in skillLevelVals) {\r\n          if(data[colName] > 0) {\r\n            \r\n            var val = skillLevelVals[valColName];\r\n            \r\n            // for now add 10k\r\n            var effectId = data[colName];\r\n            var map = hCodeValues.skillEffectMapping[effectId];\r\n            if(map && map.getVals) {\r\n              var vals = map.getVals(val);\r\n              for(var i=0;i<vals.length;++i) {\r\n                effects.push(vals[i]);\r\n              }\r\n            }\r\n            else {\r\n              var statId;\r\n              if(map && map.mapTo) {\r\n                statId = map.mapTo;\r\n              }\r\n              else {\r\n                statId = 10000 + effectId;\r\n              }\r\n              \r\n              if(val > 0) {\r\n                effects.push({ id: statId, effect: effectId, max: val });\r\n              }\r\n              else {\r\n                if(val.toString().indexOf(';') > 0) {\r\n                  var vals = val.split(';');\r\n                  if(vals.length > 0 && vals[0] > 0) {\r\n                    effects.push({ id: statId, effect: effectId, max: vals[0] });\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n        else {\r\n          stillCols = false;\r\n        }\r\n        \r\n        index++;\r\n      }\r\n      \r\n      return effects;\r\n    },\r\n\r\n    getBuildStats: function(build) {\r\n      var stats = {};\r\n      stats.nakedStats = this.getNakedStats(build);\r\n      stats.combinedStats = this.getCombinedStats(build.items);\r\n      stats.setStats = this.getSetStats(build.items);\r\n      stats.allStats = stats.nakedStats.concat(stats.combinedStats).concat(stats.setStats);\r\n      if(build.heroStats && build.heroStats.length) {\r\n        stats.heroStats = build.heroStats;\r\n        stats.allStats = stats.allStats.concat(build.heroStats);\r\n      }\r\n      stats.allStats = hCodeValues.mergeStats(stats.allStats);\r\n      \r\n      stats.calculatedStats = this.getCalculatedStats(build, stats.allStats);\r\n      return stats;\r\n    }\r\n  };\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('translations', ['$routeParams', '$rootScope', 'uiTranslations', '$translate', translations]);\r\nfunction translations($routeParams, $rootScope, uiTranslations, $translate) {\r\n\r\n  var dnTranslations = new DnTranslations();\r\n  var smallFile = 'uistring.optimised.lzjson';\r\n  var bigFile = 'uistring.lzjson';\r\n\r\n  var completeCallback = [];\r\n  var progressCallback = [];\r\n\r\n  return {\r\n\r\n    getRawData: function() {\r\n      return dnTranslations.data;\r\n    },\r\n    \r\n    reset : function() {\r\n      dnTranslations = new DnTranslations();\r\n      dnTranslations.sizeLimit = 100;\r\n      this.loaded = false;\r\n      this.startedLoading = false;\r\n      completeCallback = [];\r\n      progressCallback = [];\r\n    },\r\n    \r\n    getFileName: function() {\r\n      if(this.small) {\r\n        // console.log('loading optimised translations');\r\n        return smallFile;\r\n      }\r\n      else {\r\n        // console.log('loading full translations');\r\n        return bigFile;\r\n      }\r\n    },\r\n    \r\n    loaded : false,\r\n    startedLoading : false,\r\n    small: false,\r\n    \r\n    location : null,\r\n    region: null,\r\n  \r\n    init : function(progress, complete) {\r\n\r\n      if(this.isLoaded()) {\r\n        complete();\r\n      }\r\n      else {\r\n        progressCallback = [];\r\n        if(progress) {\r\n          progressCallback.push(progress);\r\n        }\r\n        if(complete) {\r\n          completeCallback.push(complete);\r\n        }\r\n  \r\n        if(!this.startedLoading) {\r\n          this.startedLoading = true;\r\n          var t = this;\r\n          \r\n          var fileName = null;\r\n          if(this.location && this.location != '') {\r\n            fileName = this.location + '/' + this.getFileName();\r\n            \r\n            if(fileName != localStorage.getItem(\"UIStrings_file\")) {\r\n              sessionStorage.removeItem('UIStrings');\r\n              localStorage.removeItem('UIStrings_file');\r\n            }\r\n          }\r\n          \r\n          $rootScope.$broadcast('TRANSLATION_LOAD_EVENT');\r\n          dnTranslations.loadDefaultFile(\r\n            fileName, \r\n            function(msg) {\r\n              angular.forEach(progressCallback, function(value, key) { value(msg); });\r\n            }, \r\n            function() {\r\n              uiTranslations.addTranslations(t.region, t.getRawData());\r\n              // console.log('using ', t.region);\r\n              $translate.use(t.region);\r\n              t.loaded = true;\r\n              angular.forEach(completeCallback, function(value, key) { value(); });\r\n              completeCallback = [];\r\n              $rootScope.$broadcast('TRANSLATION_LOAD_EVENT');\r\n            },\r\n            function(msg) {\r\n              angular.forEach(progressCallback, function(value, key) { value(msg); });\r\n              $rootScope.$broadcast('TRANSLATION_LOAD_ERROR');\r\n              t.startedLoading = false;\r\n              t.loaded = false;\r\n            }\r\n          );\r\n        }\r\n      }\r\n    },\r\n    \r\n    isLoaded : function() {\r\n      if(!this.loaded) {\r\n        var fileName = this.location + '/' + this.getFileName();\r\n        \r\n        if(fileName != localStorage.getItem(\"UIStrings_file\")) {\r\n          sessionStorage.removeItem('UIStrings');\r\n          localStorage.removeItem('UIStrings_file');\r\n        }\r\n\r\n        this.loaded = dnTranslations.loadFromSession();\r\n        if(this.loaded) {\r\n          uiTranslations.addTranslations(this.region, this.getRawData());\r\n          $translate.use(this.region);\r\n          this.startedLoading = true;\r\n        }\r\n      }\r\n      return this.loaded;\r\n    },\r\n    \r\n    translate : function(id,idParam) {\r\n      if(this.loaded) {\r\n        try {\r\n          var name;\r\n          if(!id) {\r\n            return '';\r\n          }\r\n          else {\r\n            name = dnTranslations.translate(id);\r\n            \r\n            if(typeof name != 'string') {\r\n              return 'm' + name;\r\n            }\r\n          }\r\n          \r\n          if(idParam && name) {\r\n            \r\n            if(typeof idParam === 'string') {\r\n              var params = idParam.split(',');\r\n              for(var p=0;p<params.length;++p) {\r\n                var pid = params[p];\r\n                if(pid.indexOf('{') == 0) {\r\n                  pid = params[p].replace(/\\{|\\}/g,'');\r\n                  pid = dnTranslations.translate(pid);\r\n                }\r\n                \r\n                name = name.replace('{' + p + '}', pid);\r\n              }\r\n            }\r\n            else {\r\n              name = name.replace('{0}', idParam);\r\n            }\r\n          }\r\n\r\n          return name;\r\n        }\r\n        catch(ex) {\r\n          console.log('unable to translate', id, idParam, ex);\r\n        }\r\n      }\r\n\r\n      return 'm' + id;\r\n    }\r\n  }\r\n}\r\n\r\n})();","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('uiTranslations', uiTranslations);\r\n\r\n// translations for each region go in here\r\n// the key is the english text\r\nvar uiTranslationLookup = {\r\n    cdn: {\r\n        'dragon nest gear simulator': '',\r\n        'enemy lvl': '',\r\n        'damage type': '',\r\n        'player lvl': '',\r\n        'hero level stats': '',\r\n        'naked stats': '',\r\n        'stat affects': '',\r\n        'str': '',\r\n        'agi': '',\r\n        'int': '',\r\n        'builds': '',\r\n        'search': '',\r\n        'select region': '',\r\n        'create a new build': '',\r\n        'import': '',\r\n        'publish': '',\r\n        'find a build': '',\r\n        'about': '',\r\n        'import a build from a json build file': 'json',\r\n        'log in and publish your builds online': '',\r\n        'vit': '',\r\n        'fd': '',\r\n        'pdmg': '',\r\n        'mdmg': '',\r\n        'crit': '',\r\n        'cdmg': '',\r\n        'fire%': '',\r\n        'ice%': '',\r\n        'light%': '',\r\n        'dark%': '',\r\n        'pdef': '',\r\n        'mdef': '',\r\n        'weapons': '',\r\n        'armour': '',\r\n        'techs': '',\r\n        'titles': '',\r\n        'expedition plates': '',\r\n        'enhancement plates': '',\r\n        'increasing gems': '',\r\n        'offensive gems': '',\r\n        'back': '',\r\n        'cancel': '',\r\n        'epic': 'A',\r\n        'unique': 'S',\r\n        'legendary': 'L',\r\n        'quick add': '',\r\n        'hero lvl': ''\r\n    },\r\n    sea: {\r\n        'offensive gems':  'offensive jades',\r\n        'increasing gems':  'increasing jades',\r\n        'expedition plates': 'unique heraldry',\r\n        'enhancement plates': 'normal heraldry',\r\n        'techs': 'skill accessory',\r\n    },\r\n};\r\n\r\n// this function gets called on language change to add the translations to the main list\r\nfunction uiTranslations($routeParams, $rootScope) {\r\n    return {\r\n        addTranslations: function(region, data) {\r\n            if(region && data && region in uiTranslationLookup) {\r\n                var regionData = uiTranslationLookup[region];\r\n                for(var key in regionData) {\r\n                    data[key] = regionData[key];\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n})();\r\n","(function () {\r\n'use strict';\r\n\r\nangular.module('dnsim').factory('hCodeValues', [hCodeValues]);\r\nfunction hCodeValues() {\r\n\r\n  function toOneDec(stat) {\r\n    return Math.round(stat.max*10)/10;\r\n  }\r\n  function toNoDec(stat) {\r\n    return Math.floor(stat.max);\r\n  }\r\n  function inThousands(stat) {\r\n    var val = Number(stat.max);\r\n    if(val < 100) {\r\n      return val;\r\n    }\r\n    else if(val < 100000) {\r\n      return Math.round(val/100)/10 + 'k';\r\n    }\r\n    else if(val < 1000000) {\r\n      return Math.round(val/1000) + 'k';\r\n    }\r\n    else if(val < 10000000) {\r\n      return Math.round(val/10000)/100 + 'm';\r\n    }\r\n    else {\r\n      return Math.round(val/1000000) + 'm';\r\n    }\r\n  }\r\n  function toPercent(stat) {\r\n    return (Math.round(stat.max*10000)/100) + '%';\r\n  }\r\n  \r\n  return {\r\n    stats : {\r\n      0  : {id: 0, name: 'str', display: toNoDec, dps: true, pc: 50, skPc: 4050, searchable: true, quickHigh: true },\r\n      1  : {id: 1, name: 'agi', display: toNoDec, dps: true, pc: 51, skPc: 4051, searchable: true, quickHigh: true },\r\n      2  : {id: 2, name: 'int', display: toNoDec, dps: true, pc: 52, skPc: 4052, searchable: true, quickHigh: true },\r\n      3  : {id: 3, name: 'vit', display: toNoDec, def: true, pc: 53, skPc: 4053, searchable: true, quickHigh: true },\r\n      4  : {id: 4, name: 'pdmg', display: toNoDec, combineWith: 5, dps: true, pc: 54, searchable: true, altStat: 32, quickHigh: true },\r\n      5  : {id: 5, name: 'maxPdmg', display: toNoDec, hide: true, pc: 55 },\r\n      6  : {id: 6, name: 'mdmg', display: toNoDec, combineWith: 7, dps: true, pc: 56, searchable: true, altStat: 33, quickHigh: true },\r\n      7  : {id: 7, name: 'maxMdmg', display: toNoDec, hide: true, pc: 57 },\r\n      8  : {id: 8, name: 'pdef', display: inThousands, def: true, pc: 58, searchable: true },\r\n      9  : {id: 9, name: 'mdef', display: inThousands, def: true, pc: 59, searchable: true },\r\n      10 : {id: 10, name: 'para', display: inThousands, pc: 60, noCustom: true },\r\n      11 : {id: 11, name: 'para resist', display: inThousands, pc: 61, noCustom: true },\r\n      12 : {id: 12, name: 'crit', display: inThousands, dps: true, pc: 62, searchable: true },\r\n      13 : {id: 13, name: 'crit resist', display: inThousands, pc: 63, noCustom: true },\r\n      14 : {id: 14, name: 'stun', display: inThousands, pc: 64, noCustom: true },\r\n      15 : {id: 15, name: 'stun resist', display: inThousands, pc: 65, noCustom: true },\r\n      16 : {id: 16, name: 'fire%', display: toPercent, dps: true, searchable: true },\r\n      17 : {id: 17, name: 'ice%', display: toPercent, dps: true, searchable: true },\r\n      18 : {id: 18, name: 'light%', display: toPercent, dps: true, searchable: true },\r\n      19 : {id: 19, name: 'dark%', display: toPercent, dps: true, searchable: true },\r\n      20 : {id: 20, name: 'fire def', display: toPercent, def: true, searchable: true },\r\n      21 : {id: 21, name: 'ice def', display: toPercent, def: true, searchable: true },\r\n      22 : {id: 22, name: 'light def', display: toPercent, def: true, searchable: true },\r\n      23 : {id: 23, name: 'dark def', display: toPercent, def: true, searchable: true },\r\n      25 : {id: 25, name: 'hp', display: inThousands, def: true, pc: 75, skPc: 4075, searchable: true },\r\n      26 : {id: 26, name: 'mp', display: inThousands, def: true, pc: 76, skPc: 4076 },\r\n      29 : {id: 29, name: 'fd', display: toNoDec, dps: true, searchable: true },\r\n      \r\n      // these are both min and max\r\n      // shows with the same name but these are used really just for set bonus I think\r\n      32 : {id: 32, name: 'pdmg', display: toNoDec, dps: true, pc: 54, quickHigh: true },\r\n      33 : {id: 33, name: 'mdmg', display: toNoDec, dps: true, pc: 56, quickHigh: true },\r\n      \r\n      50 : {id: 50, name: 'str%', display: toPercent, dps: true },\r\n      51 : {id: 51, name: 'agi%', display: toPercent, dps: true },\r\n      52 : {id: 52, name: 'int%', display: toPercent, dps: true },\r\n      53 : {id: 53, name: 'vit%', display: toPercent, def: true },\r\n      54 : {id: 54, name: 'pdmg%', display: toPercent, combineWith: 55, dps: true },\r\n      55 : {id: 55, name: 'maxPdmg%', display: toPercent, hide: true },\r\n      56 : {id: 56, name: 'mdmg%', display: toPercent, combineWith: 57, dps: true },\r\n      57 : {id: 57, name: 'maxMdmg%', display: toPercent, hide: true },\r\n      58 : {id: 58, name: 'pdef%', display: toPercent, def: true },\r\n      59 : {id: 59, name: 'mdef%', display: toPercent, def: true },\r\n      60 : {id: 60, name: 'para%', display: toPercent, noCustom: true, def: true },\r\n      61 : {id: 61, name: 'para resist%', display: toPercent, noCustom: true, def: true },\r\n      62 : {id: 62, name: 'crit%', display: toPercent, dps: true },\r\n      63 : {id: 63, name: 'crit resist%', display: toPercent, def: true },\r\n      64 : {id: 64, name: 'stun%', display: toPercent, noCustom: true, def: true },\r\n      65 : {id: 65, name: 'stun resist%', display: toPercent, noCustom: true, def: true },\r\n      74 : {id: 74, name: 'move%', display: toPercent, noCustom: true, def: true },\r\n      75 : {id: 75, name: 'hp%', display: toPercent, def: true },\r\n      76 : {id: 76, name: 'mp%', display: toPercent, def: true },\r\n      77 : {id: 77, name: 'mp recover%', display: toPercent, def: true },\r\n      81 : {id: 81, name: 'safe move%', display: toPercent, noCustom: true, def: true },\r\n\r\n      // these are both min and max\r\n      // shows with the same name but these are used really just for set bonus I think\r\n      101 : {id: 101, name: 'pdmg%', display: toPercent, noCustom: true, dps: true, quickHigh: true },\r\n      102 : {id: 102, name: 'mdmg%', display: toPercent, noCustom: true, dps: true, quickHigh: true },\r\n\r\n      103: {id: 103, name: 'cdmg', display: inThousands, dps: true, pc: 104, searchable: true },\r\n      104: {id: 104, name: 'crit dmg%', display: toPercent, noCustom: true, dps: true },\r\n      105: {id: 104, name: 'pvp dmg', display: inThousands, noCustom: true, dps: true },\r\n      106: {id: 106, name: 'pvp def', display: inThousands, noCustom: true, def: true },\r\n      107: {id: 107, name: 'mp?', display: toNoDec, noCustom: true, hide: true, def: true },\r\n      \r\n      // stats below here are ones I made up\r\n      1001: {id: 1001, name: 'dmg', display: inThousands, summaryDisplay: true, element: 'primary', noCustom: true, hide: true },\r\n      1004: {id: 1004, name: 'pdmg', display: inThousands, summaryDisplay: true, element: 'primary', noCustom: true, hide: true },\r\n      1006: {id: 1006, name: 'mdmg', display: inThousands, summaryDisplay: true, element: 'primary', noCustom: true, hide: true },\r\n      \r\n      1008: {id: 1008, name: 'pdef', display: toPercent, noCustom: true, summaryFor: 8 },\r\n      1009: {id: 1009, name: 'mdef', display: toPercent, noCustom: true, summaryFor: 9 },\r\n      \r\n      1012: {id: 1012, name: 'crit chance', display: toPercent, noCustom: true, dps: true, summaryFor: 12 },\r\n      1029: {id: 1029, name: 'fd', display: toPercent, noCustom: true, dps: true, summaryFor: 29 },\r\n      1103: {id: 1103, name: 'crit dmg', display: toPercent, noCustom: true, dps: true, summaryFor: 103 },\r\n      \r\n      2001: {id: 2001, name: 'dmg', display: inThousands, summaryDisplay: true, element: 'secondary', noCustom: true, hide: true },\r\n      2004: {id: 2004, name: 'pdmg', display: inThousands, summaryDisplay: true, element: 'secondary', noCustom: true, hide: true },\r\n      2006: {id: 2006, name: 'mdmg', display: inThousands, summaryDisplay: true, element: 'secondary', noCustom: true, hide: true },\r\n      \r\n      2008: {id: 2008, name: 'pdef eqhp', display: inThousands, noCustom: true },\r\n      2009: {id: 2009, name: 'mdef eqhp', display: inThousands, noCustom: true },\r\n      \r\n      3000: {id: 3000, name: 'skDmg%', display: toPercent, dps: true },\r\n      3001: {id: 3001, name: 'skPDmg%', display: toPercent, dps: true },\r\n      3002: {id: 3002, name: 'skMDmg%', display: toPercent, dps: true },\r\n      \r\n      3008: {id: 3008, name: 'eqhp', display: inThousands, summaryDisplay: true, noCustom: true, hide: true },\r\n      \r\n      4012: {id: 4012, name: 'skCrit', display: inThousands, dps: true },\r\n      4050: {id: 4050, name: 'skStr%', display: toPercent, dps: true },\r\n      4051: {id: 4051, name: 'skAgi%', display: toPercent, dps: true },\r\n      4052: {id: 4052, name: 'skInt%', display: toPercent, dps: true },\r\n      4053: {id: 4053, name: 'skVit%', display: toPercent, def: true },\r\n      4075: {id: 4075, name: 'skHp%', display: toPercent, def: true },\r\n      4076: {id: 4076, name: 'skMp%', display: toPercent, def: true },\r\n      \r\n      // special cases for skills\r\n      10164: {id: 10164, name: 'intToPdmg', display: toPercent, noCustom: true, dps: true },\r\n      10165: {id: 10165, name: 'strToMdmg', display: toPercent, noCustom: true, dps: true },\r\n      10372: {id: 10372, name: 'intToMdmg', display: toPercent, noCustom: true, dps: true },\r\n      // items over 10000 are unknown skill effects\r\n    },\r\n  \r\n    rankNames : {\r\n      0 : { id: 0, name : 'normal' },\r\n      1 : { id: 1, name : 'magic' },\r\n      2 : { id: 2, name : 'rare' },\r\n      3 : { id: 3, name : 'epic' },\r\n      4 : { id: 4, name : 'unique' },\r\n      5 : { id: 5, name : 'legendary' },\r\n      // 6 : { id: 6, name : 'divine' },\r\n    },\r\n    \r\n    shopNames : {\r\n      28001: 'lament',28002: 'lament',28003: 'lament',28004: 'lament',28005: 'lament',28006: 'lament',28007: 'lament',28008: 'lament',28009: 'lament',28101: 'lament',\r\n      29001: 'aura',29002: 'aura',29003: 'aura',29004: 'aura',29005: 'aura',29006: 'aura',29007: 'aura',29008: 'aura',29009: 'aura',\r\n      5001: 'medal',5002: 'medal',5003: 'medal',5004: 'medal',5005: 'medal',5006: 'medal',5007: 'medal',5008: 'medal',5009: 'medal',\r\n      5101: 'ladder',5102: 'ladder',5103: 'ladder',5104: 'ladder',5105: 'ladder',5106: 'ladder',5107: 'ladder',5108: 'ladder',5109: 'ladder',\r\n      59001: 'garden bunny',\r\n      52001 : 'nightmare', 52002 : 'nightmare', 52003 : 'nightmare', 52004 : 'nightmare', 52005 : 'nightmare', 52006 : 'nightmare', 52007 : 'nightmare', 52008 : 'nightmare', 52009 : 'nightmare',\r\n      21: 'blacksmith', 22: 'blacksmith', 23: 'blacksmith', 24: 'blacksmith', 25: 'blacksmith', 26: 'blacksmith', 27: 'blacksmith', 28: 'blacksmith', 29: 'blacksmith', \r\n      89001: 'guild master',\r\n      88001: 'battlefield', 88002: 'battlefield', 88003: 'battlefield', 88004: 'battlefield', 88005: 'battlefield', 88006: 'battlefield', 88007: 'battlefield', 88008: 'battlefield', 88009: 'battlefield', \r\n      66001: 'erosion',\r\n      35006: 'plate',\r\n      14051: 'abyss', 14052: 'abyss', 14053: 'abyss', 14054: 'abyss', 14055: 'abyss', 14056: 'abyss', 14057: 'abyss', 14058: 'abyss', 14059: 'abyss', \r\n      40011: 'daredevil faire', 40012: 'daredevil faire', 40013: 'daredevil faire', 40014: 'daredevil faire', 40015: 'daredevil faire', 40016: 'daredevil faire', 40017: 'daredevil faire', 40018: 'daredevil faire',\r\n      40001: 'daredevil faire', 40002: 'daredevil faire', 40111: 'daredevil faire',\r\n      91001: 'wrath',\r\n      45001: 'farm',\r\n      100004: 'event',\r\n      89000: 'nightmare'\r\n    },\r\n    \r\n    checkedRank : {\r\n      0 : true,\r\n      1 : true,\r\n      2 : true,\r\n      3 : true,\r\n      4 : true,\r\n      5 : true,\r\n    },\r\n    \r\n    typeNames : {\r\n      0 : 'weapons',\r\n      1 : 'equipment',\r\n      5 : 'plates',\r\n      8 : 'pouch',\r\n      38 : 'plates',\r\n      90 : 'welspring',\r\n      132 : 'talisman',\r\n      139 : 'gems',\r\n    },\r\n    \r\n    elements : {\r\n      0 : { id: 0, name: 'non-ele' },\r\n      1 : { id: 1, name: 'fire', dmgStat: 16 },\r\n      2 : { id: 2, name: 'ice', dmgStat: 17 },\r\n      3 : { id: 3, name: 'light', dmgStat: 18 },\r\n      4 : { id: 4, name: 'dark', dmgStat: 19 },\r\n    },\r\n    \r\n    damageTypes : {\r\n      0 : { id: 0, name: 'both separate' },\r\n      1 : { id: 1, name: 'physical' },\r\n      2 : { id: 2, name: 'magical' },\r\n      3 : { id: 3, name: 'both combined' },\r\n    },\r\n    \r\n    // note: skills shown on-screen have 1k added to their id\r\n    skillEffectMapping : {\r\n      2 : { id: 2, name: 'phyisical attack power', mapTo: 3001 },\r\n      13 : { id: 13, name: 'mp', mapTo: 26 },\r\n      25 : { id: 25, name: 'action speed' },\r\n      29 : { id: 29, name: 'magic attack power', mapTo: 3002 },\r\n      32 : { id: 32, name: 'fire %', mapTo: 16 },\r\n      33 : { id: 33, name: 'ice %', mapTo: 17 },\r\n      34 : { id: 34, name: 'light %', mapTo: 18 },\r\n      35 : { id: 35, name: 'dark %', mapTo: 19 },\r\n      36 : { id: 36, name: 'fire def', mapTo: 20 },\r\n      37 : { id: 37, name: 'ice def', mapTo: 21 },\r\n      38 : { id: 38, name: 'light def', mapTo: 22 },\r\n      39 : { id: 39, name: 'dark def', mapTo: 23 },\r\n      58 : { id: 58, name: 'hp%', mapTo: 4075 },\r\n      59 : { id: 59, name: 'mp%', mapTo: 4076 },\r\n      65 : { id: 65, name: 'range' },\r\n      76 : { id: 76, name: 'movement speed', mapTo: 74 },\r\n      87 : { id: 87, name: 'str%', mapTo: 4050 },\r\n      88 : { id: 88, name: 'agi%', mapTo: 4051 },\r\n      89 : { id: 89, name: 'int%', mapTo: 4052 },\r\n      90 : { id: 90, name: 'vit%', mapTo: 4053 },\r\n      // 134 : { id: 134, name: 'p dmg reduction%' },\r\n      // 135 : { id: 135, name: 'm dmg reduction%' },\r\n      185 : { id: 185, name: 'wots attack power', mapTo: 3000 },\r\n      251 : { id: 251, name: 'critical chance%', mapTo: 1012 },\r\n      164 : { id: 164, name: 'intToPdmg', mapTo: 10164 },\r\n      165 : { id: 165, name: 'strToMdmg', mapTo: 10165 },\r\n      222: {\r\n        id: 222, \r\n        name: 'hellfire', \r\n        getVals: function(val) {\r\n          if(val.indexOf(';') > 0) {\r\n            var vals = val.split(';');\r\n            return [\r\n              {id: 62, effect: 222, max: Number(vals[0])/100.0},\r\n              {id: 4012, effect: 222, max: Number(vals[1])},\r\n              ];\r\n          }\r\n          else {\r\n            return [{id: 62, effect: 222, max: Number(val)/100.0}];\r\n          }\r\n        }\r\n      },\r\n      372: {\r\n        id: 372,\r\n        name: 'statConversion',\r\n        getVals: function(val) {\r\n          if(val.indexOf(';') > 0) {\r\n            var vals = val.split(';');\r\n            if(vals.length == 3 && vals[0] == 2 && vals[2] == 6) {\r\n              return [{ id: 10372, name: 'intToMdmg', max: Number(vals[1]) }];\r\n            }\r\n          }\r\n          return [];\r\n        }\r\n      },\r\n      \r\n      \r\n      389: { id: 389, name: 'fd buf', mapTo: 1029 },\r\n      404: { id: 404, name: 'critical damage%', mapTo: 1103 },\r\n    },\r\n    \r\n    gemExchanges: [\r\n      {id: 2, exchange: 1, name: 'Weapon'},\r\n      {id: 3, exchange: 2, name: 'Off-Hand Weapon'},\r\n      {id: 4, exchange: 3, name: 'Headgear'},\r\n      {id: 5, exchange: 4, name: 'Body Armor'},\r\n      {id: 6, exchange: 5, name: 'Leg Armor'},\r\n      {id: 7, exchange: 6, name: 'Gloves'},\r\n      {id: 8, exchange: 7, name: 'Shoes'},\r\n      {id: 101, exchange: 8, name: 'Necklace'},\r\n      {id: 102, exchange: 9, name: 'Earrings'},\r\n      {id: 103, exchange: 10, name: 'Ring'},\r\n    ],\r\n    \r\n    customItems: \r\n    [\r\n    {id: 0, typeName:'custom', name: 'hp unified', stats: [{id: 4075, max:0.05}]},\r\n    ],\r\n  \r\n    getStats : function(data) {\r\n\r\n      var useMax=false;\r\n      var useStateXVal=false;\r\n      var mightHaveSets=true;\r\n      var prop = 'State1_Max';\r\n      if(prop in data) {\r\n        useMax = true;\r\n      }\r\n      else {\r\n        prop = 'State1Value';\r\n        if(prop in data) {\r\n          useStateXVal = true;\r\n        }\r\n      }\r\n      \r\n      var currentState = 0;\r\n      var statVals = [];\r\n      for(;;) {\r\n        currentState++;\r\n        \r\n        var stateProp = 'State' + currentState;\r\n        if(!(stateProp in data)) {\r\n          break;\r\n        }\r\n\r\n        var stateId = data[stateProp];\r\n        if(stateId == -1) {\r\n          break;\r\n        }\r\n        \r\n        if(stateId == 107) {\r\n          // is this mp?\r\n        }\r\n        else {\r\n          \r\n          var currentData = { id: stateId };\r\n          \r\n          var prop;\r\n        \r\n          if(useMax) {\r\n            prop = 'State' + currentState + '_Max';\r\n            currentData.max = data[prop];\r\n          }\r\n          else if(useStateXVal) {\r\n            prop = 'State' + currentState + 'Value';\r\n            currentData.max = data[prop];\r\n          }\r\n          else {\r\n            prop = 'StateValue' + currentState;\r\n            currentData.max = Number(data[prop]);\r\n          }\r\n          \r\n          if(currentData.max > 0 || currentData.max < 0) {\r\n            if(mightHaveSets) {\r\n              prop = 'NeedSetNum' + currentState;\r\n              if(prop in data) {\r\n                if(data[prop] == 0) {\r\n                  break;\r\n                }\r\n                currentData.needSetNum = data[prop];\r\n              }\r\n              else {\r\n                mightHaveSets = false;\r\n              }\r\n            }\r\n          \r\n            statVals.push(currentData);\r\n          }\r\n        }\r\n      }\r\n      \r\n      return statVals;\r\n    },\r\n    \r\n    setupStat : function(stat, id) {\r\n      stat.id = Number(id);\r\n    },\r\n    \r\n    mergeStats : function(stats1, stats2) {\r\n      var statMap = {};\r\n      \r\n      var self = this;\r\n      function add(value) {\r\n        \r\n        var amount = Number(value.max);\r\n        if(self.stats[value.id] && 'pc' in self.stats[value.id]) {\r\n          amount = Math.floor(amount);\r\n        }\r\n        \r\n        if(value.id in statMap) {\r\n          statMap[value.id] += amount;\r\n        }\r\n        else {\r\n          statMap[value.id] = amount;\r\n        }\r\n      }\r\n      \r\n      angular.forEach(stats1, function(value, key) {\r\n        if(value) {\r\n          add(value);\r\n        }\r\n      });\r\n      \r\n      if(stats2) {\r\n        angular.forEach(stats2, function(value, key) {\r\n          if(value) {\r\n            add(value);\r\n          }\r\n        });\r\n      }\r\n      \r\n      var newStats = [];\r\n      \r\n      for(var key in statMap) {\r\n        var stat = { max : statMap[key], id: Number(key) };\r\n        newStats.push(stat);\r\n      }\r\n        \r\n      return newStats;\r\n    }\r\n  }\r\n}\r\n\r\n})();"]}